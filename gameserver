# ğŸš€ DIRECT AAN DE SLAG - INSTALLATIE GUIDE
âš¡ SNELSTART (voor ongeduldiggen)
Als je gewoon NU wilt beginnen:

Bash

# 1. Download setup op Node 1
cd /root
git clone https://github.com/jouw-repo/gameserver-cluster.git
cd gameserver-cluster

# 2. Kopieer en pas config aan
cp config-cluster.env.example config-cluster.env
nano config-cluster.env  # Pas IPs aan!

# 3. Start!
chmod +x install-cluster.sh
./install-cluster.sh
Maar... voor de beste ervaring, volg de volledige guide hieronder ğŸ‘‡

ğŸ“‹ PRE-INSTALLATIE CHECKLIST
âœ… STAP 0: VOORDAT JE BEGINT (15 minuten)
Hardware Check:
Bash

[hardware_requirements]
ms01_nodes_unpacked=true
keyboard_monitor_available=true
usb_stick_8gb_available=true
â˜ 10G switch (MikroTik/Ubiquiti/etc.)
â˜ 10Ã— SFP+ DAC cables (of transceivers + fiber)
â˜ 5Ã— Ethernet kabels (voor initiÃ«le setup)
â˜ Laptop/PC op zelfde netwerk
Software Downloads:
Bash

# Op je laptop/PC:

# 1. Proxmox VE ISO
wget https://www.proxmox.com/en/downloads?task=callelement&format=raw&item_id=784&element=f85c494b-2b32-4109-b8c1-083cca2b7db6&method=download

# Of via browser:
https://www.proxmox.com/en/downloads/proxmox-virtual-environment/iso

# 2. Rufus (Windows) of Etcher (Mac/Linux)
# Windows: https://rufus.ie/
# Mac/Linux: https://www.balena.io/etcher/

# 3. Flash ISO naar USB stick
Netwerk Plan:
Print dit uit of houd het bij de hand:

text

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              IP ADDRESSING PLAN                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Management Network (VLAN 10): 192.168.10.0/24
â”œâ”€ Gateway:      192.168.10.1
â”œâ”€ Node 1:       192.168.10.11  (pve-node1)
â”œâ”€ Node 2:       192.168.10.12  (pve-node2)
â”œâ”€ Node 3:       192.168.10.13  (pve-node3)
â”œâ”€ Node 4:       192.168.10.14  (pve-node4)
â””â”€ Node 5:       192.168.10.15  (pve-node5)

Game Network (VLAN 20): 192.168.20.0/24
â”œâ”€ Gateway:      192.168.20.1
â””â”€ VMs:          192.168.20.10-250

Ceph Network (VLAN 30): 192.168.30.0/24
â”œâ”€ Node 1:       192.168.30.11
â”œâ”€ Node 2:       192.168.30.12
â”œâ”€ Node 3:       192.168.30.13
â”œâ”€ Node 4:       192.168.30.14
â””â”€ Node 5:       192.168.30.15

DNS: 1.1.1.1, 8.8.8.8
ğŸ”§ FASE 1: PROXMOX INSTALLATIE (45 minuten)
Node 1 - Master Node
Stap 1.1: Boot van USB
Bash

1. Steek USB stick in Node 1
2. Power on MS-01
3. Druk F7 (of Del/F2) voor boot menu
4. Selecteer USB stick
5. Boot "Install Proxmox VE"
Stap 1.2: Proxmox Installer
YAML

Scherm 1: EULA
  â˜ Klik "I agree"

Scherm 2: Target Harddisk
  â˜ Selecteer: /dev/nvme0n1 (1TB NVMe)
  â˜ Filesystem: ext4 (of zfs als je wilt)
  â˜ Klik "Next"

Scherm 3: Location and Time Zone
  â˜ Country: Netherlands
  â˜ Time zone: Europe/Amsterdam
  â˜ Keyboard: US (of nl als je Nederlands toetsenbord hebt)

Scherm 4: Administration Password
  â˜ Password: [KIES STERK WACHTWOORD - schrijf op!]
  â˜ Confirm: [Herhaal wachtwoord]
  â˜ Email: admin@example.com

Scherm 5: Network Configuration
  â˜ Management Interface: ens1 (eerste 2.5GbE poort)
  â˜ Hostname: pve-node1.local
  â˜ IP Address: 192.168.10.11/24
  â˜ Gateway: 192.168.10.1
  â˜ DNS Server: 1.1.1.1

Scherm 6: Summary
  â˜ Controleer alles
  â˜ Klik "Install"
  
  â³ Wacht ~5-10 minuten...
  
  â˜ Reboot na installatie
Stap 1.3: Eerste Login
Bash

# Na reboot zie je console met IP adres
# Op je laptop/PC, open browser:

https://192.168.10.11:8006

# Login:
Username: root
Password: [wat je bij installatie invulde]

# âš ï¸ Je krijgt SSL waarschuwing - dit is normaal
# Klik "Advanced" â†’ "Proceed to 192.168.10.11"
Stap 1.4: Post-Install Fixes (via SSH)
Bash

# SSH naar node (vanaf je laptop)
ssh root@192.168.10.11

# Remove subscription nag
sed -Ezi.bak "s/(Ext.Msg.show\(\{\s+title: gettext\('No valid sub)/void\(\{ \/\/\1/g" /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js && systemctl restart pveproxy.service

# Fix repositories
cat > /etc/apt/sources.list.d/pve-no-subscription.list << EOF
deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription
EOF

rm -f /etc/apt/sources.list.d/pve-enterprise.list

# Update systeem
apt update && apt upgrade -y

# Installeer essentials
apt install -y vim htop git curl wget net-tools

# Reboot
reboot
Node 2-5: Herhaal Bovenstaande
Gebruik deze settings:

Node	Hostname	IP
Node 2	pve-node2.local	192.168.10.12
Node 3	pve-node3.local	192.168.10.13
Node 4	pve-node4.local	192.168.10.14
Node 5	pve-node5.local	192.168.10.15
â±ï¸ Parallel werk: Installeer alle 5 nodes tegelijk als je meerdere USB sticks/keyboards hebt!

âœ… VERIFICATIE FASE 1:
Bash

# Op je laptop, test SSH naar alle nodes:
for i in {11..15}; do 
  echo "Testing 192.168.10.$i..."
  ssh -o ConnectTimeout=5 root@192.168.10.$i "hostname"
done

# Verwacht output:
# Testing 192.168.10.11...
# pve-node1
# Testing 192.168.10.12...
# pve-node2
# etc...

# âœ… Als alle nodes antwoorden â†’ GA VERDER
# âŒ Als een node niet antwoordt â†’ Check netwerk/IP configuratie
ğŸŒ FASE 2: NETWERK SETUP (30 minuten)
Stap 2.1: Fysieke Bekabeling
Bash

STOP! Schakel alle nodes UIT voordat je kabels aansluit.

Per Node:
  Port 1 (SFP+ #1)  â†’  10G Switch Port X      [Management + Corosync]
  Port 2 (SFP+ #2)  â†’  10G Switch Port X+1    [Ceph Storage]
  Port 3 (2.5GbE)   â†’  Backbone/Router        [Game Traffic]

Switch configuratie (voorbeeld MikroTik):
  - VLAN 10: Management (untagged)
  - VLAN 20: Game servers
  - VLAN 30: Ceph (untagged op SFP+ #2)
Stap 2.2: Netwerk Configuratie (PER NODE)
âš ï¸ DIT IS KRITIEK - COPY-PASTE ZORGVULDIG!

Bash

# SSH naar Node 1
ssh root@192.168.10.11

# Backup huidige config
cp /etc/network/interfaces /etc/network/interfaces.backup

# Nieuwe configuratie
cat > /etc/network/interfaces << 'EOFNET'
# Loopback
auto lo
iface lo inet loopback

# Physical interface - SFP+ Port 1
auto enp1s0f0
iface enp1s0f0 inet manual

# Physical interface - SFP+ Port 2  
auto enp1s0f1
iface enp1s0f1 inet manual

# Physical interface - 2.5GbE Port 1
auto enp2s0
iface enp2s0 inet manual

# Management Bridge (VLAN 10) - Voor Proxmox GUI + Corosync
auto vmbr0
iface vmbr0 inet static
    address 192.168.10.11/24
    gateway 192.168.10.1
    bridge-ports enp1s0f0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    bridge-vids 2-4094

# Ceph Storage Network (VLAN 30)
auto vmbr1
iface vmbr1 inet static
    address 192.168.30.11/24
    bridge-ports enp1s0f1
    bridge-stp off
    bridge-fd 0
    mtu 9000

# Game Server Bridge (VLAN 20)
auto vmbr2
iface vmbr2 inet static
    address 192.168.20.11/24
    bridge-ports enp2s0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
EOFNET

# âš ï¸ PAS IP ADRESSEN AAN PER NODE!
# Node 2: Vervang .11 door .12
# Node 3: Vervang .11 door .13
# etc...

# Test configuratie ZONDER reboot
ifreload -a

# Als het werkt:
reboot
ğŸ“ Quick Script (automatisch voor alle nodes):
Bash

# Op Node 1, maak dit script:
cat > /root/setup-network.sh << 'EOFSCRIPT'
#!/bin/bash

# Detect node number from hostname
NODE_NUM=$(hostname | grep -oP '\d+$')
MGMT_IP="192.168.10.1${NODE_NUM}"
CEPH_IP="192.168.30.1${NODE_NUM}"
GAME_IP="192.168.20.1${NODE_NUM}"

echo "Configuring network for Node ${NODE_NUM}"
echo "  Management: ${MGMT_IP}"
echo "  Ceph: ${CEPH_IP}"
echo "  Game: ${GAME_IP}"

# Backup
cp /etc/network/interfaces /etc/network/interfaces.backup-$(date +%Y%m%d)

# Write config
cat > /etc/network/interfaces << EOFNET
auto lo
iface lo inet loopback

auto enp1s0f0
iface enp1s0f0 inet manual

auto enp1s0f1
iface enp1s0f1 inet manual

auto enp2s0
iface enp2s0 inet manual

auto vmbr0
iface vmbr0 inet static
    address ${MGMT_IP}/24
    gateway 192.168.10.1
    bridge-ports enp1s0f0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    dns-nameservers 1.1.1.1 8.8.8.8

auto vmbr1
iface vmbr1 inet static
    address ${CEPH_IP}/24
    bridge-ports enp1s0f1
    bridge-stp off
    bridge-fd 0
    mtu 9000

auto vmbr2
iface vmbr2 inet static
    address ${GAME_IP}/24
    bridge-ports enp2s0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
EOFNET

echo "Config written. Rebooting in 10 seconds..."
sleep 10
reboot
EOFSCRIPT

chmod +x /root/setup-network.sh

# Kopieer naar andere nodes
for i in {12..15}; do
  scp /root/setup-network.sh root@192.168.10.$i:/root/
done

# Voer uit op alle nodes (of 1-voor-1 handmatig)
for i in {11..15}; do
  echo "Configuring Node $(($i - 10))..."
  ssh root@192.168.10.$i "/root/setup-network.sh" &
done
âœ… VERIFICATIE FASE 2:
Bash

# Na reboot van alle nodes, test connectiviteit:

# Van Node 1:
ping -c 2 192.168.10.12  # Node 2 management
ping -c 2 192.168.30.12  # Node 2 ceph
ping -c 2 192.168.20.12  # Node 2 game

# Herhaal voor alle nodes

# Check bridges:
ip addr show | grep vmbr

# Verwacht:
# vmbr0: ... 192.168.10.11/24
# vmbr1: ... 192.168.30.11/24  
# vmbr2: ... 192.168.20.11/24
ğŸ‘¥ FASE 3: CLUSTER AANMAKEN (15 minuten)
Stap 3.1: Cluster Create (Node 1 ALLEEN)
Bash

# SSH naar Node 1
ssh root@192.168.10.11

# Maak cluster aan
pvecm create gameserver-cluster --link0 192.168.10.11

# Wacht ~10 seconden
sleep 10

# Check status
pvecm status

# Verwacht output:
# Cluster information
# -------------------
# Name:             gameserver-cluster
# Config Version:   1
# Transport:        knet
# Secure auth:      on
# 
# Quorum information
# ------------------
# Date:             ...
# Quorum provider:  corosync_votequorum
# Nodes:            1
# Node ID:          0x00000001
# Ring ID:          1.5
# Quorate:          Yes    ğŸ‘ˆ BELANGRIJK!
Stap 3.2: Nodes Toevoegen (Node 2-5)
Node 2:

Bash

# SSH naar Node 2
ssh root@192.168.10.12

# Join cluster
pvecm add 192.168.10.11

# Vraagt om:
# - Root password van Node 1: [vul in]
# - Fingerprint verificatie: yes

# Wacht ~20 seconden
sleep 20

# Verificatie
pvecm status

# Verwacht: "Quorate: Yes" en "Nodes: 2"
Herhaal voor Node 3, 4, 5:

Bash

# Node 3:
ssh root@192.168.10.13
pvecm add 192.168.10.11

# Node 4:
ssh root@192.168.10.14
pvecm add 192.168.10.11

# Node 5:
ssh root@192.168.10.15
pvecm add 192.168.10.11
Stap 3.3: Cluster Verificatie
Bash

# Op Node 1:
pvecm status

# Moet tonen:
# Nodes: 5
# Quorate: Yes

# Check alle nodes:
pvecm nodes

# Verwacht:
# Membership information
# ----------------------
#     Nodeid      Votes Name
#          1          1 pve-node1 (local)
#          2          1 pve-node2
#          3          1 pve-node3
#          4          1 pve-node4
#          5          1 pve-node5
ğŸ‰ SUCCESS! Je hebt nu een 5-node cluster!
Open Proxmox Web UI en check Datacenter â†’ alle 5 nodes zichtbaar!

ğŸ—„ï¸ FASE 4: CEPH STORAGE (60 minuten)
âš ï¸ DIT IS DE MEEST TIJDROVENDE STAP

Stap 4.1: Ceph Installatie (ALLE NODES)
Bash

# Maak script op Node 1:
cat > /root/install-ceph.sh << 'EOF'
#!/bin/bash
pveceph install --version quincy
EOF

chmod +x /root/install-ceph.sh

# Kopieer naar alle nodes
for i in {12..15}; do
  scp /root/install-ceph.sh root@192.168.10.$i:/root/
done

# Voer uit op ALLE nodes (parallel)
for i in {11..15}; do
  echo "Installing Ceph on Node $(($i - 10))..."
  ssh root@192.168.10.$i "/root/install-ceph.sh" &
done

# Wacht tot alles klaar is (~10-15 minuten)
wait

echo "âœ… Ceph installed on all nodes"
Stap 4.2: Ceph Initialize (Node 1 ALLEEN)
Bash

# Op Node 1:
pveceph init --network 192.168.30.0/24 --cluster-network 192.168.30.0/24

# Verwacht:
# Created initial ceph.conf
Stap 4.3: Monitors Aanmaken (ALLE NODES)
Bash

# Node 1:
ssh root@192.168.10.11
pveceph mon create

# Node 2:
ssh root@192.168.10.12
pveceph mon create

# Node 3:
ssh root@192.168.10.13
pveceph mon create

# Node 4:
ssh root@192.168.10.14
pveceph mon create

# Node 5:
ssh root@192.168.10.15
pveceph mon create

# Of automatisch:
for i in {11..15}; do
  echo "Creating monitor on 192.168.10.$i..."
  ssh root@192.168.10.$i "pveceph mon create"
done
Stap 4.4: Managers Aanmaken (3 nodes)
Bash

# Node 1:
ssh root@192.168.10.11
pveceph mgr create

# Node 2:
ssh root@192.168.10.12
pveceph mgr create

# Node 3:
ssh root@192.168.10.13
pveceph mgr create
Stap 4.5: OSDs Aanmaken (KRITIEKE STAP!)
âš ï¸ DIT WIST ALLE DATA OP DE DISK!

Bash

# Eerst: Check beschikbare disks
# Op Node 1:
lsblk

# Output ongeveer:
# NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
# nvme0n1     259:0    0 931.5G  0 disk 
# â”œâ”€nvme0n1p1 259:1    0  1007K  0 part 
# â”œâ”€nvme0n1p2 259:2    0     1G  0 part /boot/efi
# â””â”€nvme0n1p3 259:3    0 930.5G  0 part 
#   â”œâ”€pve-root ...                      /
#   â”œâ”€pve-swap ...                      [SWAP]
#   â””â”€pve-data ...                      

# We gebruiken de vrije ruimte in pve-data LVM
# OF we maken een aparte partitie

# OPTIE A: Gebruik LVM thin pool (veilig, maar minder performance)
# Skip naar Stap 4.6

# OPTIE B: Dedicated disk/partitie (betere performance)
# Alleen doen als je een tweede NVMe hebt of partitie kan maken!

# Voor nu: OPTIE A (meeste mensen)
Stap 4.6: Create OSD met LVM
Bash

# Op elke node:

# Node 1:
ssh root@192.168.10.11
pveceph osd create /dev/pve/data --db_dev /dev/pve/data

# Herhaal voor alle nodes...

# OF automatisch (LET OP: controleer of /dev/pve/data bestaat):
for i in {11..15}; do
  echo "Creating OSD on 192.168.10.$i..."
  ssh root@192.168.10.$i "pveceph osd create /dev/pve/data"
  sleep 10
done
â³ Dit duurt ~5-10 minuten per node

Stap 4.7: Check Ceph Status
Bash

# Op Node 1:
ceph -s

# Verwacht (na alle OSDs):
#   cluster:
#     id:     xxx-xxx-xxx
#     health: HEALTH_OK    ğŸ‘ˆ BELANGRIJK!
#  
#   services:
#     mon: 5 daemons
#     mgr: pve-node1(active), standbys: pve-node2, pve-node3
#     osd: 5 osds: 5 up, 5 in
#  
#   data:
#     pools:   1 pools, 1 pgs
#     objects: 0 objects, 0 B
#     usage:   5 GiB used, 4.5 TiB / 4.5 TiB avail
#     pgs:     1 active+clean
Stap 4.8: Create Storage Pools
Bash

# Op Node 1:

# Pool voor VM disks
pveceph pool create ceph-vms --add_storages --size 2 --min_size 1 --pg_num 128

# Pool voor backups
pveceph pool create ceph-backups --add_storages --size 2 --min_size 1 --pg_num 64

# Verificatie:
pvesm status

# Verwacht:
# Name             Type     Status           Total            Used       Available
# ceph-vms         rbd      active      4657741824               0      4657741824
# ceph-backups     rbd      active      4657741824               0      4657741824
# local            dir      active      943718400          ...    
# local-lvm        lvmthin  active      ...
ğŸ‰ CEPH IS KLAAR!
ğŸ® FASE 5: VM TEMPLATE & DEPLOYMENT (30 minuten)
Stap 5.1: Download Ubuntu Cloud Image
Bash

# Op Node 1:
cd /var/lib/vz/template/iso

wget https://cloud-images.ubuntu.com/releases/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img

# Verify download:
ls -lh ubuntu-22.04-server-cloudimg-amd64.img
Stap 5.2: Create VM Template
Bash

# VM ID voor template
TEMPLATE_ID=9000

# Create VM
qm create $TEMPLATE_ID \
  --name ubuntu-22.04-template \
  --memory 2048 \
  --cores 2 \
  --net0 virtio,bridge=vmbr0

# Import cloud image
qm importdisk $TEMPLATE_ID ubuntu-22.04-server-cloudimg-amd64.img ceph-vms

# Attach disk
qm set $TEMPLATE_ID --scsihw virtio-scsi-pci --scsi0 ceph-vms:vm-$TEMPLATE_ID-disk-0

# Add cloud-init drive
qm set $TEMPLATE_ID --ide2 ceph-vms:cloudinit

# Boot settings
qm set $TEMPLATE_ID --boot c --bootdisk scsi0

# Serial console
qm set $TEMPLATE_ID --serial0 socket --vga serial0

# Agent
qm set $TEMPLATE_ID --agent enabled=1

# Convert to template
qm template $TEMPLATE_ID

echo "âœ… Template created with ID $TEMPLATE_ID"
Stap 5.3: Deploy Test VM
Bash

# Clone template
qm clone $TEMPLATE_ID 100 \
  --name test-vm \
  --full \
  --storage ceph-vms

# Configure
qm set 100 --cores 2 --memory 4096

# Resize disk (20GB)
qm resize 100 scsi0 20G

# Network
qm set 100 --ipconfig0 ip=192.168.10.100/24,gw=192.168.10.1

# Cloud-init user
qm set 100 --ciuser ubuntu --cipassword 'YourPassword123!'

# SSH key (optioneel)
# qm set 100 --sshkeys ~/.ssh/id_rsa.pub

# Start VM
qm start 100

# Wacht 30 seconden
sleep 30

# Test SSH
ssh ubuntu@192.168.10.100

# âœ… Als je inlogt â†’ SUCCESS!
ğŸ¯ FASE 6: GAMESERVER SOFTWARE (45 minuten)
Stap 6.1: Clone Setup Scripts naar VMs
Bash

# Download gameserver setup (op Node 1):
cd /root
git clone https://github.com/jouw-repo/gameserver-setup.git

# OF handmatig download onze eerdere scripts

# Kopieer naar test VM:
scp -r gameserver-setup ubuntu@192.168.10.100:~/

# SSH naar VM:
ssh ubuntu@192.168.10.100

# Op de VM:
cd gameserver-setup
cp config.env.example config.env
nano config.env  # Pas aan

# Voer installatie uit:
sudo ./install.sh
Stap 6.2: Deploy Game Nodes
Bash

# Terug op Proxmox Node 1:

# Minecraft Node (4GB RAM)
qm clone 9000 401 --name minecraft-1 --full --storage ceph-vms
qm set 401 --cores 2 --memory 4096
qm resize 401 scsi0 30G
qm set 401 --ipconfig0 ip=192.168.20.41/24,gw=192.168.20.1
qm start 401

# FiveM Node (6GB RAM)
qm clone 9000 301 --name fivem-1 --full --storage ceph-vms
qm set 301 --cores 3 --memory 6144
qm resize 301 scsi0 50G
qm set 301 --ipconfig0 ip=192.168.20.31/24,gw=192.168.20.1
qm start 301

# ARK Node (24GB RAM) - op Node 2 voor spreading
qm clone 9000 201 --name ark-island --full --storage ceph-vms --target pve-node2
qm set 201 --cores 8 --memory 24576
qm resize 201 scsi0 100G
qm set 201 --ipconfig0 ip=192.168.20.21/24,gw=192.168.20.1
qm start 201

# etc...
ğŸ“Š FINALE: MONITORING & VERIFICATIE
Cluster Health Dashboard
Bash

# Op Node 1, maak monitoring script:
cat > /root/cluster-status.sh << 'EOF'
#!/bin/bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘          GAMESERVER CLUSTER STATUS                        â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸŒ CLUSTER:"
pvecm status | grep -E "Nodes:|Quorate:"
echo ""
echo "ğŸ—„ï¸  CEPH:"
ceph health
ceph df | head -5
echo ""
echo "ğŸ® VMs:"
qm list | head -10
echo ""
echo "ğŸ“Š RESOURCES:"
pvesh get /cluster/resources --type node | grep -E 'node|cpu|mem'
EOF

chmod +x /root/cluster-status.sh

# Run it:
/root/cluster-status.sh
âœ… FINAL CHECKLIST
Bash

â˜ Alle 5 nodes online in Proxmox cluster
â˜ Ceph status: HEALTH_OK
â˜ Template aangemaakt (ID 9000)
â˜ Minimaal 1 test VM draait
â˜ SSH werkt naar VMs
â˜ Gameserver software geÃ¯nstalleerd op minimaal 1 VM
â˜ Web UI toegankelijk: https://192.168.10.11:8006
â˜ Monitoring setup (optioneel maar aanbevolen)
ğŸ†˜ TROUBLESHOOTING
"No quorum after adding nodes"
Bash

# Check corosync
systemctl status corosync

# Check network
pvecm status
ping [other-node-ip]

# Reset cluster (LAATSTE REDMIDDEL):
# Op ALLE nodes:
systemctl stop pve-cluster corosync
pmxcfs -l  # Local mode
rm /etc/corosync/*
rm /etc/pve/corosync.conf
rm /var/lib/corosync/*
killall pmxcfs
systemctl start pve-cluster
# Dan opnieuw cluster aanmaken
"Ceph stuck creating OSDs"
Bash

# Check logs
journalctl -u ceph-osd@*.service -f

# List OSDs
ceph osd tree

# Remove stuck OSD:
ceph osd down <osd-id>
ceph osd out <osd-id>
ceph osd rm <osd-id>
ceph auth del osd.<osd-id>
"Can't SSH to VMs"
Bash

# Check VM console first (in Web UI)
# Often cloud-init issue

# Check cloud-init status on VM:
cloud-init status

# Re-run cloud-init:
sudo cloud-init clean
sudo cloud-init init
ğŸŠ GEFELICITEERD!
Je hebt nu:

âœ… 5-node Proxmox cluster
âœ… Ceph distributed storage
âœ… VM deployment systeem
âœ… Basis voor gameserver platform
Volgende stappen:
Deploy meer game VMs
Setup Pterodactyl Panel
Configureer monitoring (Grafana)
Setup automated backups
Test HA failover
Ga live! ğŸš€
Vragen? Issues? Wil je verder?

Laat me weten waar je bent en ik help je verder! ğŸ’ª


ğŸš€ PRODUCTION DEPLOYMENT - COMPLETE GUIDE
ğŸ“‹ OVERVIEW
We gaan nu in 1 run alles productie-klaar maken:

text

FASE 1: Deploy Game VMs        [30 min] âš¡
FASE 2: Pterodactyl Panel       [45 min] ğŸ›ï¸
FASE 3: Monitoring (Grafana)    [30 min] ğŸ“Š
FASE 4: Automated Backups       [20 min] ğŸ’¾
FASE 5: HA Failover Test        [15 min] ğŸ”„
FASE 6: Go Live Checklist       [30 min] ğŸ‰

TOTAAL: ~3 uur
ğŸ® FASE 1: DEPLOY GAME VMs (30 minuten)
Stap 1.1: Mass Deployment Script
Bash

# SSH naar Node 1
ssh root@192.168.10.11

# Create deployment script
cat > /root/deploy-game-vms.sh << 'EOFSCRIPT'
#!/bin/bash
###############################################################################
# Mass Game Server VM Deployment
###############################################################################

set -e

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m'

# Configuration
TEMPLATE_ID=9000
CEPH_STORAGE="ceph-vms"
GAME_GATEWAY="192.168.20.1"
CLOUD_USER="gameserver"
CLOUD_PASS="GameServer2024!"  # Change this!

# VM deployment function
deploy_vm() {
    local VMID=$1
    local NAME=$2
    local NODE=$3
    local CORES=$4
    local RAM=$5
    local DISK=$6
    local IP=$7
    local GAME=$8
    
    echo -e "${BLUE}ğŸ“¦ Deploying: $NAME (VMID: $VMID) on $NODE${NC}"
    
    # Clone from template
    qm clone $TEMPLATE_ID $VMID \
        --name "$NAME" \
        --full \
        --storage $CEPH_STORAGE \
        --target "$NODE" 2>/dev/null || true
    
    sleep 2
    
    # Configure VM
    qm set $VMID \
        --cores $CORES \
        --memory $RAM \
        --balloon 0 \
        --onboot 1 \
        --description "Game: $GAME | Auto-deployed $(date)" \
        --tags "$GAME,production"
    
    # Resize disk
    qm resize $VMID scsi0 ${DISK}G
    
    # Network (Game network bridge)
    qm set $VMID \
        --ipconfig0 "ip=${IP}/24,gw=${GAME_GATEWAY}" \
        --nameserver "1.1.1.1 8.8.8.8"
    
    # Cloud-init credentials
    qm set $VMID \
        --ciuser "$CLOUD_USER" \
        --cipassword "$CLOUD_PASS"
    
    echo -e "${GREEN}âœ… $NAME configured${NC}"
}

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘        GAME SERVER VM MASS DEPLOYMENT                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 1: Panel + Monitoring
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo -e "${BLUE}â•â•â• NODE 1: Control Plane â•â•â•${NC}"

deploy_vm 100 "pterodactyl-panel" "pve-node1" 4 8192 80 "192.168.20.10" "panel"
deploy_vm 101 "pterodactyl-node1" "pve-node1" 4 8192 100 "192.168.20.11" "wings"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 2: ARK + Rust (Heavy Games)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo -e "${BLUE}â•â•â• NODE 2: Heavy Games (ARK, Rust) â•â•â•${NC}"

deploy_vm 201 "ark-theisland" "pve-node2" 8 20480 100 "192.168.20.21" "ark"
deploy_vm 202 "ark-ragnarok" "pve-node2" 8 20480 100 "192.168.20.22" "ark"
deploy_vm 210 "rust-main" "pve-node2" 6 14336 80 "192.168.20.30" "rust"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 3: FiveM (RP Servers)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo -e "${BLUE}â•â•â• NODE 3: FiveM Servers â•â•â•${NC}"

for i in {1..6}; do
    VMID=$((300 + i))
    IP="192.168.20.$((40 + i))"
    deploy_vm $VMID "fivem-rp${i}" "pve-node3" 3 6144 50 "$IP" "fivem"
done

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 4: Minecraft + CS2
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo -e "${BLUE}â•â•â• NODE 4: Minecraft + CS2 â•â•â•${NC}"

# Minecraft servers
for i in {1..8}; do
    VMID=$((400 + i))
    IP="192.168.20.$((50 + i))"
    deploy_vm $VMID "minecraft-${i}" "pve-node4" 2 4096 30 "$IP" "minecraft"
done

# CS2 servers
for i in {1..4}; do
    VMID=$((420 + i))
    IP="192.168.20.$((65 + i))"
    deploy_vm $VMID "cs2-${i}" "pve-node4" 2 3072 30 "$IP" "cs2"
done

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 5: Palworld + Light Games
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo -e "${BLUE}â•â•â• NODE 5: Palworld + Light Games â•â•â•${NC}"

# Palworld
for i in {1..6}; do
    VMID=$((500 + i))
    IP="192.168.20.$((75 + i))"
    deploy_vm $VMID "palworld-${i}" "pve-node5" 2 4096 40 "$IP" "palworld"
done

# Valheim
for i in {1..3}; do
    VMID=$((520 + i))
    IP="192.168.20.$((85 + i))"
    deploy_vm $VMID "valheim-${i}" "pve-node5" 2 4096 30 "$IP" "valheim"
done

echo ""
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${GREEN}â•‘            VM DEPLOYMENT COMPLETED                        â•‘${NC}"
echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo "ğŸ“Š Deployment Summary:"
qm list | grep -E "VMID|ark|rust|fivem|minecraft|cs2|palworld|valheim|panel" | head -35
echo ""
echo "ğŸ¯ Next steps:"
echo "   1. Start VMs: for i in {100,101,201..210,301..306,401..408,421..424,501..506,521..523}; do qm start \$i; done"
echo "   2. Wait 2 minutes for boot"
echo "   3. Verify SSH access"
echo ""
read -p "Start all VMs now? [Y/n]: " START_VMS
START_VMS=${START_VMS:-Y}

if [[ $START_VMS =~ ^[Yy]$ ]]; then
    echo "ğŸš€ Starting all VMs..."
    
    # Start in batches to avoid overload
    for VMID in {100,101}; do qm start $VMID 2>/dev/null &; done
    sleep 10
    
    for VMID in {201..210}; do qm start $VMID 2>/dev/null &; done
    sleep 10
    
    for VMID in {301..306}; do qm start $VMID 2>/dev/null &; done
    sleep 10
    
    for VMID in {401..408}; do qm start $VMID 2>/dev/null &; done
    sleep 10
    
    for VMID in {421..424}; do qm start $VMID 2>/dev/null &; done
    sleep 10
    
    for VMID in {501..506,521..523}; do qm start $VMID 2>/dev/null &; done
    
    echo "âœ… All VMs starting... (wait ~2 minutes for boot)"
fi
EOFSCRIPT

chmod +x /root/deploy-game-vms.sh

# RUN IT!
/root/deploy-game-vms.sh
Stap 1.2: Verify Deployment
Bash

# Wacht 2 minuten voor boot
echo "Waiting for VMs to boot..."
sleep 120

# Test SSH connectivity
cat > /root/test-vm-ssh.sh << 'EOFTEST'
#!/bin/bash
echo "Testing SSH connectivity to VMs..."
echo ""

CLOUD_USER="gameserver"
FAILED=0

test_ssh() {
    local IP=$1
    local NAME=$2
    
    if timeout 5 ssh -o StrictHostKeyChecking=no -o ConnectTimeout=3 ${CLOUD_USER}@${IP} "hostname" &>/dev/null; then
        echo "âœ… $NAME ($IP)"
    else
        echo "âŒ $NAME ($IP) - NOT REACHABLE"
        ((FAILED++))
    fi
}

# Test critical VMs
test_ssh "192.168.20.10" "Panel"
test_ssh "192.168.20.11" "Wings Node 1"
test_ssh "192.168.20.21" "ARK Island"
test_ssh "192.168.20.30" "Rust"
test_ssh "192.168.20.41" "FiveM 1"
test_ssh "192.168.20.51" "Minecraft 1"

echo ""
if [ $FAILED -eq 0 ]; then
    echo "âœ… All tested VMs are reachable!"
else
    echo "âš ï¸  $FAILED VMs failed to respond"
    echo "   Check: qm status <vmid>"
    echo "   Check: qm terminal <vmid>"
fi
EOFTEST

chmod +x /root/test-vm-ssh.sh
/root/test-vm-ssh.sh
ğŸ›ï¸ FASE 2: PTERODACTYL PANEL SETUP (45 minuten)
Stap 2.1: Panel Installation
Bash

# SSH to Panel VM
ssh gameserver@192.168.20.10

# Switch to root
sudo -i

# Download our installation scripts
cd /root
git clone https://github.com/pterodactyl/panel.git pterodactyl-installer
cd pterodactyl-installer

# OR use one-liner installer
curl -sSL https://get.pterodactyl.io/panel | sudo bash
Manual Installation (recommended for control):

Bash

# Update system
apt update && apt upgrade -y

# Install dependencies
apt install -y software-properties-common curl apt-transport-https ca-certificates gnupg
LC_ALL=C.UTF-8 add-apt-repository -y ppa:ondrej/php
curl -fsSL https://packages.redis.io/gpg | gpg --dearmor -o /usr/share/keyrings/redis-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb $(lsb_release -cs) main" | tee /etc/apt/sources.list.d/redis.list
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -

apt update
apt install -y \
    php8.3 php8.3-{common,cli,gd,mysql,mbstring,bcmath,xml,fpm,curl,zip} \
    mariadb-server \
    nginx \
    tar unzip git redis-server \
    nodejs

# Install Composer
curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer

# Create pterodactyl user
useradd -r -d /var/www/pterodactyl -s /bin/bash pterodactyl

# Download Panel
mkdir -p /var/www/pterodactyl
cd /var/www/pterodactyl
curl -Lo panel.tar.gz https://github.com/pterodactyl/panel/releases/latest/download/panel.tar.gz
tar -xzvf panel.tar.gz
chmod -R 755 storage/* bootstrap/cache/

# Database setup
mysql -u root << EOFSQL
CREATE DATABASE panel;
CREATE USER 'pterodactyl'@'127.0.0.1' IDENTIFIED BY 'StrongPassword123!';
GRANT ALL PRIVILEGES ON panel.* TO 'pterodactyl'@'127.0.0.1' WITH GRANT OPTION;
FLUSH PRIVILEGES;
EOFSQL

# Composer install
COMPOSER_ALLOW_SUPERUSER=1 composer install --no-dev --optimize-autoloader

# Environment setup
cp .env.example .env

# Generate app key
php artisan key:generate --force

# Environment config
php artisan p:environment:setup \
    --author=admin@example.com \
    --url=http://192.168.20.10 \
    --timezone=Europe/Amsterdam \
    --cache=redis \
    --session=redis \
    --queue=redis \
    --redis-host=127.0.0.1 \
    --redis-pass= \
    --redis-port=6379 \
    --no-interaction

php artisan p:environment:database \
    --host=127.0.0.1 \
    --port=3306 \
    --database=panel \
    --username=pterodactyl \
    --password=StrongPassword123! \
    --no-interaction

# Database setup
php artisan migrate --seed --force

# Create first user
php artisan p:user:make \
    --email=admin@example.com \
    --username=admin \
    --name-first=Admin \
    --name-last=User \
    --password=AdminPassword123! \
    --admin=1

# Set permissions
chown -R www-data:www-data /var/www/pterodactyl/*

# Crontab
(crontab -l 2>/dev/null; echo "* * * * * php /var/www/pterodactyl/artisan schedule:run >> /dev/null 2>&1") | crontab -

# Queue worker
cat > /etc/systemd/system/pteroq.service << 'EOFQUEUE'
[Unit]
Description=Pterodactyl Queue Worker
After=redis-server.service

[Service]
User=www-data
Group=www-data
Restart=always
ExecStart=/usr/bin/php /var/www/pterodactyl/artisan queue:work --queue=high,standard,low --sleep=3 --tries=3
StartLimitInterval=180
StartLimitBurst=30
RestartSec=5s

[Install]
WantedBy=multi-user.target
EOFQUEUE

systemctl enable --now pteroq.service

# Nginx config
cat > /etc/nginx/sites-available/pterodactyl.conf << 'EOFNGINX'
server {
    listen 80;
    server_name 192.168.20.10;

    root /var/www/pterodactyl/public;
    index index.html index.htm index.php;
    charset utf-8;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    access_log off;
    error_log  /var/log/nginx/pterodactyl.app-error.log error;

    client_max_body_size 100m;
    client_body_timeout 120s;

    sendfile off;

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php8.3-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param PHP_VALUE "upload_max_filesize = 100M \n post_max_size=100M";
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param HTTP_PROXY "";
        fastcgi_intercept_errors off;
        fastcgi_buffer_size 16k;
        fastcgi_buffers 4 16k;
        fastcgi_connect_timeout 300;
        fastcgi_send_timeout 300;
        fastcgi_read_timeout 300;
    }

    location ~ /\.ht {
        deny all;
    }
}
EOFNGINX

ln -s /etc/nginx/sites-available/pterodactyl.conf /etc/nginx/sites-enabled/pterodactyl.conf
rm /etc/nginx/sites-enabled/default

# Test nginx
nginx -t

# Restart services
systemctl restart nginx php8.3-fpm

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘        PTERODACTYL PANEL INSTALLED                        â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸŒ Panel URL: http://192.168.20.10"
echo "ğŸ‘¤ Username: admin@example.com"
echo "ğŸ”‘ Password: AdminPassword123!"
echo ""
echo "âš ï¸  Change password after first login!"
Stap 2.2: Wings Installation (on Node VMs)
Bash

# On Wings VM (192.168.20.11)
ssh gameserver@192.168.20.11
sudo -i

# Install Docker
curl -sSL https://get.docker.com/ | CHANNEL=stable bash
systemctl enable --now docker

# Download Wings
mkdir -p /etc/pterodactyl
curl -L -o /usr/local/bin/wings "https://github.com/pterodactyl/wings/releases/latest/download/wings_linux_$([[ "$(uname -m)" == "x86_64" ]] && echo "amd64" || echo "arm64")"
chmod u+x /usr/local/bin/wings

# Systemd service
cat > /etc/systemd/system/wings.service << 'EOFWINGS'
[Unit]
Description=Pterodactyl Wings Daemon
After=docker.service
Requires=docker.service
PartOf=docker.service

[Service]
User=root
WorkingDirectory=/etc/pterodactyl
LimitNOFILE=4096
PIDFile=/var/run/wings/daemon.pid
ExecStart=/usr/local/bin/wings
Restart=on-failure
StartLimitInterval=180
StartLimitBurst=30
RestartSec=5s

[Install]
WantedBy=multi-user.target
EOFWINGS

systemctl enable wings

echo "âœ… Wings installed - configure via Panel first, then start"
Stap 2.3: Panel Configuration (Web UI)
Bash

# Open browser op je laptop:
http://192.168.20.10

# Login met: admin@example.com / AdminPassword123!

# First time setup:
1. Go to Admin Panel (top right)
2. Locations â†’ Create New
   - Short Code: EU
   - Description: Europe - Main Datacenter

3. Nodes â†’ Create New
   - Name: Game-Node-1
   - FQDN: 192.168.20.11
   - Scheme: HTTP (HTTPS later met SSL)
   - Memory: 8192 MB
   - Disk: 100 GB
   - Location: EU
   - DAEMON SERVER FILE MANAGER: /var/lib/pterodactyl/volumes
   - Click "Create Node"

4. Click on the node â†’ Configuration tab
   - Copy the auto-deploy command
   
5. SSH to Wings VM and paste command:
   ssh gameserver@192.168.20.11
   sudo [paste command]
   
6. Start Wings:
   sudo systemctl start wings
   sudo systemctl status wings
   
# If green â†’ SUCCESS!
Stap 2.4: Import Game Eggs
Bash

# Download egg collection
cd /tmp
git clone https://github.com/parkervcp/eggs.git

# In Panel Web UI:
Admin â†’ Nests â†’ Import Egg

# Import these eggs:
1. Minecraft - Paper
   File: eggs/game_eggs/minecraft/java/paper/egg-paper.json
   
2. FiveM
   File: eggs/game_eggs/gta/fivem/egg-fivem.json
   
3. Rust
   File: eggs/game_eggs/rust/rust/egg-rust.json
   
4. CS2
   File: eggs/game_eggs/valve/counter--strike2/egg-counter--strike2.json
   
5. ARK
   File: eggs/game_eggs/steamcmd_servers/ark_survival_evolved/egg-ark--survival-evolved.json
   
6. Palworld
   File: eggs/game_eggs/steamcmd_servers/palworld/egg-palworld.json
Stap 2.5: Create Test Server
Bash

# In Panel:
Servers â†’ Create New

# Example Minecraft server:
- Name: Minecraft Test
- Owner: admin@example.com
- Node: Game-Node-1
- Egg: Minecraft Paper

# Resource Limits:
- Memory: 2048 MB
- Disk: 10000 MB
- CPU: 100%

# Nest Configuration:
- Server Version: latest

Click "Create Server"

# Wait 2-3 minutes for installation
# Go to server â†’ Console â†’ Should see server starting!

# âœ… If server starts â†’ Pterodactyl is WORKING!
ğŸ“Š FASE 3: MONITORING (GRAFANA) (30 minuten)
Stap 3.1: Deploy Monitoring Stack
Bash

# SSH to Monitoring VM (we'll create a new one)
ssh root@192.168.10.11  # Back to Proxmox Node 1

# Create Monitoring VM
qm clone 9000 900 --name monitoring --full --storage ceph-vms
qm set 900 --cores 4 --memory 8192
qm resize 900 scsi0 100G
qm set 900 --ipconfig0 ip=192.168.20.90/24,gw=192.168.20.1
qm set 900 --ciuser gameserver --cipassword GameServer2024!
qm start 900

# Wait for boot
sleep 60

# SSH to monitoring VM
ssh gameserver@192.168.20.90
sudo -i

# Install Docker
curl -sSL https://get.docker.com/ | bash
systemctl enable --now docker

# Create monitoring stack
mkdir -p /opt/monitoring/{prometheus,grafana,alertmanager}
cd /opt/monitoring

# Docker Compose
cat > docker-compose.yml << 'EOFDOCKER'
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus:/etc/prometheus
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--storage.tsdb.retention.time=30d'
      - '--web.console.libraries=/usr/share/prometheus/console_libraries'
      - '--web.console.templates=/usr/share/prometheus/consoles'
    ports:
      - 9090:9090
    restart: unless-stopped
    networks:
      - monitoring

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - grafana_data:/var/lib/grafana
      - ./grafana:/etc/grafana/provisioning
    environment:
      - GF_SECURITY_ADMIN_USER=admin
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-piechart-panel,grafana-worldmap-panel
      - GF_SERVER_ROOT_URL=http://192.168.20.90:3000
    ports:
      - 3000:3000
    restart: unless-stopped
    networks:
      - monitoring
    depends_on:
      - prometheus

  node-exporter:
    image: prom/node-exporter:latest
    container_name: node-exporter
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    ports:
      - 9100:9100
    restart: unless-stopped
    networks:
      - monitoring

  cadvisor:
    image: gcr.io/cadvisor/cadvisor:latest
    container_name: cadvisor
    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:rw
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
    ports:
      - 8080:8080
    restart: unless-stopped
    networks:
      - monitoring

  alertmanager:
    image: prom/alertmanager:latest
    container_name: alertmanager
    volumes:
      - ./alertmanager:/etc/alertmanager
      - alertmanager_data:/alertmanager
    command:
      - '--config.file=/etc/alertmanager/alertmanager.yml'
      - '--storage.path=/alertmanager'
    ports:
      - 9093:9093
    restart: unless-stopped
    networks:
      - monitoring

volumes:
  prometheus_data:
  grafana_data:
  alertmanager_data:

networks:
  monitoring:
    driver: bridge
EOFDOCKER

# Prometheus config
mkdir -p prometheus
cat > prometheus/prometheus.yml << 'EOFPROM'
global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'gameserver-cluster'
    environment: 'production'

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets: ['alertmanager:9093']

# Load rules
rule_files:
  - 'alerts/*.yml'

scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Proxmox Nodes
  - job_name: 'proxmox-nodes'
    static_configs:
      - targets:
          - '192.168.10.11:9100'
          - '192.168.10.12:9100'
          - '192.168.10.13:9100'
          - '192.168.10.14:9100'
          - '192.168.10.15:9100'
        labels:
          group: 'proxmox'

  # Game Server VMs
  - job_name: 'game-servers'
    static_configs:
      # ARK servers
      - targets:
          - '192.168.20.21:9100'
          - '192.168.20.22:9100'
        labels:
          game: 'ark'
      
      # Rust
      - targets: ['192.168.20.30:9100']
        labels:
          game: 'rust'
      
      # FiveM
      - targets:
          - '192.168.20.41:9100'
          - '192.168.20.42:9100'
          - '192.168.20.43:9100'
        labels:
          game: 'fivem'

  # Docker containers
  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']

  # Pterodactyl
  - job_name: 'pterodactyl'
    static_configs:
      - targets: ['192.168.20.10:9100']
        labels:
          service: 'panel'
EOFPROM

# Alert rules
mkdir -p prometheus/alerts
cat > prometheus/alerts/general.yml << 'EOFALERTS'
groups:
  - name: general
    interval: 30s
    rules:
      # Node down
      - alert: InstanceDown
        expr: up == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Instance {{ $labels.instance }} down"
          description: "{{ $labels.instance }} has been down for more than 5 minutes"

      # High CPU
      - alert: HighCPU
        expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "High CPU on {{ $labels.instance }}"
          description: "CPU usage is above 80% for 10 minutes"

      # High memory
      - alert: HighMemory
        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 > 90
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High memory on {{ $labels.instance }}"
          description: "Memory usage is above 90%"

      # Disk space
      - alert: LowDiskSpace
        expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) * 100 < 10
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Low disk space on {{ $labels.instance }}"
          description: "Less than 10% disk space remaining"
EOFALERTS

# Alertmanager config
cat > alertmanager/alertmanager.yml << 'EOFALERTMGR'
global:
  resolve_timeout: 5m

route:
  group_by: ['alertname', 'cluster']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  receiver: 'default'

receivers:
  - name: 'default'
    # Add your notification channels here
    # Email, Slack, Discord, etc.

inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'instance']
EOFALERTMGR

# Grafana provisioning
mkdir -p grafana/datasources grafana/dashboards
cat > grafana/datasources/prometheus.yml << 'EOFDS'
apiVersion: 1

datasources:
  - name: Prometheus
    type: prometheus
    access: proxy
    url: http://prometheus:9090
    isDefault: true
    editable: true
EOFDS

cat > grafana/dashboards/dashboard.yml << 'EOFDASH'
apiVersion: 1

providers:
  - name: 'Default'
    orgId: 1
    folder: ''
    type: file
    disableDeletion: false
    editable: true
    options:
      path: /etc/grafana/provisioning/dashboards
EOFDASH

# Start stack
docker-compose up -d

echo ""
echo "âœ… Monitoring stack deployed!"
echo ""
echo "ğŸ“Š Access points:"
echo "   â€¢ Grafana:      http://192.168.20.90:3000 (admin/admin)"
echo "   â€¢ Prometheus:   http://192.168.20.90:9090"
echo "   â€¢ Alertmanager: http://192.168.20.90:9093"
echo ""
EOFDOCKER

# Execute above
bash
Stap 3.2: Install Node Exporters on All VMs
Bash

# Create installation script
cat > /root/install-node-exporter.sh << 'EOFEXPORTER'
#!/bin/bash
# Install node_exporter on game VMs

wget https://github.com/prometheus/node_exporter/releases/download/v1.7.0/node_exporter-1.7.0.linux-amd64.tar.gz
tar xvfz node_exporter-1.7.0.linux-amd64.tar.gz
sudo cp node_exporter-1.7.0.linux-amd64/node_exporter /usr/local/bin/
rm -rf node_exporter-1.7.0*

# Systemd service
sudo cat > /etc/systemd/system/node_exporter.service << 'EOFSVC'
[Unit]
Description=Node Exporter
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/node_exporter
Restart=always

[Install]
WantedBy=multi-user.target
EOFSVC

sudo systemctl daemon-reload
sudo systemctl enable --now node_exporter
EOFEXPORTER

# Copy to all game VMs
for IP in 192.168.20.{21,22,30,41,42,43,51}; do
    echo "Installing on $IP..."
    scp /root/install-node-exporter.sh gameserver@$IP:/tmp/
    ssh gameserver@$IP "bash /tmp/install-node-exporter.sh"
done
Stap 3.3: Grafana Dashboards
Bash

# Open Grafana: http://192.168.20.90:3000
# Login: admin / admin (change password!)

# Import dashboards:
1. Click "+" â†’ Import

2. Import these dashboard IDs:
   - 1860: Node Exporter Full
   - 893: Docker and System Monitoring
   - 11074: Node Exporter for Prometheus
   - 12486: Proxmox

3. Select "Prometheus" as datasource

# âœ… You now have full cluster monitoring!
ğŸ’¾ FASE 4: AUTOMATED BACKUPS (20 minuten)
Stap 4.1: Backup Script (Proxmox)
Bash

# On Proxmox Node 1
ssh root@192.168.10.11

cat > /root/cluster-backup.sh << 'EOFBACKUP'
#!/bin/bash
###############################################################################
# Automated Cluster Backup System
###############################################################################

# Configuration
BACKUP_STORAGE="ceph-backups"
BACKUP_DIR="/mnt/backups"
RETENTION_DAYS=7
LOG_FILE="/var/log/cluster-backup.log"
DISCORD_WEBHOOK=""  # Add webhook URL for notifications

# Logging function
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# Discord notification
notify() {
    if [ -n "$DISCORD_WEBHOOK" ]; then
        curl -H "Content-Type: application/json" \
             -d "{\"content\":\"ğŸ”” Backup: $1\"}" \
             "$DISCORD_WEBHOOK" 2>/dev/null
    fi
}

log "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
log "Starting automated backup..."
notify "Cluster backup started"

# Critical VMs (Panel, Monitoring)
CRITICAL_VMS=(100 900)

# Game server VMs (selective backup)
GAME_VMS=(201 202 301 401)

# Backup function
backup_vm() {
    local VMID=$1
    local TYPE=$2
    
    log "Backing up VM $VMID ($TYPE)..."
    
    vzdump $VMID \
        --storage "$BACKUP_STORAGE" \
        --mode snapshot \
        --compress zstd \
        --remove 0 \
        --notes "Automated backup - $TYPE - $(date '+%Y-%m-%d')"
    
    if [ $? -eq 0 ]; then
        log "âœ… VM $VMID backup successful"
    else
        log "âŒ VM $VMID backup FAILED"
        notify "âš ï¸ Backup failed for VM $VMID"
        return 1
    fi
}

# Backup critical VMs (always)
for VMID in "${CRITICAL_VMS[@]}"; do
    backup_vm "$VMID" "critical"
done

# Backup game servers (rotate daily)
DAY_OF_WEEK=$(date +%u)  # 1-7
INDEX=$((DAY_OF_WEEK % ${#GAME_VMS[@]}))
backup_vm "${GAME_VMS[$INDEX]}" "game-rotation"

# Backup Ceph configs
log "Backing up Ceph configuration..."
mkdir -p "$BACKUP_DIR/ceph-config"
ceph config dump > "$BACKUP_DIR/ceph-config/ceph-config-$(date +%Y%m%d).json"
ceph osd tree > "$BACKUP_DIR/ceph-config/osd-tree-$(date +%Y%m%d).txt"

# Backup Proxmox configs
log "Backing up Proxmox configuration..."
mkdir -p "$BACKUP_DIR/proxmox-config"
tar -czf "$BACKUP_DIR/proxmox-config/pve-config-$(date +%Y%m%d).tar.gz" \
    /etc/pve \
    /etc/network/interfaces \
    /etc/hostname

# Cleanup old backups
log "Cleaning up old backups (retention: ${RETENTION_DAYS} days)..."
find "$BACKUP_DIR" -type f -mtime +${RETENTION_DAYS} -delete

log "Backup completed successfully"
notify "âœ… Cluster backup completed"
log "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Show backup summary
pvesm list "$BACKUP_STORAGE" | tail -10
EOFBACKUP

chmod +x /root/cluster-backup.sh

# Test run
/root/cluster-backup.sh
Stap 4.2: Backup Scheduling
Bash

# Add to crontab (daily at 3 AM)
(crontab -l 2>/dev/null; echo "0 3 * * * /root/cluster-backup.sh") | crontab -

# Verify crontab
crontab -l

# For immediate testing:
# */30 * * * * /root/cluster-backup.sh  # Every 30 min
Stap 4.3: Pterodactyl Backup
Bash

# On Panel VM (192.168.20.10)
ssh gameserver@192.168.20.10
sudo -i

cat > /root/pterodactyl-backup.sh << 'EOFPANELBACKUP'
#!/bin/bash
BACKUP_DIR="/backup/pterodactyl"
DATE=$(date +%Y%m%d-%H%M%S)

mkdir -p "$BACKUP_DIR"

# Database backup
mysqldump -u pterodactyl -pStrongPassword123! panel | gzip > "$BACKUP_DIR/panel-db-$DATE.sql.gz"

# Files backup
tar -czf "$BACKUP_DIR/panel-files-$DATE.tar.gz" /var/www/pterodactyl

# Cleanup old backups (keep 14 days)
find "$BACKUP_DIR" -type f -mtime +14 -delete

echo "âœ… Pterodactyl backup completed: $DATE"
EOFPANELBACKUP

chmod +x /root/pterodactyl-backup.sh

# Schedule
(crontab -l 2>/dev/null; echo "0 2 * * * /root/pterodactyl-backup.sh") | crontab -
ğŸ”„ FASE 5: HA FAILOVER TEST (15 minuten)
Stap 5.1: Enable HA for Critical VMs
Bash

# On Proxmox Node 1
ssh root@192.168.10.11

# Create HA group
ha-manager groupadd critical \
    --nodes "pve-node1:3,pve-node2:2,pve-node3:1" \
    --nofailback 0 \
    --restricted 0 \
    --comment "Critical services - highest priority"

# Add Panel to HA
ha-manager add vm:100 \
    --group critical \
    --state started \
    --max_restart 3 \
    --max_relocate 3 \
    --comment "Pterodactyl Panel"

# Add Monitoring to HA
ha-manager add vm:900 \
    --group critical \
    --state started \
    --max_restart 2 \
    --max_relocate 2 \
    --comment "Monitoring Stack"

# Verify HA configuration
ha-manager config

# Expected output:
# vm:100
#     comment Pterodactyl Panel
#     group critical
#     max_relocate 3
#     max_restart 3
#     state started
Stap 5.2: Simulate Node Failure
Bash

# âš ï¸ WARNING: This will REBOOT Node 2!

# Step 1: Check current VM location
qm status 100  # Panel should be on node1

# Step 2: Migrate Panel to Node 2 for testing
qm migrate 100 pve-node2 --online

# Wait for migration
sleep 30

# Step 3: Verify Panel is on Node 2
qm status 100  # Should show running on pve-node2

# Step 4: Simulate Node 2 failure (SSH to Node 2 and reboot)
ssh root@192.168.10.12 "echo 'Simulating failure...' && reboot"

# Step 5: Watch HA manager (on Node 1)
watch -n 2 'ha-manager status'

# You should see:
# - VM 100 status changes to "fence" or "recovery"
# - After ~2 minutes: VM starts on another node (Node 1 or 3)
# - Status becomes "started" again

# Step 6: Verify Panel is accessible
curl -I http://192.168.20.10

# âœ… If you get HTTP 200 â†’ HA WORKS!

# Step 7: Node 2 comes back online
# (Wait for Node 2 to reboot, ~3 minutes)

# Step 8: Verify cluster quorum restored
pvecm status  # Should show all 5 nodes again
Stap 5.3: Live Migration Test
Bash

# Test seamless migration (no downtime)

# Start a VM
qm start 401  # Minecraft server

# Live migrate to another node
qm migrate 401 pve-node5 --online

# On another terminal, continuously ping the VM:
ping 192.168.20.51

# You should see:
# - 0 or minimal packet loss during migration
# - Migration completes in 10-30 seconds
# - VM keeps running without restart

# âœ… If migration succeeds with minimal disruption â†’ SUCCESS!
ğŸ‰ FASE 6: GO LIVE CHECKLIST (30 minuten)
Stap 6.1: Security Hardening
Bash

# On Proxmox Node 1
ssh root@192.168.10.11

cat > /root/security-hardening.sh << 'EOFSEC'
#!/bin/bash
echo "ğŸ”’ Security Hardening..."

# Update all systems
echo "Updating all nodes..."
for NODE in {11..15}; do
    ssh root@192.168.10.$NODE "apt update && apt upgrade -y" &
done
wait

# SSH hardening
for NODE in {11..15}; do
    echo "Hardening SSH on Node $((NODE-10))..."
    ssh root@192.168.10.$NODE << 'EOFSSH'
        # Disable root password login
        sed -i 's/#PermitRootLogin yes/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config
        sed -i 's/PermitRootLogin yes/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config
        
        # Disable password authentication (use keys only)
        sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
        sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
        
        systemctl restart sshd
EOFSSH
done

# Firewall on game VMs
for IP in 192.168.20.{10,11,21,22,30,41,51,90}; do
    echo "Configuring firewall on $IP..."
    ssh gameserver@$IP << 'EOFFW'
        sudo apt install -y ufw
        sudo ufw default deny incoming
        sudo ufw default allow outgoing
        sudo ufw allow 22/tcp
        sudo ufw allow 9100/tcp  # Node exporter
        # Game-specific ports added per server
        sudo ufw --force enable
EOFFW
done

# Fail2ban on critical VMs
ssh gameserver@192.168.20.10 << 'EOFF2B'
    sudo apt install -y fail2ban
    sudo systemctl enable fail2ban
EOFF2B

echo "âœ… Security hardening complete"
EOFSEC

chmod +x /root/security-hardening.sh
/root/security-hardening.sh
Stap 6.2: Performance Tuning
Bash

# Optimize Ceph
ssh root@192.168.10.11

# Ceph tuning
ceph config set osd osd_memory_target 4294967296  # 4GB per OSD
ceph config set osd osd_max_backfills 1
ceph config set osd osd_recovery_max_active 3

# Check Ceph performance
ceph osd pool set ceph-vms pg_autoscale_mode on
ceph osd pool set ceph-backups pg_autoscale_mode on

# VM I/O optimization
for VMID in {100,201,202,301,401}; do
    qm set $VMID --scsi0 ceph-vms:vm-${VMID}-disk-0,cache=writeback,discard=on
done
Stap 6.3: Monitoring Alerts
Bash

# Configure Discord webhook for alerts
DISCORD_WEBHOOK="https://discord.com/api/webhooks/YOUR_WEBHOOK_HERE"

# Add to Alertmanager
ssh gameserver@192.168.20.90

sudo tee -a /opt/monitoring/alertmanager/alertmanager.yml << EOFDISCORD
receivers:
  - name: 'discord'
    webhook_configs:
      - url: '$DISCORD_WEBHOOK'
        send_resolved: true

route:
  receiver: 'discord'
  group_by: ['alertname']
EOFDISCORD

# Restart alertmanager
cd /opt/monitoring
sudo docker-compose restart alertmanager
Stap 6.4: Documentation
Bash

# Generate cluster documentation
cat > /root/CLUSTER_INFO.md << 'EOFDOC'
# Gameserver Cluster - Production Setup

## Cluster Overview
- **Nodes:** 5Ã— MS-01 (i9-12900H, 32GB RAM)
- **Total Resources:** 70 cores, 160GB RAM, 5TB storage
- **Platform:** Proxmox VE + Ceph
- **Management:** Pterodactyl Panel

## Network Layout
| Network | VLAN | Subnet | Purpose |
|---------|------|--------|---------|
| Management | 10 | 192.168.10.0/24 | Proxmox + Corosync |
| Game | 20 | 192.168.20.0/24 | Game servers (public) |
| Ceph | 30 | 192.168.30.0/24 | Storage backend |

## Node Allocation
| Node | IP | Role | VMs |
|------|-----|------|-----|
| pve-node1 | .11 | Control | Panel, Wings |
| pve-node2 | .12 | Heavy | ARK, Rust |
| pve-node3 | .13 | FiveM | RP Servers |
| pve-node4 | .14 | Minecraft | MC + CS2 |
| pve-node5 | .15 | Light | Palworld, Valheim |

## Critical Services
- **Panel:** http://192.168.20.10
- **Monitoring:** http://192.168.20.90:3000
- **Proxmox:** https://192.168.10.11:8006

## Backup Schedule
- **Proxmox VMs:** Daily 03:00 (7 day retention)
- **Pterodactyl:** Daily 02:00 (14 day retention)
- **Ceph configs:** Daily 03:00
- **Storage:** ceph-backups pool

## Maintenance Contacts
- Admin: admin@example.com
- Emergency: [phone number]

## Common Commands

### Cluster Status
```bash
pvecm status
ceph -s
ha-manager status
VM Management
Bash

qm list                    # List all VMs
qm start <vmid>           # Start VM
qm migrate <vmid> <node>  # Migrate VM
Backups
Bash

/root/cluster-backup.sh   # Manual backup
pvesm list ceph-backups   # List backups
Monitoring
Bash

/root/cluster-status.sh   # Quick status
Troubleshooting
See: /root/TROUBLESHOOTING.md

Change Log
2024-XX-XX: Initial deployment
EOFDOC
echo "âœ… Documentation created: /root/CLUSTER_INFO.md"

text


## **Stap 6.5: Final Verification Checklist**

```bash
cat > /root/go-live-checklist.sh << 'EOFCHECK'
#!/bin/bash
###############################################################################
# Production Go-Live Checklist
###############################################################################

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘          PRODUCTION GO-LIVE CHECKLIST                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

PASSED=0
FAILED=0

check() {
    local TEST="$1"
    local COMMAND="$2"
    
    echo -n "Testing: $TEST... "
    if eval "$COMMAND" &>/dev/null; then
        echo -e "${GREEN}âœ… PASS${NC}"
        ((PASSED++))
    else
        echo -e "${RED}âŒ FAIL${NC}"
        ((FAILED++))
    fi
}

# Infrastructure Checks
echo "â”â”â” INFRASTRUCTURE â”â”â”"
check "Cluster Quorum" "pvecm status | grep -q 'Quorate.*Yes'"
check "All Nodes Online" "[ $(pvecm nodes | grep -c 'pve-node') -eq 5 ]"
check "Ceph Health" "ceph health | grep -q 'HEALTH_OK'"
check "Ceph Storage Available" "[ $(ceph df | grep TOTAL | awk '{print $3}') -gt 100 ]"

# Services
echo ""
echo "â”â”â” CORE SERVICES â”â”â”"
check "Pterodactyl Panel" "curl -sf http://192.168.20.10 >/dev/null"
check "Pterodactyl Wings" "systemctl is-active --quiet wings"
check "Grafana" "curl -sf http://192.168.20.90:3000 >/dev/null"
check "Prometheus" "curl -sf http://192.168.20.90:9090 >/dev/null"

# High Availability
echo ""
echo "â”â”â” HIGH AVAILABILITY â”â”â”"
check "HA Groups Configured" "ha-manager groupconfig | grep -q critical"
check "HA Resources Active" "ha-manager status | grep -q 'started'"

# Backups
echo ""
echo "â”â”â” BACKUP SYSTEM â”â”â”"
check "Backup Script Exists" "[ -f /root/cluster-backup.sh ]"
check "Backup Cron Configured" "crontab -l | grep -q cluster-backup"
check "Backup Storage Available" "pvesm status | grep -q ceph-backups"

# Security
echo ""
echo "â”â”â” SECURITY â”â”â”"
check "SSH Hardened" "grep -q 'PermitRootLogin prohibit-password' /etc/ssh/sshd_config"
check "Fail2ban Running" "systemctl is-active --quiet fail2ban || true"  # Optional

# Monitoring
echo ""
echo "â”â”â” MONITORING â”â”â”"
check "Prometheus Scraping" "curl -s http://192.168.20.90:9090/api/v1/targets | grep -q '\"health\":\"up\"'"
check "Grafana Datasource" "[ $(curl -s -u admin:admin http://192.168.20.90:3000/api/datasources | jq length) -gt 0 ] || true"

# Sample Game Servers
echo ""
echo "â”â”â” GAME SERVERS (SAMPLE) â”â”â”"
check "ARK Server VM" "qm status 201 | grep -q running"
check "Minecraft Server VM" "qm status 401 | grep -q running"

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "RESULTS:"
echo -e "  ${GREEN}Passed: $PASSED${NC}"
echo -e "  ${RED}Failed: $FAILED${NC}"
echo ""

if [ $FAILED -eq 0 ]; then
    echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${GREEN}â•‘                                                           â•‘${NC}"
    echo -e "${GREEN}â•‘           ğŸ‰ READY FOR PRODUCTION! ğŸ‰                    â•‘${NC}"
    echo -e "${GREEN}â•‘                                                           â•‘${NC}"
    echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "âœ… All checks passed!"
    echo ""
    echo "Next steps:"
    echo "  1. Test game server deployments via Pterodactyl"
    echo "  2. Configure DNS for public access"
    echo "  3. Setup SSL certificates"
    echo "  4. Open external firewall ports"
    echo "  5. Announce to users!"
else
    echo -e "${YELLOW}âš ï¸  Some checks failed - review before going live${NC}"
fi
EOFCHECK

chmod +x /root/go-live-checklist.sh
/root/go-live-checklist.sh
Stap 6.6: Go Live!
Bash

# Final steps for production

# 1. Configure external firewall/router
# Port forwards needed:
# - Game ports (varies per game)
# - Panel: 80/443 â†’ 192.168.20.10
# - Optional: Monitoring: 3000 â†’ 192.168.20.90

# 2. Setup DNS (if using domain)
# panel.yourdomain.com â†’ [your public IP]

# 3. SSL Certificates (Let's Encrypt)
ssh gameserver@192.168.20.10
sudo apt install -y certbot python3-certbot-nginx
sudo certbot --nginx -d panel.yourdomain.com

# 4. Test from external network
# From your phone/laptop (not on same network):
curl http://[your-public-ip]

# 5. Create first customer server
# - Login to Pterodactyl
# - Create â†’ New Server
# - Configure â†’ Start
# - Test connection from internet

# 6. Monitor first 24 hours
# - Watch Grafana dashboards
# - Check backup completion
# - Monitor resource usage
# - Test HA if needed

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                                                           â•‘"
echo "â•‘              ğŸš€ CLUSTER IS LIVE! ğŸš€                      â•‘"
echo "â•‘                                                           â•‘"
echo "â•‘  You now have a production-grade gameserver cluster!     â•‘"
echo "â•‘                                                           â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“Š Cluster Stats:"
echo "   â€¢ Nodes: 5"
echo "   â€¢ VMs Deployed: $(qm list | wc -l)"
echo "   â€¢ Storage: $(ceph df | grep TOTAL | awk '{print $3}') GB available"
echo "   â€¢ Panel: http://192.168.20.10"
echo "   â€¢ Monitoring: http://192.168.20.90:3000"
echo ""
echo "ğŸ“š Documentation: /root/CLUSTER_INFO.md"
echo "ğŸ”§ Maintenance: /root/cluster-status.sh"
echo "ğŸ’¾ Backups: Automated daily at 03:00"
echo ""
echo "ğŸ® Happy gaming! ğŸ®"
ğŸŠ CONGRATULATIONS!
Je hebt nu:
âœ… 5-node Proxmox cluster met Ceph storage
âœ… 40+ Game VMs deployed en klaar voor gebruik
âœ… Pterodactyl Panel voor gameserver management
âœ… Complete monitoring met Grafana + Prometheus
âœ… Automated backups (dagelijks)
âœ… High Availability met auto-failover
âœ… Production-ready infrastructuur

Performance Stats:
text

Total Capacity:
â”œâ”€ 70 CPU cores (100 threads)
â”œâ”€ 160GB RAM
â”œâ”€ 5TB NVMe storage
â””â”€ 50Gbit+ network

Deployed Services:
â”œâ”€ ~40 game server VMs
â”œâ”€ Pterodactyl management
â”œâ”€ Full monitoring stack
â””â”€ Automated operations

Reliability:
â”œâ”€ N+1 redundancy (Ceph)
â”œâ”€ Auto-failover (HA)
â”œâ”€ Daily backups
â””â”€ 99.9%+ uptime target
What You Can Do Now:
Deploy game servers via Pterodactyl (1-click)
Scale up - Add more VMs as needed
Monitor everything - Grafana dashboards
Sleep peacefully - HA handles failures
Grow business - Infrastructure supports 100+ servers
Quick Reference Card:
Bash

# Cluster Status
pvecm status              # Cluster health
ceph -s                   # Storage health
qm list                   # All VMs
ha-manager status         # HA status

# Common Tasks
qm start <vmid>          # Start VM
qm migrate <vmid> node   # Move VM
qm snapshot <vmid> name  # Snapshot
vzdump <vmid>            # Backup

# Troubleshooting
/root/cluster-status.sh          # Quick overview
/root/go-live-checklist.sh       # Health check
journalctl -u pve-cluster        # Cluster logs
ceph health detail               # Ceph issues

# Access Points
Panel:      http://192.168.20.10
Grafana:    http://192.168.20.90:3000
Proxmox:    https://192.168.10.11:8006
Next Level Enhancements:
Want to go even further?

ğŸŒ Multi-location - Add nodes in different datacenters
ğŸ¤– Auto-scaling - Automatic VM creation based on demand
ğŸ’³ Billing integration - WHMCS/Blesta for customer management
ğŸ” Advanced security - WAF, IDS/IPS, 2FA
ğŸ“± Mobile app - Monitor from your phone
ğŸ¯ Load balancing - Distribute players across servers
ğŸš€ Kubernetes - Container orchestration for advanced setups
Laat me weten als je:

Ergens vast loopt
Meer optimalisatie wilt
Specifieke games wilt configureren
Advanced features wilt toevoegen
JE BENT KLAAR OM TE ROCKEN! ğŸ¸






Deploy meer game VMs
Setup Pterodactyl Panel
Configureer monitoring (Grafana)
Setup automated backups
Test HA failover
Ga live! ğŸš€

claude-sonnet-4-5-20250929-thinking-32k

Thought for 2 seconds

ğŸš€ DIRECT AAN DE SLAG - INSTALLATIE GUIDE
âš¡ SNELSTART (voor ongeduldiggen)
Als je gewoon NU wilt beginnen:

Bash

# 1. Download setup op Node 1
cd /root
git clone https://github.com/jouw-repo/gameserver-cluster.git
cd gameserver-cluster

# 2. Kopieer en pas config aan
cp config-cluster.env.example config-cluster.env
nano config-cluster.env  # Pas IPs aan!

# 3. Start!
chmod +x install-cluster.sh
./install-cluster.sh
Maar... voor de beste ervaring, volg de volledige guide hieronder ğŸ‘‡

ğŸ“‹ PRE-INSTALLATIE CHECKLIST
âœ… STAP 0: VOORDAT JE BEGINT (15 minuten)
Hardware Check:
Bash

â˜ 5Ã— MS-01 nodes uitgepakt en aangesloten op stroom
â˜ Keyboard + monitor beschikbaar (tijdelijk, voor Proxmox install)
â˜ USB stick (min 8GB) voor Proxmox ISO
â˜ 10G switch (MikroTik/Ubiquiti/etc.)
â˜ 10Ã— SFP+ DAC cables (of transceivers + fiber)
â˜ 5Ã— Ethernet kabels (voor initiÃ«le setup)
â˜ Laptop/PC op zelfde netwerk
Software Downloads:
Bash

# Op je laptop/PC:

# 1. Proxmox VE ISO
wget https://www.proxmox.com/en/downloads?task=callelement&format=raw&item_id=784&element=f85c494b-2b32-4109-b8c1-083cca2b7db6&method=download

# Of via browser:
https://www.proxmox.com/en/downloads/proxmox-virtual-environment/iso

# 2. Rufus (Windows) of Etcher (Mac/Linux)
# Windows: https://rufus.ie/
# Mac/Linux: https://www.balena.io/etcher/

# 3. Flash ISO naar USB stick
Netwerk Plan:
Print dit uit of houd het bij de hand:

text

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              IP ADDRESSING PLAN                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Management Network (VLAN 10): 192.168.10.0/24
â”œâ”€ Gateway:      192.168.10.1
â”œâ”€ Node 1:       192.168.10.11  (pve-node1)
â”œâ”€ Node 2:       192.168.10.12  (pve-node2)
â”œâ”€ Node 3:       192.168.10.13  (pve-node3)
â”œâ”€ Node 4:       192.168.10.14  (pve-node4)
â””â”€ Node 5:       192.168.10.15  (pve-node5)

Game Network (VLAN 20): 192.168.20.0/24
â”œâ”€ Gateway:      192.168.20.1
â””â”€ VMs:          192.168.20.10-250

Ceph Network (VLAN 30): 192.168.30.0/24
â”œâ”€ Node 1:       192.168.30.11
â”œâ”€ Node 2:       192.168.30.12
â”œâ”€ Node 3:       192.168.30.13
â”œâ”€ Node 4:       192.168.30.14
â””â”€ Node 5:       192.168.30.15

DNS: 1.1.1.1, 8.8.8.8
ğŸ”§ FASE 1: PROXMOX INSTALLATIE (45 minuten)
Node 1 - Master Node
Stap 1.1: Boot van USB
Bash

1. Steek USB stick in Node 1
2. Power on MS-01
3. Druk F7 (of Del/F2) voor boot menu
4. Selecteer USB stick
5. Boot "Install Proxmox VE"
Stap 1.2: Proxmox Installer
YAML

Scherm 1: EULA
  â˜ Klik "I agree"

Scherm 2: Target Harddisk
  â˜ Selecteer: /dev/nvme0n1 (1TB NVMe)
  â˜ Filesystem: ext4 (of zfs als je wilt)
  â˜ Klik "Next"

Scherm 3: Location and Time Zone
  â˜ Country: Netherlands
  â˜ Time zone: Europe/Amsterdam
  â˜ Keyboard: US (of nl als je Nederlands toetsenbord hebt)

Scherm 4: Administration Password
  â˜ Password: [KIES STERK WACHTWOORD - schrijf op!]
  â˜ Confirm: [Herhaal wachtwoord]
  â˜ Email: admin@example.com

Scherm 5: Network Configuration
  â˜ Management Interface: ens1 (eerste 2.5GbE poort)
  â˜ Hostname: pve-node1.local
  â˜ IP Address: 192.168.10.11/24
  â˜ Gateway: 192.168.10.1
  â˜ DNS Server: 1.1.1.1

Scherm 6: Summary
  â˜ Controleer alles
  â˜ Klik "Install"
  
  â³ Wacht ~5-10 minuten...
  
  â˜ Reboot na installatie
Stap 1.3: Eerste Login
Bash

# Na reboot zie je console met IP adres
# Op je laptop/PC, open browser:

https://192.168.10.11:8006

# Login:
Username: root
Password: [wat je bij installatie invulde]

# âš ï¸ Je krijgt SSL waarschuwing - dit is normaal
# Klik "Advanced" â†’ "Proceed to 192.168.10.11"
Stap 1.4: Post-Install Fixes (via SSH)
Bash

# SSH naar node (vanaf je laptop)
ssh root@192.168.10.11

# Remove subscription nag
sed -Ezi.bak "s/(Ext.Msg.show\(\{\s+title: gettext\('No valid sub)/void\(\{ \/\/\1/g" /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js && systemctl restart pveproxy.service

# Fix repositories
cat > /etc/apt/sources.list.d/pve-no-subscription.list << EOF
deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription
EOF

rm -f /etc/apt/sources.list.d/pve-enterprise.list

# Update systeem
apt update && apt upgrade -y

# Installeer essentials
apt install -y vim htop git curl wget net-tools

# Reboot
reboot
Node 2-5: Herhaal Bovenstaande
Gebruik deze settings:

Node	Hostname	IP
Node 2	pve-node2.local	192.168.10.12
Node 3	pve-node3.local	192.168.10.13
Node 4	pve-node4.local	192.168.10.14
Node 5	pve-node5.local	192.168.10.15
â±ï¸ Parallel werk: Installeer alle 5 nodes tegelijk als je meerdere USB sticks/keyboards hebt!

âœ… VERIFICATIE FASE 1:
Bash

# Op je laptop, test SSH naar alle nodes:
for i in {11..15}; do 
  echo "Testing 192.168.10.$i..."
  ssh -o ConnectTimeout=5 root@192.168.10.$i "hostname"
done

# Verwacht output:
# Testing 192.168.10.11...
# pve-node1
# Testing 192.168.10.12...
# pve-node2
# etc...

# âœ… Als alle nodes antwoorden â†’ GA VERDER
# âŒ Als een node niet antwoordt â†’ Check netwerk/IP configuratie
ğŸŒ FASE 2: NETWERK SETUP (30 minuten)
Stap 2.1: Fysieke Bekabeling
Bash

STOP! Schakel alle nodes UIT voordat je kabels aansluit.

Per Node:
  Port 1 (SFP+ #1)  â†’  10G Switch Port X      [Management + Corosync]
  Port 2 (SFP+ #2)  â†’  10G Switch Port X+1    [Ceph Storage]
  Port 3 (2.5GbE)   â†’  Backbone/Router        [Game Traffic]

Switch configuratie (voorbeeld MikroTik):
  - VLAN 10: Management (untagged)
  - VLAN 20: Game servers
  - VLAN 30: Ceph (untagged op SFP+ #2)
Stap 2.2: Netwerk Configuratie (PER NODE)
âš ï¸ DIT IS KRITIEK - COPY-PASTE ZORGVULDIG!

Bash

# SSH naar Node 1
ssh root@192.168.10.11

# Backup huidige config
cp /etc/network/interfaces /etc/network/interfaces.backup

# Nieuwe configuratie
cat > /etc/network/interfaces << 'EOFNET'
# Loopback
auto lo
iface lo inet loopback

# Physical interface - SFP+ Port 1
auto enp1s0f0
iface enp1s0f0 inet manual

# Physical interface - SFP+ Port 2  
auto enp1s0f1
iface enp1s0f1 inet manual

# Physical interface - 2.5GbE Port 1
auto enp2s0
iface enp2s0 inet manual

# Management Bridge (VLAN 10) - Voor Proxmox GUI + Corosync
auto vmbr0
iface vmbr0 inet static
    address 192.168.10.11/24
    gateway 192.168.10.1
    bridge-ports enp1s0f0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    bridge-vids 2-4094

# Ceph Storage Network (VLAN 30)
auto vmbr1
iface vmbr1 inet static
    address 192.168.30.11/24
    bridge-ports enp1s0f1
    bridge-stp off
    bridge-fd 0
    mtu 9000

# Game Server Bridge (VLAN 20)
auto vmbr2
iface vmbr2 inet static
    address 192.168.20.11/24
    bridge-ports enp2s0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
EOFNET

# âš ï¸ PAS IP ADRESSEN AAN PER NODE!
# Node 2: Vervang .11 door .12
# Node 3: Vervang .11 door .13
# etc...

# Test configuratie ZONDER reboot
ifreload -a

# Als het werkt:
reboot
ğŸ“ Quick Script (automatisch voor alle nodes):
Bash

# Op Node 1, maak dit script:
cat > /root/setup-network.sh << 'EOFSCRIPT'
#!/bin/bash

# Detect node number from hostname
NODE_NUM=$(hostname | grep -oP '\d+$')
MGMT_IP="192.168.10.1${NODE_NUM}"
CEPH_IP="192.168.30.1${NODE_NUM}"
GAME_IP="192.168.20.1${NODE_NUM}"

echo "Configuring network for Node ${NODE_NUM}"
echo "  Management: ${MGMT_IP}"
echo "  Ceph: ${CEPH_IP}"
echo "  Game: ${GAME_IP}"

# Backup
cp /etc/network/interfaces /etc/network/interfaces.backup-$(date +%Y%m%d)

# Write config
cat > /etc/network/interfaces << EOFNET
auto lo
iface lo inet loopback

auto enp1s0f0
iface enp1s0f0 inet manual

auto enp1s0f1
iface enp1s0f1 inet manual

auto enp2s0
iface enp2s0 inet manual

auto vmbr0
iface vmbr0 inet static
    address ${MGMT_IP}/24
    gateway 192.168.10.1
    bridge-ports enp1s0f0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    dns-nameservers 1.1.1.1 8.8.8.8

auto vmbr1
iface vmbr1 inet static
    address ${CEPH_IP}/24
    bridge-ports enp1s0f1
    bridge-stp off
    bridge-fd 0
    mtu 9000

auto vmbr2
iface vmbr2 inet static
    address ${GAME_IP}/24
    bridge-ports enp2s0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
EOFNET

echo "Config written. Rebooting in 10 seconds..."
sleep 10
reboot
EOFSCRIPT

chmod +x /root/setup-network.sh

# Kopieer naar andere nodes
for i in {12..15}; do
  scp /root/setup-network.sh root@192.168.10.$i:/root/
done

# Voer uit op alle nodes (of 1-voor-1 handmatig)
for i in {11..15}; do
  echo "Configuring Node $(($i - 10))..."
  ssh root@192.168.10.$i "/root/setup-network.sh" &
done
âœ… VERIFICATIE FASE 2:
Bash

# Na reboot van alle nodes, test connectiviteit:

# Van Node 1:
ping -c 2 192.168.10.12  # Node 2 management
ping -c 2 192.168.30.12  # Node 2 ceph
ping -c 2 192.168.20.12  # Node 2 game

# Herhaal voor alle nodes

# Check bridges:
ip addr show | grep vmbr

# Verwacht:
# vmbr0: ... 192.168.10.11/24
# vmbr1: ... 192.168.30.11/24  
# vmbr2: ... 192.168.20.11/24
ğŸ‘¥ FASE 3: CLUSTER AANMAKEN (15 minuten)
Stap 3.1: Cluster Create (Node 1 ALLEEN)
Bash

# SSH naar Node 1
ssh root@192.168.10.11

# Maak cluster aan
pvecm create gameserver-cluster --link0 192.168.10.11

# Wacht ~10 seconden
sleep 10

# Check status
pvecm status

# Verwacht output:
# Cluster information
# -------------------
# Name:             gameserver-cluster
# Config Version:   1
# Transport:        knet
# Secure auth:      on
# 
# Quorum information
# ------------------
# Date:             ...
# Quorum provider:  corosync_votequorum
# Nodes:            1
# Node ID:          0x00000001
# Ring ID:          1.5
# Quorate:          Yes    ğŸ‘ˆ BELANGRIJK!
Stap 3.2: Nodes Toevoegen (Node 2-5)
Node 2:

Bash

# SSH naar Node 2
ssh root@192.168.10.12

# Join cluster
pvecm add 192.168.10.11

# Vraagt om:
# - Root password van Node 1: [vul in]
# - Fingerprint verificatie: yes

# Wacht ~20 seconden
sleep 20

# Verificatie
pvecm status

# Verwacht: "Quorate: Yes" en "Nodes: 2"
Herhaal voor Node 3, 4, 5:

Bash

# Node 3:
ssh root@192.168.10.13
pvecm add 192.168.10.11

# Node 4:
ssh root@192.168.10.14
pvecm add 192.168.10.11

# Node 5:
ssh root@192.168.10.15
pvecm add 192.168.10.11
Stap 3.3: Cluster Verificatie
Bash

# Op Node 1:
pvecm status

# Moet tonen:
# Nodes: 5
# Quorate: Yes

# Check alle nodes:
pvecm nodes

# Verwacht:
# Membership information
# ----------------------
#     Nodeid      Votes Name
#          1          1 pve-node1 (local)
#          2          1 pve-node2
#          3          1 pve-node3
#          4          1 pve-node4
#          5          1 pve-node5
ğŸ‰ SUCCESS! Je hebt nu een 5-node cluster!
Open Proxmox Web UI en check Datacenter â†’ alle 5 nodes zichtbaar!

ğŸ—„ï¸ FASE 4: CEPH STORAGE (60 minuten)
âš ï¸ DIT IS DE MEEST TIJDROVENDE STAP

Stap 4.1: Ceph Installatie (ALLE NODES)
Bash

# Maak script op Node 1:
cat > /root/install-ceph.sh << 'EOF'
#!/bin/bash
pveceph install --version quincy
EOF

chmod +x /root/install-ceph.sh

# Kopieer naar alle nodes
for i in {12..15}; do
  scp /root/install-ceph.sh root@192.168.10.$i:/root/
done

# Voer uit op ALLE nodes (parallel)
for i in {11..15}; do
  echo "Installing Ceph on Node $(($i - 10))..."
  ssh root@192.168.10.$i "/root/install-ceph.sh" &
done

# Wacht tot alles klaar is (~10-15 minuten)
wait

echo "âœ… Ceph installed on all nodes"
Stap 4.2: Ceph Initialize (Node 1 ALLEEN)
Bash

# Op Node 1:
pveceph init --network 192.168.30.0/24 --cluster-network 192.168.30.0/24

# Verwacht:
# Created initial ceph.conf
Stap 4.3: Monitors Aanmaken (ALLE NODES)
Bash

# Node 1:
ssh root@192.168.10.11
pveceph mon create

# Node 2:
ssh root@192.168.10.12
pveceph mon create

# Node 3:
ssh root@192.168.10.13
pveceph mon create

# Node 4:
ssh root@192.168.10.14
pveceph mon create

# Node 5:
ssh root@192.168.10.15
pveceph mon create

# Of automatisch:
for i in {11..15}; do
  echo "Creating monitor on 192.168.10.$i..."
  ssh root@192.168.10.$i "pveceph mon create"
done
Stap 4.4: Managers Aanmaken (3 nodes)
Bash

# Node 1:
ssh root@192.168.10.11
pveceph mgr create

# Node 2:
ssh root@192.168.10.12
pveceph mgr create

# Node 3:
ssh root@192.168.10.13
pveceph mgr create
Stap 4.5: OSDs Aanmaken (KRITIEKE STAP!)
âš ï¸ DIT WIST ALLE DATA OP DE DISK!

Bash

# Eerst: Check beschikbare disks
# Op Node 1:
lsblk

# Output ongeveer:
# NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
# nvme0n1     259:0    0 931.5G  0 disk 
# â”œâ”€nvme0n1p1 259:1    0  1007K  0 part 
# â”œâ”€nvme0n1p2 259:2    0     1G  0 part /boot/efi
# â””â”€nvme0n1p3 259:3    0 930.5G  0 part 
#   â”œâ”€pve-root ...                      /
#   â”œâ”€pve-swap ...                      [SWAP]
#   â””â”€pve-data ...                      

# We gebruiken de vrije ruimte in pve-data LVM
# OF we maken een aparte partitie

# OPTIE A: Gebruik LVM thin pool (veilig, maar minder performance)
# Skip naar Stap 4.6

# OPTIE B: Dedicated disk/partitie (betere performance)
# Alleen doen als je een tweede NVMe hebt of partitie kan maken!

# Voor nu: OPTIE A (meeste mensen)
Stap 4.6: Create OSD met LVM
Bash

# Op elke node:

# Node 1:
ssh root@192.168.10.11
pveceph osd create /dev/pve/data --db_dev /dev/pve/data

# Herhaal voor alle nodes...

# OF automatisch (LET OP: controleer of /dev/pve/data bestaat):
for i in {11..15}; do
  echo "Creating OSD on 192.168.10.$i..."
  ssh root@192.168.10.$i "pveceph osd create /dev/pve/data"
  sleep 10
done
â³ Dit duurt ~5-10 minuten per node

Stap 4.7: Check Ceph Status
Bash

# Op Node 1:
ceph -s

# Verwacht (na alle OSDs):
#   cluster:
#     id:     xxx-xxx-xxx
#     health: HEALTH_OK    ğŸ‘ˆ BELANGRIJK!
#  
#   services:
#     mon: 5 daemons
#     mgr: pve-node1(active), standbys: pve-node2, pve-node3
#     osd: 5 osds: 5 up, 5 in
#  
#   data:
#     pools:   1 pools, 1 pgs
#     objects: 0 objects, 0 B
#     usage:   5 GiB used, 4.5 TiB / 4.5 TiB avail
#     pgs:     1 active+clean
Stap 4.8: Create Storage Pools
Bash

# Op Node 1:

# Pool voor VM disks
pveceph pool create ceph-vms --add_storages --size 2 --min_size 1 --pg_num 128

# Pool voor backups
pveceph pool create ceph-backups --add_storages --size 2 --min_size 1 --pg_num 64

# Verificatie:
pvesm status

# Verwacht:
# Name             Type     Status           Total            Used       Available
# ceph-vms         rbd      active      4657741824               0      4657741824
# ceph-backups     rbd      active      4657741824               0      4657741824
# local            dir      active      943718400          ...    
# local-lvm        lvmthin  active      ...
ğŸ‰ CEPH IS KLAAR!
ğŸ® FASE 5: VM TEMPLATE & DEPLOYMENT (30 minuten)
Stap 5.1: Download Ubuntu Cloud Image
Bash

# Op Node 1:
cd /var/lib/vz/template/iso

wget https://cloud-images.ubuntu.com/releases/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img

# Verify download:
ls -lh ubuntu-22.04-server-cloudimg-amd64.img
Stap 5.2: Create VM Template
Bash

# VM ID voor template
TEMPLATE_ID=9000

# Create VM
qm create $TEMPLATE_ID \
  --name ubuntu-22.04-template \
  --memory 2048 \
  --cores 2 \
  --net0 virtio,bridge=vmbr0

# Import cloud image
qm importdisk $TEMPLATE_ID ubuntu-22.04-server-cloudimg-amd64.img ceph-vms

# Attach disk
qm set $TEMPLATE_ID --scsihw virtio-scsi-pci --scsi0 ceph-vms:vm-$TEMPLATE_ID-disk-0

# Add cloud-init drive
qm set $TEMPLATE_ID --ide2 ceph-vms:cloudinit

# Boot settings
qm set $TEMPLATE_ID --boot c --bootdisk scsi0

# Serial console
qm set $TEMPLATE_ID --serial0 socket --vga serial0

# Agent
qm set $TEMPLATE_ID --agent enabled=1

# Convert to template
qm template $TEMPLATE_ID

echo "âœ… Template created with ID $TEMPLATE_ID"
Stap 5.3: Deploy Test VM
Bash

# Clone template
qm clone $TEMPLATE_ID 100 \
  --name test-vm \
  --full \
  --storage ceph-vms

# Configure
qm set 100 --cores 2 --memory 4096

# Resize disk (20GB)
qm resize 100 scsi0 20G

# Network
qm set 100 --ipconfig0 ip=192.168.10.100/24,gw=192.168.10.1

# Cloud-init user
qm set 100 --ciuser ubuntu --cipassword 'YourPassword123!'

# SSH key (optioneel)
# qm set 100 --sshkeys ~/.ssh/id_rsa.pub

# Start VM
qm start 100

# Wacht 30 seconden
sleep 30

# Test SSH
ssh ubuntu@192.168.10.100

# âœ… Als je inlogt â†’ SUCCESS!
ğŸ¯ FASE 6: GAMESERVER SOFTWARE (45 minuten)
Stap 6.1: Clone Setup Scripts naar VMs
Bash

# Download gameserver setup (op Node 1):
cd /root
git clone https://github.com/jouw-repo/gameserver-setup.git

# OF handmatig download onze eerdere scripts

# Kopieer naar test VM:
scp -r gameserver-setup ubuntu@192.168.10.100:~/

# SSH naar VM:
ssh ubuntu@192.168.10.100

# Op de VM:
cd gameserver-setup
cp config.env.example config.env
nano config.env  # Pas aan

# Voer installatie uit:
sudo ./install.sh
Stap 6.2: Deploy Game Nodes
Bash

# Terug op Proxmox Node 1:

# Minecraft Node (4GB RAM)
qm clone 9000 401 --name minecraft-1 --full --storage ceph-vms
qm set 401 --cores 2 --memory 4096
qm resize 401 scsi0 30G
qm set 401 --ipconfig0 ip=192.168.20.41/24,gw=192.168.20.1
qm start 401

# FiveM Node (6GB RAM)
qm clone 9000 301 --name fivem-1 --full --storage ceph-vms
qm set 301 --cores 3 --memory 6144
qm resize 301 scsi0 50G
qm set 301 --ipconfig0 ip=192.168.20.31/24,gw=192.168.20.1
qm start 301

# ARK Node (24GB RAM) - op Node 2 voor spreading
qm clone 9000 201 --name ark-island --full --storage ceph-vms --target pve-node2
qm set 201 --cores 8 --memory 24576
qm resize 201 scsi0 100G
qm set 201 --ipconfig0 ip=192.168.20.21/24,gw=192.168.20.1
qm start 201

# etc...
ğŸ“Š FINALE: MONITORING & VERIFICATIE
Cluster Health Dashboard
Bash

# Op Node 1, maak monitoring script:
cat > /root/cluster-status.sh << 'EOF'
#!/bin/bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘          GAMESERVER CLUSTER STATUS                        â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸŒ CLUSTER:"
pvecm status | grep -E "Nodes:|Quorate:"
echo ""
echo "ğŸ—„ï¸  CEPH:"
ceph health
ceph df | head -5
echo ""
echo "ğŸ® VMs:"
qm list | head -10
echo ""
echo "ğŸ“Š RESOURCES:"
pvesh get /cluster/resources --type node | grep -E 'node|cpu|mem'
EOF

chmod +x /root/cluster-status.sh

# Run it:
/root/cluster-status.sh
âœ… FINAL CHECKLIST
Bash

â˜ Alle 5 nodes online in Proxmox cluster
â˜ Ceph status: HEALTH_OK
â˜ Template aangemaakt (ID 9000)
â˜ Minimaal 1 test VM draait
â˜ SSH werkt naar VMs
â˜ Gameserver software geÃ¯nstalleerd op minimaal 1 VM
â˜ Web UI toegankelijk: https://192.168.10.11:8006
â˜ Monitoring setup (optioneel maar aanbevolen)
ğŸ†˜ TROUBLESHOOTING
"No quorum after adding nodes"
Bash

# Check corosync
systemctl status corosync

# Check network
pvecm status
ping [other-node-ip]

# Reset cluster (LAATSTE REDMIDDEL):
# Op ALLE nodes:
systemctl stop pve-cluster corosync
pmxcfs -l  # Local mode
rm /etc/corosync/*
rm /etc/pve/corosync.conf
rm /var/lib/corosync/*
killall pmxcfs
systemctl start pve-cluster
# Dan opnieuw cluster aanmaken
"Ceph stuck creating OSDs"
Bash

# Check logs
journalctl -u ceph-osd@*.service -f

# List OSDs
ceph osd tree

# Remove stuck OSD:
ceph osd down <osd-id>
ceph osd out <osd-id>
ceph osd rm <osd-id>
ceph auth del osd.<osd-id>
"Can't SSH to VMs"
Bash

# Check VM console first (in Web UI)
# Often cloud-init issue

# Check cloud-init status on VM:
cloud-init status

# Re-run cloud-init:
sudo cloud-init clean
sudo cloud-init init
ğŸŠ GEFELICITEERD!
Je hebt nu:

âœ… 5-node Proxmox cluster
âœ… Ceph distributed storage
âœ… VM deployment systeem
âœ… Basis voor gameserver platform
Volgende stappen:
Deploy meer game VMs
Setup Pterodactyl Panel
Configureer monitoring (Grafana)
Setup automated backups
Test HA failover
Ga live! ğŸš€
Vragen? Issues? Wil je verder?

Laat me weten waar je bent en ik help je verder! ğŸ’ª





direct aan de slag met de installatie? ğŸš€

claude-sonnet-4-5-20250929-thinking-32k

Thought for 2 seconds

ğŸŒ PROXMOX CLUSTER - 5Ã— MS-01 NODES
ğŸ¯ CLUSTER OVERZICHT
text

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    GAMESERVER PROXMOX CLUSTER                             â•‘
â•‘                         5Ã— MS-01 Nodes                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          MANAGEMENT NETWORK                              â”‚
â”‚                         10G SFP+ BACKBONE                                â”‚
â”‚                    192.168.10.0/24 (VLAN 10)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚           â”‚           â”‚           â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ MS-01  â”‚     â”‚ MS-01  â”‚  â”‚ MS-01  â”‚  â”‚ MS-01  â”‚  â”‚ MS-01  â”‚
    â”‚ NODE 1 â”‚     â”‚ NODE 2 â”‚  â”‚ NODE 3 â”‚  â”‚ NODE 4 â”‚  â”‚ NODE 5 â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚Panel+  â”‚     â”‚ ARK    â”‚  â”‚ FiveM  â”‚  â”‚Minecraftâ”‚ â”‚ Mixed  â”‚
    â”‚Monitor â”‚     â”‚ Rust   â”‚  â”‚ Heavy  â”‚  â”‚  CS2    â”‚ â”‚ Light  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    .10.11         .10.12      .10.13      .10.14      .10.15

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          GAME SERVER NETWORK                             â”‚
â”‚                         2.5GbE PUBLIC                                    â”‚
â”‚                    192.168.20.0/24 (VLAN 20)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CEPH STORAGE NETWORK                            â”‚
â”‚                         10G SFP+ DEDICATED                               â”‚
â”‚                    192.168.30.0/24 (VLAN 30)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FEATURES:
  âœ… High Availability (HA)
  âœ… Live Migration
  âœ… Shared Storage (Ceph)
  âœ… Centralized Management
  âœ… Automatic Failover
  âœ… Load Balancing
ğŸ“‹ HARDWARE INVENTARIS
Per MS-01 Node:
YAML

Specifications:
  CPU: Intel i9-12900H (14C/20T, 5.0GHz)
  RAM: 32GB DDR5-4800 SO-DIMM
  Storage: 1TB NVMe M.2 2280
  Network:
    - 2Ã— 10G SFP+ (voor cluster + Ceph)
    - 2Ã— 2.5GbE RJ45 (voor management + public)
  Size: 20Ã—20Ã—6cm
  Power: 65W typical, 120W max

Total Cluster Resources:
  CPU: 70 cores / 100 threads
  RAM: 160GB (140GB usable voor VMs)
  Storage: 5TB raw (3TB usable met Ceph replication)
  Network: 50Gbit+ aggregate
ğŸ”§ NETWERK TOPOLOGIE
Switch Requirements:
text

RECOMMENDED SETUP:

Switch 1: 10G Core Switch (bijv. MikroTik CRS312-4C+8XG-RM)
  â”œâ”€ 4Ã— 10G SFP+ ports (uplinks)
  â”œâ”€ 8Ã— 10G SFP+ ports (nodes)
  â””â”€ VLAN support

Switch 2: 2.5G Access Switch (optioneel, voor game traffic isolation)
  â”œâ”€ 8Ã— 2.5GbE RJ45
  â””â”€ VLAN support

Budget Alternative:
  â€¢ MikroTik CRS309-1G-8S+IN (~â‚¬350)
  â€¢ Ubiquiti UniFi Switch 16 XG (~â‚¬500)
Cabling:
Bash

Per Node:
  â€¢ SFP+ Port 1 â†’ 10G Switch (Management + Corosync) [VLAN 10]
  â€¢ SFP+ Port 2 â†’ 10G Switch (Ceph Storage) [VLAN 30]
  â€¢ 2.5GbE Port 1 â†’ Game Traffic [VLAN 20]
  â€¢ 2.5GbE Port 2 â†’ Reserved/Backup

Total Cables Needed:
  â€¢ 10Ã— 10G SFP+ DAC cables (0.5-1m)
  â€¢ 5Ã— 2.5GbE Ethernet cables
âš™ï¸ CLUSTER CONFIGURATIE
config-cluster.env
Bash

###############################################################################
# Proxmox Cluster Configuration - 5Ã— MS-01 Nodes
###############################################################################

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CLUSTER ALGEMEEN
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CLUSTER_NAME="gameserver-cluster"
CLUSTER_DOMAIN="internal.gameserver.local"

# Timezone
TIMEZONE="Europe/Amsterdam"

# Admin email
ADMIN_EMAIL="admin@example.com"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 1 - Panel + Monitoring (Master)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE1_HOSTNAME="pve-node1"
NODE1_IP_MGMT="192.168.10.11"      # Management/Corosync
NODE1_IP_CEPH="192.168.30.11"      # Ceph storage network
NODE1_IP_GAME="192.168.20.11"      # Game server network
NODE1_ROLE="panel,monitoring"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 2 - ARK + Rust (Heavy Games)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE2_HOSTNAME="pve-node2"
NODE2_IP_MGMT="192.168.10.12"
NODE2_IP_CEPH="192.168.30.12"
NODE2_IP_GAME="192.168.20.12"
NODE2_ROLE="heavy-games"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 3 - FiveM (High Performance)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE3_HOSTNAME="pve-node3"
NODE3_IP_MGMT="192.168.10.13"
NODE3_IP_CEPH="192.168.30.13"
NODE3_IP_GAME="192.168.20.13"
NODE3_ROLE="fivem"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 4 - Minecraft + CS2
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE4_HOSTNAME="pve-node4"
NODE4_IP_MGMT="192.168.10.14"
NODE4_IP_CEPH="192.168.30.14"
NODE4_IP_GAME="192.168.20.14"
NODE4_ROLE="minecraft,cs2"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NODE 5 - Palworld + Light Games
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE5_HOSTNAME="pve-node5"
NODE5_IP_MGMT="192.168.10.15"
NODE5_IP_CEPH="192.168.30.15"
NODE5_IP_GAME="192.168.20.15"
NODE5_ROLE="light-games"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NETWERK CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Management Network (VLAN 10)
MGMT_NETWORK="192.168.10.0/24"
MGMT_GATEWAY="192.168.10.1"
MGMT_VLAN="10"

# Game Server Network (VLAN 20)
GAME_NETWORK="192.168.20.0/24"
GAME_GATEWAY="192.168.20.1"
GAME_VLAN="20"

# Ceph Storage Network (VLAN 30)
CEPH_NETWORK="192.168.30.0/24"
CEPH_VLAN="30"

# DNS Servers
DNS1="1.1.1.1"
DNS2="8.8.8.8"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CEPH STORAGE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ceph cluster configuratie
CEPH_CLUSTER_NETWORK="192.168.30.0/24"
CEPH_PUBLIC_NETWORK="192.168.10.0/24"

# OSD configuration (per node 1Ã— 1TB NVMe)
# We allocate ~80% voor Ceph, 20% voor OS
CEPH_OSD_SIZE="800"  # GB per node

# Replication
CEPH_POOL_SIZE="2"           # 2 replicas (N+1 redundancy)
CEPH_POOL_MIN_SIZE="1"       # Minimum replicas before read-only

# Pools
CEPH_POOL_VMS="ceph-vms"     # Voor VM disks
CEPH_POOL_BACKUPS="ceph-backups"  # Voor backups

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# HIGH AVAILABILITY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# HA groups
HA_GROUP_CRITICAL="panel,monitoring"  # Max priority, auto-migrate
HA_GROUP_PRODUCTION="fivem,ark"       # High priority
HA_GROUP_STANDARD="minecraft,cs2"     # Normal priority

# Fence device (voor split-brain prevention)
FENCE_ENABLED="false"  # True als je dedicated IPMI/PDU hebt

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VM ALLOCATIE STRATEGIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Maximum VMs per node (voor load balancing)
MAX_VMS_PER_NODE="15"

# CPU overcommit ratio
CPU_OVERCOMMIT="1.5"  # 1.5:1 ratio (70 cores = 105 vCPUs)

# RAM overcommit
RAM_OVERCOMMIT="1.0"  # No overcommit (gameservers need guaranteed RAM)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# BACKUP CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BACKUP_ENABLED="true"
BACKUP_SCHEDULE="daily"
BACKUP_TIME="03:00"
BACKUP_RETENTION="7"  # dagen
BACKUP_COMPRESSION="zstd"
BACKUP_MODE="snapshot"  # snapshot of suspend

# Backup storage
BACKUP_STORAGE="ceph-backups"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# MONITORING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Prometheus
PROMETHEUS_RETENTION="30d"

# Grafana
GRAFANA_ADMIN_PASSWORD="change_me_secure_password"

# Alerting
ALERT_EMAIL="alerts@example.com"
ALERT_DISCORD_WEBHOOK=""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECURITY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# SSH
SSH_PORT="22"
SSH_ALLOW_ROOT="prohibit-password"

# Firewall
FIREWALL_ENABLED="true"

# Two-Factor Authentication
TFA_ENABLED="false"  # Enable voor productie!

# API Access
API_TOKEN_ENABLED="true"
ğŸš€ INSTALLATIE SCRIPTS
install-cluster.sh (Master Script)
Bash

#!/bin/bash
###############################################################################
# Proxmox Cluster Setup - Master Installer
# Voor 5Ã— MS-01 Nodes
###############################################################################

set -e

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
NC='\033[0m'

clear
cat << "EOF"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘              ğŸŒ  PROXMOX CLUSTER SETUP                                   â•‘
â•‘              Professional Gameserver Infrastructure                      â•‘
â•‘                                                                           â•‘
â•‘              Hardware: 5Ã— MS-01 (i9-12900H, 32GB RAM)                    â•‘
â•‘              Total: 70 cores, 160GB RAM, 5TB NVMe                        â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF

echo ""
echo -e "${BLUE}Cluster Setup Wizard${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""

# Controleer of dit Node 1 is (master)
read -p "Is dit Node 1 (Master node)? [Y/n]: " IS_MASTER
IS_MASTER=${IS_MASTER:-Y}

if [[ ! $IS_MASTER =~ ^[Yy]$ ]]; then
    echo ""
    echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${YELLOW}  WORKER NODE INSTALLATIE${NC}"
    echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo ""
    echo "Op worker nodes (2-5):"
    echo "  1. Voer eerst 'setup-node.sh' uit"
    echo "  2. Daarna join je de cluster via Node 1 web UI"
    echo ""
    echo "Dit script is alleen voor Node 1 (cluster master)"
    exit 0
fi

# Load config
if [ ! -f "config-cluster.env" ]; then
    echo -e "${RED}âŒ config-cluster.env niet gevonden!${NC}"
    exit 1
fi

source config-cluster.env

# Pre-flight checks
echo -e "${BLUE}ğŸ” Pre-flight checks...${NC}"
echo ""

# Check Proxmox
if [ ! -f "/etc/pve/local/pve-ssl.pem" ]; then
    echo -e "${RED}âŒ Proxmox VE niet gedetecteerd!${NC}"
    echo "Installeer eerst Proxmox VE op alle nodes"
    exit 1
fi

echo -e "${GREEN}âœ… Proxmox VE detected: $(pveversion | grep pve-manager)${NC}"

# Check network
echo ""
echo -e "${BLUE}ğŸ“¡ Netwerk configuratie controleren...${NC}"

CURRENT_IP=$(hostname -I | awk '{print $1}')
echo "   Huidig IP: $CURRENT_IP"

if [ "$CURRENT_IP" != "$NODE1_IP_MGMT" ]; then
    echo -e "${YELLOW}âš ï¸  IP adres komt niet overeen met NODE1_IP_MGMT ($NODE1_IP_MGMT)${NC}"
    read -p "   Doorgaan? [y/N]: " CONTINUE
    [[ ! $CONTINUE =~ ^[Yy]$ ]] && exit 1
fi

# Check connectivity to other nodes
echo ""
echo -e "${BLUE}ğŸ”Œ Connectiviteit naar andere nodes testen...${NC}"

NODES=("$NODE2_IP_MGMT" "$NODE3_IP_MGMT" "$NODE4_IP_MGMT" "$NODE5_IP_MGMT")
NODE_NAMES=("Node 2" "Node 3" "Node 4" "Node 5")

for i in "${!NODES[@]}"; do
    IP="${NODES[$i]}"
    NAME="${NODE_NAMES[$i]}"
    
    if ping -c 1 -W 2 "$IP" &> /dev/null; then
        echo -e "${GREEN}   âœ… ${NAME} (${IP}) - ONLINE${NC}"
    else
        echo -e "${RED}   âŒ ${NAME} (${IP}) - OFFLINE${NC}"
        echo -e "${YELLOW}      Zorg dat alle nodes online zijn voor cluster setup${NC}"
    fi
done

echo ""
read -p "Alle nodes online en klaar? [Y/n]: " ALL_READY
ALL_READY=${ALL_READY:-Y}
[[ ! $ALL_READY =~ ^[Yy]$ ]] && exit 1

# Installatie menu
echo ""
echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${GREEN}  CLUSTER SETUP MENU${NC}"
echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""
echo "  [1] ğŸ”§ Complete cluster setup (aanbevolen)"
echo "  [2] ğŸŒ Alleen netwerk configureren"
echo "  [3] ğŸ—„ï¸  Alleen Ceph storage setup"
echo "  [4] ğŸ‘¥ Nodes toevoegen aan cluster"
echo "  [5] ğŸ® VM deployment (na cluster setup)"
echo "  [6] ğŸ“Š Monitoring setup"
echo "  [7] ğŸ” Cluster status"
echo "  [8] âŒ Exit"
echo ""
read -p "Keuze [1-8]: " CHOICE

case $CHOICE in
    1)
        echo -e "${GREEN}ğŸš€ Volledige cluster setup gestart...${NC}"
        echo ""
        
        # Stap 1: Netwerk
        echo -e "${BLUE}â•â•â• STAP 1/5: NETWERK CONFIGURATIE â•â•â•${NC}"
        bash cluster/01-network-setup.sh
        
        # Stap 2: Cluster aanmaken
        echo ""
        echo -e "${BLUE}â•â•â• STAP 2/5: CLUSTER AANMAKEN â•â•â•${NC}"
        bash cluster/02-create-cluster.sh
        
        # Stap 3: Ceph storage
        echo ""
        echo -e "${BLUE}â•â•â• STAP 3/5: CEPH STORAGE â•â•â•${NC}"
        bash cluster/03-ceph-setup.sh
        
        # Stap 4: High Availability
        echo ""
        echo -e "${BLUE}â•â•â• STAP 4/5: HIGH AVAILABILITY â•â•â•${NC}"
        bash cluster/04-ha-setup.sh
        
        # Stap 5: Monitoring
        echo ""
        echo -e "${BLUE}â•â•â• STAP 5/5: MONITORING â•â•â•${NC}"
        bash cluster/05-monitoring-setup.sh
        
        echo ""
        echo -e "${GREEN}âœ… CLUSTER SETUP COMPLEET!${NC}"
        ;;
    2)
        bash cluster/01-network-setup.sh
        ;;
    3)
        bash cluster/03-ceph-setup.sh
        ;;
    4)
        bash cluster/06-add-nodes.sh
        ;;
    5)
        bash cluster/07-deploy-vms.sh
        ;;
    6)
        bash cluster/05-monitoring-setup.sh
        ;;
    7)
        bash cluster/99-cluster-status.sh
        ;;
    8)
        echo "Bye!"
        exit 0
        ;;
    *)
        echo -e "${RED}Ongeldige keuze${NC}"
        exit 1
        ;;
esac

# Final status
echo ""
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${GREEN}â•‘                    SETUP COMPLEET                         â•‘${NC}"
echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo -e "${BLUE}ğŸ“Š Cluster Informatie:${NC}"
echo "   â€¢ Cluster: $CLUSTER_NAME"
echo "   â€¢ Nodes: 5"
echo "   â€¢ Web UI: https://$NODE1_IP_MGMT:8006"
echo ""
echo -e "${BLUE}ğŸ¯ Volgende stappen:${NC}"
echo "   1. Login op web UI"
echo "   2. Verifieer alle nodes in cluster"
echo "   3. Check Ceph status"
echo "   4. Deploy VMs via menu optie 5"
echo ""
cluster/01-network-setup.sh
Bash

#!/bin/bash
###############################################################################
# Network Setup - Node 1 (Master)
###############################################################################

source config-cluster.env

echo "ğŸŒ Netwerk configuratie voor Node 1..."

# Backup huidige config
cp /etc/network/interfaces /etc/network/interfaces.backup-$(date +%Y%m%d)

# Network interfaces configuratie
cat > /etc/network/interfaces << EOFNET
# Loopback
auto lo
iface lo inet loopback

# Management Network (10G SFP+ Port 1) - VLAN 10
auto ens1
iface ens1 inet manual

auto vmbr0
iface vmbr0 inet static
    address ${NODE1_IP_MGMT}/24
    gateway ${MGMT_GATEWAY}
    bridge-ports ens1.${MGMT_VLAN}
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    bridge-vids 10 20 30
    dns-nameservers ${DNS1} ${DNS2}
    # Corosync ring 0

# Ceph Storage Network (10G SFP+ Port 2) - VLAN 30
auto ens2
iface ens2 inet manual

auto vmbr1
iface vmbr1 inet static
    address ${NODE1_IP_CEPH}/24
    bridge-ports ens2.${CEPH_VLAN}
    bridge-stp off
    bridge-fd 0
    mtu 9000
    # Jumbo frames voor Ceph

# Game Server Network (2.5GbE Port 1) - VLAN 20
auto ens3
iface ens3 inet manual

auto vmbr2
iface vmbr2 inet static
    address ${NODE1_IP_GAME}/24
    bridge-ports ens3.${GAME_VLAN}
    bridge-stp off
    bridge-fd 0
    # Public facing VMs
EOFNET

echo "âœ… Netwerk configuratie geschreven"
echo ""
echo -e "${YELLOW}âš ï¸  Netwerk configuratie vereist reboot!${NC}"
echo ""
echo "Huidige configuratie gebackupt naar: /etc/network/interfaces.backup-$(date +%Y%m%d)"
echo ""
read -p "Nu rebooten om netwerk toe te passen? [y/N]: " REBOOT_NOW

if [[ $REBOOT_NOW =~ ^[Yy]$ ]]; then
    echo "Rebooting in 5 seconden..."
    sleep 5
    reboot
else
    echo ""
    echo -e "${YELLOW}âš ï¸  Reboot later handmatig om netwerk toe te passen${NC}"
    echo "   Command: reboot"
fi
cluster/02-create-cluster.sh
Bash

#!/bin/bash
###############################################################################
# Create Proxmox Cluster
###############################################################################

source config-cluster.env

echo "ğŸ‘¥ Proxmox cluster aanmaken..."

# Check if cluster already exists
if pvesh get /cluster/status --noborder 2>/dev/null | grep -q "cluster"; then
    echo -e "${YELLOW}âš ï¸  Cluster bestaat al!${NC}"
    pvecm status
    exit 0
fi

# Create cluster
echo "Creating cluster: $CLUSTER_NAME"
pvecm create $CLUSTER_NAME --link0 ${NODE1_IP_MGMT}

# Wait for cluster to initialize
sleep 5

# Verify
echo ""
echo "âœ… Cluster aangemaakt!"
echo ""
pvecm status

echo ""
echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${GREEN}  NODES TOEVOEGEN${NC}"
echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""
echo "Op ELKE andere node (2-5), voer uit:"
echo ""
echo -e "${YELLOW}pvecm add ${NODE1_IP_MGMT}${NC}"
echo ""
echo "Wacht tot alle nodes toegevoegd zijn..."
read -p "Druk op Enter als alle nodes zijn toegevoegd..."

# Verify all nodes
echo ""
echo "Cluster nodes:"
pvecm nodes

# Configure corosync (redundant ring voor HA)
echo ""
echo "âš™ï¸  Corosync optimalisatie..."

cat >> /etc/pve/corosync.conf << EOFCORO

# Optimalisaties voor gameserver cluster
totem {
    token: 3000
    token_retransmits_before_loss_const: 10
    join: 60
    consensus: 3600
    max_messages: 20
}
EOFCORO

# Reload corosync
systemctl restart pve-cluster
systemctl restart corosync

echo "âœ… Cluster configuratie compleet!"
cluster/03-ceph-setup.sh
Bash

#!/bin/bash
###############################################################################
# Ceph Storage Setup
###############################################################################

source config-cluster.env

echo "ğŸ—„ï¸  Ceph distributed storage setup..."

# Install Ceph
echo "ğŸ“¦ Ceph packages installeren..."
pveceph install --version quincy

# Create Ceph config
echo "âš™ï¸  Ceph initialiseren..."
pveceph init --network ${CEPH_NETWORK} --cluster-network ${CEPH_NETWORK}

# Create monitors (1 per node)
echo "ğŸ“¡ Ceph monitors aanmaken..."

# Node 1 (local)
pveceph mon create

echo ""
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${YELLOW}  ACTION REQUIRED: MONITORS OP ANDERE NODES${NC}"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""
echo "Op elke andere node (via web UI of SSH):"
echo ""
echo "  pveceph mon create"
echo ""
read -p "Druk op Enter als monitors op alle nodes actief zijn..."

# Create manager
echo ""
echo "ğŸ“Š Ceph manager aanmaken..."
pveceph mgr create

# Create OSDs (gebruik NVMe drives)
echo ""
echo "ğŸ’¾ Ceph OSDs aanmaken..."
echo ""
echo -e "${YELLOW}âš ï¸  LET OP: Dit verwijdert ALLE data op de geselecteerde disks!${NC}"
echo ""

# List available disks
lsblk -d -o NAME,SIZE,TYPE | grep disk

echo ""
echo "Beschikbare disks op Node 1:"
pveceph disk list

echo ""
read -p "Disk voor OSD (bijv. nvme0n1): " OSD_DISK

if [ -z "$OSD_DISK" ]; then
    echo -e "${RED}Geen disk opgegeven, OSD setup overgeslagen${NC}"
else
    # Create OSD with DB/WAL on same disk
    pveceph osd create /dev/${OSD_DISK}
    echo "âœ… OSD aangemaakt op Node 1"
fi

echo ""
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${YELLOW}  ACTION REQUIRED: OSDs OP ANDERE NODES${NC}"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""
echo "Op elke andere node (via web UI of SSH):"
echo ""
echo "  pveceph osd create /dev/nvme0n1"
echo ""
echo "Wacht tot alle OSDs 'up' en 'in' zijn in 'ceph -s'"
echo ""
read -p "Druk op Enter als alle OSDs actief zijn..."

# Create storage pools
echo ""
echo "ğŸŠ Ceph pools aanmaken..."

# Pool voor VM disks
pveceph pool create ${CEPH_POOL_VMS} \
    --add_storages \
    --size ${CEPH_POOL_SIZE} \
    --min_size ${CEPH_POOL_MIN_SIZE} \
    --pg_num 128 \
    --application rbd

# Pool voor backups
pveceph pool create ${CEPH_POOL_BACKUPS} \
    --add_storages \
    --size ${CEPH_POOL_SIZE} \
    --min_size ${CEPH_POOL_MIN_SIZE} \
    --pg_num 64 \
    --application rbd

# Create RBD storages in Proxmox
pvesm add rbd ${CEPH_POOL_VMS} \
    --pool ${CEPH_POOL_VMS} \
    --content images,rootdir \
    --krbd 0 \
    --nodes $(pvesh get /cluster/resources --type node --output-format json | jq -r '.[].node' | tr '\n' ',' | sed 's/,$//')

pvesm add rbd ${CEPH_POOL_BACKUPS} \
    --pool ${CEPH_POOL_BACKUPS} \
    --content backup \
    --krbd 0

echo ""
echo "âœ… Ceph pools aangemaakt!"
echo ""

# Show Ceph status
echo "ğŸ“Š Ceph status:"
ceph -s

echo ""
echo "ğŸ’¾ Storage pools:"
pvesm status

echo ""
echo -e "${GREEN}âœ… Ceph setup compleet!${NC}"
echo ""
echo "Ceph dashboard: https://$NODE1_IP_MGMT:8443"
echo "   (Credentials zijn in /etc/pve/priv/ceph.*)"
cluster/04-ha-setup.sh
Bash

#!/bin/bash
###############################################################################
# High Availability Setup
###############################################################################

source config-cluster.env

echo "ğŸ”„ High Availability configureren..."

# HA requires at least 3 nodes for quorum
NODE_COUNT=$(pvesh get /cluster/resources --type node --noborder | wc -l)

if [ $NODE_COUNT -lt 3 ]; then
    echo -e "${YELLOW}âš ï¸  HA vereist minimaal 3 nodes voor quorum${NC}"
    echo "   Huidige nodes: $NODE_COUNT"
    echo "   Voeg meer nodes toe aan de cluster"
    exit 1
fi

# Create HA groups
echo "ğŸ‘¥ HA groups aanmaken..."

# Critical services (Panel, Monitoring)
ha-manager groupadd critical \
    --nodes "$(echo $NODE1_HOSTNAME):2,$(echo $NODE2_HOSTNAME):1,$(echo $NODE3_HOSTNAME):1" \
    --comment "Critical services - Panel & Monitoring"

# Production games (FiveM, ARK)
ha-manager groupadd production \
    --nodes "$(echo $NODE2_HOSTNAME):2,$(echo $NODE3_HOSTNAME):2,$(echo $NODE4_HOSTNAME):1" \
    --comment "Production game servers"

# Standard games
ha-manager groupadd standard \
    --nodes "$(echo $NODE4_HOSTNAME):2,$(echo $NODE5_HOSTNAME):2,$(echo $NODE3_HOSTNAME):1" \
    --comment "Standard game servers"

echo "âœ… HA groups aangemaakt"

# Configure fencing (optioneel, alleen met dedicated IPMI/PDU)
if [ "$FENCE_ENABLED" == "true" ]; then
    echo ""
    echo "ğŸš§ Fencing configuratie..."
    echo "   Handmatige configuratie vereist via Web UI"
    echo "   Datacenter â†’ Fencing â†’ Add"
fi

# Enable HA for existing VMs (interactief)
echo ""
echo "ğŸ® Bestaande VMs HA-enabled maken?"
read -p "VMs configureren voor HA? [y/N]: " ENABLE_HA_VMS

if [[ $ENABLE_HA_VMS =~ ^[Yy]$ ]]; then
    echo ""
    qm list
    echo ""
    read -p "VM IDs voor HA (komma gescheiden, bijv: 100,201,202): " VM_IDS
    
    IFS=',' read -ra VMS <<< "$VM_IDS"
    for VMID in "${VMS[@]}"; do
        VMID=$(echo $VMID | xargs)  # trim whitespace
        
        # Ask for HA group
        echo ""
        echo "VM $VMID - Selecteer HA group:"
        echo "  [1] critical"
        echo "  [2] production"
        echo "  [3] standard"
        read -p "Keuze [1-3]: " GROUP_CHOICE
        
        case $GROUP_CHOICE in
            1) GROUP="critical" ;;
            2) GROUP="production" ;;
            3) GROUP="standard" ;;
            *) GROUP="standard" ;;
        esac
        
        # Add to HA
        ha-manager add vm:$VMID \
            --group $GROUP \
            --state started \
            --max_restart 3 \
            --max_relocate 3
        
        echo "âœ… VM $VMID toegevoegd aan HA group: $GROUP"
    done
fi

echo ""
echo "âœ… HA configuratie compleet!"
echo ""
echo "HA Status:"
ha-manager status
cluster/05-monitoring-setup.sh
Bash

#!/bin/bash
###############################################################################
# Cluster Monitoring Setup - Prometheus + Grafana
###############################################################################

source config-cluster.env

echo "ğŸ“Š Cluster monitoring setup..."

# Create monitoring VM if not exists
MONITOR_VMID=900

if qm status $MONITOR_VMID &>/dev/null; then
    echo "Monitoring VM bestaat al (ID: $MONITOR_VMID)"
else
    echo "ğŸ“¦ Monitoring VM aanmaken..."
    
    # Clone from template (assumes template 9000 exists)
    qm clone 9000 $MONITOR_VMID \
        --name monitoring \
        --full \
        --storage ${CEPH_POOL_VMS}
    
    # Configure
    qm set $MONITOR_VMID \
        --cores 4 \
        --memory 8192 \
        --balloon 0
    
    qm resize $MONITOR_VMID scsi0 100G
    
    # Network
    qm set $MONITOR_VMID \
        --ipconfig0 ip=${MON_IP}/24,gw=${MGMT_GATEWAY}
    
    # HA
    ha-manager add vm:$MONITOR_VMID \
        --group critical \
        --state started
    
    # Start
    qm start $MONITOR_VMID
    
    echo "âœ… Monitoring VM gestart"
    echo "   Wacht 60 seconden voor boot..."
    sleep 60
fi

# Deploy monitoring stack via Docker Compose
echo ""
echo "ğŸ³ Monitoring stack deployen..."

# Create docker-compose on monitoring VM
ssh root@${MON_IP} 'bash -s' << 'EOFSSH'
mkdir -p /opt/monitoring
cd /opt/monitoring

cat > docker-compose.yml << 'EOFDOCKER'
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus:/etc/prometheus
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--storage.tsdb.retention.time=30d'
    ports:
      - 9090:9090
    restart: unless-stopped
    networks:
      - monitoring

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - grafana_data:/var/lib/grafana
      - ./grafana/provisioning:/etc/grafana/provisioning
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_ADMIN_PASSWORD:-admin}
      - GF_INSTALL_PLUGINS=flant-statusmap-panel,grafana-piechart-panel
    ports:
      - 3000:3000
    restart: unless-stopped
    networks:
      - monitoring
    depends_on:
      - prometheus

  node-exporter:
    image: prom/node-exporter:latest
    container_name: node-exporter
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    ports:
      - 9100:9100
    restart: unless-stopped
    networks:
      - monitoring

  alertmanager:
    image: prom/alertmanager:latest
    container_name: alertmanager
    volumes:
      - ./alertmanager:/etc/alertmanager
      - alertmanager_data:/alertmanager
    command:
      - '--config.file=/etc/alertmanager/alertmanager.yml'
    ports:
      - 9093:9093
    restart: unless-stopped
    networks:
      - monitoring

  pve-exporter:
    image: prompve/prometheus-pve-exporter:latest
    container_name: pve-exporter
    ports:
      - 9221:9221
    restart: unless-stopped
    networks:
      - monitoring

volumes:
  prometheus_data:
  grafana_data:
  alertmanager_data:

networks:
  monitoring:
    driver: bridge
EOFDOCKER

# Prometheus config
mkdir -p prometheus
cat > prometheus/prometheus.yml << 'EOFPROM'
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # Proxmox nodes
  - job_name: 'proxmox'
    static_configs:
      - targets: 
        - '192.168.10.11:9221'  # Node 1
        - '192.168.10.12:9221'  # Node 2
        - '192.168.10.13:9221'  # Node 3
        - '192.168.10.14:9221'  # Node 4
        - '192.168.10.15:9221'  # Node 5

  # Node exporters
  - job_name: 'node'
    static_configs:
      - targets:
        - '192.168.10.11:9100'
        - '192.168.10.12:9100'
        - '192.168.10.13:9100'
        - '192.168.10.14:9100'
        - '192.168.10.15:9100'

  # Ceph
  - job_name: 'ceph'
    static_configs:
      - targets: ['192.168.10.11:9283']
EOFPROM

# Start stack
docker-compose up -d

echo "âœ… Monitoring stack deployed!"
EOFSSH

echo ""
echo -e "${GREEN}âœ… Monitoring setup compleet!${NC}"
echo ""
echo "ğŸ“Š Dashboards:"
echo "   â€¢ Grafana: http://${MON_IP}:3000 (admin / ${GRAFANA_ADMIN_PASSWORD:-admin})"
echo "   â€¢ Prometheus: http://${MON_IP}:9090"
echo "   â€¢ Alertmanager: http://${MON_IP}:9093"
echo ""
echo "Importeer Proxmox dashboards in Grafana:"
echo "   Dashboard ID: 10048 (Proxmox via Prometheus)"
cluster/07-deploy-vms.sh
Bash

#!/bin/bash
###############################################################################
# Deploy Game Server VMs across cluster
###############################################################################

source config-cluster.env

echo "ğŸ® Game Server VMs deployen..."

# VM allocation strategy
cat << 'EOFSTRATEGY'
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VM DEPLOYMENT STRATEGIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE 1 (pve-node1): Panel + Monitoring
  â”œâ”€ VMID 100: Pterodactyl Panel (4C, 8GB)
  â””â”€ VMID 900: Monitoring Stack (4C, 8GB)

NODE 2 (pve-node2): Heavy Games
  â”œâ”€ VMID 201: ARK Cluster Node 1 (8C, 24GB)
  â”œâ”€ VMID 202: ARK Cluster Node 2 (8C, 24GB)
  â””â”€ VMID 210: Rust Server (6C, 16GB)

NODE 3 (pve-node3): FiveM
  â”œâ”€ VMID 301-305: FiveM Servers (3C, 6GB each)

NODE 4 (pve-node4): Minecraft + CS2
  â”œâ”€ VMID 401-410: Minecraft Servers (2C, 4GB each)
  â””â”€ VMID 420-425: CS2 Servers (2C, 3GB each)

NODE 5 (pve-node5): Light Games
  â”œâ”€ VMID 501-510: Palworld Servers (2C, 4GB each)
  â””â”€ VMID 520-530: Mixed light servers

TOTAL: ~40-50 VMs across 5 nodes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOFSTRATEGY

echo ""
read -p "Deploy VMs volgens bovenstaande strategie? [Y/n]: " DEPLOY
DEPLOY=${DEPLOY:-Y}

if [[ ! $DEPLOY =~ ^[Yy]$ ]]; then
    echo "Deployment cancelled"
    exit 0
fi

# Deploy function
deploy_vm() {
    local VMID=$1
    local NAME=$2
    local NODE=$3
    local CORES=$4
    local RAM=$5
    local DISK=$6
    local IP=$7
    
    echo "  â†’ Deploying $NAME (VMID: $VMID) on $NODE..."
    
    # Clone from template
    qm clone 9000 $VMID \
        --name $NAME \
        --full \
        --storage ${CEPH_POOL_VMS} \
        --target $NODE
    
    # Configure
    qm set $VMID \
        --cores $CORES \
        --memory $RAM \
        --balloon 0 \
        --onboot 1
    
    # Resize disk
    qm resize $VMID scsi0 ${DISK}G
    
    # Network (game network bridge)
    qm set $VMID \
        --ipconfig0 ip=${IP}/24,gw=${GAME_GATEWAY} \
        --net0 virtio,bridge=vmbr2,tag=${GAME_VLAN}
    
    echo "  âœ… $NAME deployed"
}

# NODE 1: Panel + Monitoring (already deployed in previous steps)
echo ""
echo "NODE 1: Panel + Monitoring"
echo "  (Already deployed)"

# NODE 2: Heavy games
echo ""
echo "NODE 2: Heavy Games"
deploy_vm 201 "ark-island" "$NODE2_HOSTNAME" 8 24576 100 "192.168.20.21"
deploy_vm 202 "ark-ragnarok" "$NODE2_HOSTNAME" 8 24576 100 "192.168.20.22"
deploy_vm 210 "rust-main" "$NODE2_HOSTNAME" 6 16384 80 "192.168.20.30"

# NODE 3: FiveM
echo ""
echo "NODE 3: FiveM Servers"
for i in {1..5}; do
    VMID=$((300 + i))
    IP="192.168.20.$((40 + i))"
    deploy_vm $VMID "fivem-$i" "$NODE3_HOSTNAME" 3 6144 50 "$IP"
done

# NODE 4: Minecraft + CS2
echo ""
echo "NODE 4: Minecraft + CS2"
for i in {1..5}; do
    VMID=$((400 + i))
    IP="192.168.20.$((50 + i))"
    deploy_vm $VMID "minecraft-$i" "$NODE4_HOSTNAME" 2 4096 30 "$IP"
done

for i in {1..3}; do
    VMID=$((420 + i))
    IP="192.168.20.$((60 + i))"
    deploy_vm $VMID "cs2-$i" "$NODE4_HOSTNAME" 2 3072 30 "$IP"
done

# NODE 5: Light games
echo ""
echo "NODE 5: Light Games"
for i in {1..5}; do
    VMID=$((500 + i))
    IP="192.168.20.$((70 + i))"
    deploy_vm $VMID "palworld-$i" "$NODE5_HOSTNAME" 2 4096 40 "$IP"
done

echo ""
echo -e "${GREEN}âœ… VM deployment compleet!${NC}"
echo ""
echo "ğŸ“Š Cluster overview:"
qm list

echo ""
echo "ğŸ¯ Volgende stappen:"
echo "   1. Start VMs: qm start <vmid>"
echo "   2. SSH naar VMs en installeer gameserver software"
echo "   3. Configureer Pterodactyl Wings op elke game node"
cluster/99-cluster-status.sh
Bash

#!/bin/bash
###############################################################################
# Cluster Status Dashboard
###############################################################################

source config-cluster.env

clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                    PROXMOX GAMESERVER CLUSTER STATUS                      â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Cluster info
echo "ğŸŒ CLUSTER INFORMATION"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
pvecm status | head -15
echo ""

# Nodes
echo "ğŸ–¥ï¸  CLUSTER NODES"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
pvecm nodes
echo ""

# Resources
echo "ğŸ“Š RESOURCE USAGE"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
pvesh get /cluster/resources --type node --output-format yaml | grep -E 'node:|maxcpu:|cpu:|maxmem:|mem:|status:'
echo ""

# VMs
echo "ğŸ® VIRTUAL MACHINES"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
qm list
echo ""

# Ceph status
echo "ğŸ—„ï¸  CEPH STORAGE"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
ceph -s
echo ""

# HA Status
echo "ğŸ”„ HIGH AVAILABILITY"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
ha-manager status
echo ""

# Network stats
echo "ğŸŒ NETWORK OVERVIEW"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "Management Network: $MGMT_NETWORK (VLAN $MGMT_VLAN)"
echo "Game Network:       $GAME_NETWORK (VLAN $GAME_VLAN)"
echo "Ceph Network:       $CEPH_NETWORK (VLAN $CEPH_VLAN)"
echo ""

# Health check
echo "ğŸ¥ HEALTH CHECK"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Check quorum
if pvecm status | grep -q "Quorate.*Yes"; then
    echo "âœ… Cluster quorum: OK"
else
    echo "âŒ Cluster quorum: FAILED"
fi

# Check Ceph
if ceph health | grep -q "HEALTH_OK"; then
    echo "âœ… Ceph health: OK"
else
    echo "âš ï¸  Ceph health: $(ceph health)"
fi

# Check nodes
OFFLINE_NODES=$(pvesh get /cluster/resources --type node --output-format json | jq -r '.[] | select(.status != "online") | .node')
if [ -z "$OFFLINE_NODES" ]; then
    echo "âœ… All nodes online"
else
    echo "âŒ Offline nodes: $OFFLINE_NODES"
fi

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "Last updated: $(date)"
echo ""
echo "Web UI: https://$NODE1_IP_MGMT:8006"
echo "Grafana: http://$MON_IP:3000"
ğŸ“‹ SETUP WORKFLOW - COMPLETE GUIDE
â±ï¸ Timeline: ~3-4 uur
Bash

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CLUSTER SETUP WORKFLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VOORBEREIDING (30 min):
  â˜ Alle 5Ã— MS-01 nodes klaar
  â˜ Proxmox VE geÃ¯nstalleerd op alle nodes
  â˜ Netwerk hardware (switch, kabels)
  â˜ IP plan gedocumenteerd

FASE 1: NETWERK (30 min):
  â˜ Fysieke bekabeling
  â˜ Switch configuratie (VLANs)
  â˜ Netwerk configuratie op elke node
  â˜ Reboot alle nodes
  â˜ Ping test tussen nodes

FASE 2: CLUSTER (15 min):
  â˜ Cluster aanmaken op Node 1
  â˜ Nodes 2-5 toevoegen
  â˜ Quorum verificatie
  â˜ Corosync test

FASE 3: CEPH STORAGE (60 min):
  â˜ Ceph install op alle nodes
  â˜ Monitors aanmaken (5Ã—)
  â˜ Managers aanmaken
  â˜ OSDs aanmaken (5Ã—)
  â˜ Pools configureren
  â˜ Health check

FASE 4: HIGH AVAILABILITY (15 min):
  â˜ HA groups aanmaken
  â˜ Fencing configureren (optioneel)
  â˜ HA resources definiÃ«ren

FASE 5: MONITORING (30 min):
  â˜ Monitoring VM deployen
  â˜ Prometheus + Grafana setup
  â˜ Exporters op alle nodes
  â˜ Dashboards importeren

FASE 6: VM DEPLOYMENT (45 min):
  â˜ Cloud-init template aanmaken
  â˜ VMs deployen volgens strategie
  â˜ Eerste boot + SSH test
  â˜ Gameserver software installatie

FASE 7: TESTING (30 min):
  â˜ Live migration test
  â˜ HA failover test
  â˜ Ceph performance test
  â˜ Network throughput test

TOTAAL: ~3-4 uur (zonder gameserver configuratie)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ QUICK REFERENCE
Belangrijke Commando's:
Bash

# Cluster status
pvecm status
pvecm nodes
pvesh get /cluster/resources

# Ceph
ceph -s
ceph health detail
ceph df
pveceph status

# VMs
qm list
qm status <vmid>
qm start/stop/migrate <vmid>

# HA
ha-manager status
ha-manager config

# Live migrate VM
qm migrate <vmid> <target-node> --online

# Create snapshot
qm snapshot <vmid> <snapname>

# Backup
vzdump <vmid> --storage <storage>
Wil je nu:

ğŸ”Œ Gedetailleerde switch configuratie (MikroTik/Ubiquiti examples)?
ğŸ“Š Performance tuning guide (Ceph, network, VMs)?
ğŸ”§ Troubleshooting playbook (common issues + fixes)?
ğŸ® Game-specific VM templates (pre-configured voor elk spel)?
ğŸ“± Management scripts (auto-scaling, load balancing)?
Of gaan we direct aan de slag met de installatie? ğŸš€





ğŸ“Š Proxmox cluster configuratie maken voor je 5Ã— MS-01 nodes?

claude-sonnet-4-5-20250929-thinking-32k

Thought for 3 seconds

â— GOEDE VRAAG!
Nee, de scripts die ik tot nu toe heb gemaakt zijn voor directe Ubuntu Server installatie (bare metal).

Voor een Proxmox setup heb je een heel andere aanpak nodig! Laat me beide opties uitleggen en dan de Proxmox versie maken.

ğŸ”„ TWEE SETUP OPTIES
Optie A: Direct Ubuntu (Huidige Scripts)
text

MS-01 Hardware
    â””â”€ Ubuntu 22.04
        â””â”€ Docker containers + Game servers
Voordelen:

âœ… Simpeler
âœ… Iets betere performance (geen VM overhead)
âœ… Minder resources gebruikt
Nadelen:

âŒ Alles op 1 OS (minder isolatie)
âŒ Moeilijker te migreren
âŒ Geen snapshots/backups op VM niveau
Optie B: Proxmox (Professioneel) âœ… AANBEVOLEN
text

MS-01 Hardware
    â””â”€ Proxmox VE 8.1
        â”œâ”€ VM: Pterodactyl Panel (Ubuntu)
        â”œâ”€ VM: Game Node 1 (Ubuntu)
        â”œâ”€ VM: Game Node 2 (Ubuntu)
        â”œâ”€ VM: Monitoring (Ubuntu)
        â””â”€ LXC: Lightweight services
Voordelen:

âœ… Volledige isolatie per service
âœ… Snapshots & backups
âœ… Live migrations (bij cluster)
âœ… Flexibel resources toewijzen
âœ… Makkelijk testen/rollback
âœ… Professionele infrastructuur
Nadelen:

âŒ Iets complexer
âŒ ~10-15% resource overhead
âŒ Meer configuratie nodig
ğŸš€ PROXMOX AUTOMATED SETUP - COMPLEET
ğŸ“ NIEUWE DIRECTORY STRUCTUUR
text

gameserver-proxmox-setup/
â”œâ”€â”€ README.md
â”œâ”€â”€ PROXMOX-QUICKSTART.md
â”œâ”€â”€ install-proxmox.sh              # Master installer voor Proxmox
â”œâ”€â”€ config-proxmox.env.example      # Proxmox configuratie
â”‚
â”œâ”€â”€ proxmox/
â”‚   â”œâ”€â”€ 00-proxmox-base-setup.sh   # Proxmox basis configuratie
â”‚   â”œâ”€â”€ 01-create-templates.sh     # VM templates aanmaken
â”‚   â”œâ”€â”€ 02-deploy-panel-vm.sh      # Panel VM deployen
â”‚   â”œâ”€â”€ 03-deploy-node-vms.sh      # Game node VMs deployen
â”‚   â”œâ”€â”€ 04-deploy-monitoring-vm.sh # Monitoring VM
â”‚   â”œâ”€â”€ 05-network-setup.sh        # Netwerk configuratie
â”‚   â”œâ”€â”€ 06-storage-setup.sh        # Storage pools
â”‚   â””â”€â”€ 99-cluster-setup.sh        # Multi-node cluster (advanced)
â”‚
â”œâ”€â”€ cloud-init/                     # Cloud-init templates
â”‚   â”œâ”€â”€ panel-cloud-init.yml
â”‚   â”œâ”€â”€ node-cloud-init.yml
â”‚   â””â”€â”€ monitoring-cloud-init.yml
â”‚
â”œâ”€â”€ terraform/                      # Infrastructure as Code (bonus)
â”‚   â”œâ”€â”€ main.tf
â”‚   â”œâ”€â”€ variables.tf
â”‚   â””â”€â”€ vms.tf
â”‚
â””â”€â”€ ansible/                        # Automation (bonus)
    â”œâ”€â”€ inventory/
    â”œâ”€â”€ playbooks/
    â””â”€â”€ roles/
âš™ï¸ PROXMOX CONFIGURATIE
config-proxmox.env.example
Bash

###############################################################################
# Proxmox GameServer Setup - Configuratie
###############################################################################

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PROXMOX HOST CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Proxmox hostname
PVE_HOSTNAME="pve-node1"

# Proxmox IP (management interface)
PVE_IP="192.168.1.100"
PVE_GATEWAY="192.168.1.1"
PVE_NETMASK="255.255.255.0"

# DNS servers
PVE_DNS1="1.1.1.1"
PVE_DNS2="8.8.8.8"

# Timezone
TIMEZONE="Europe/Amsterdam"

# Email voor notificaties
ADMIN_EMAIL="admin@example.com"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STORAGE CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Primary storage type (lvm, zfs, dir)
STORAGE_TYPE="lvm-thin"

# VM storage location
VM_STORAGE="local-lvm"

# ISO storage
ISO_STORAGE="local"

# Backup storage
BACKUP_STORAGE="local"
BACKUP_DIR="/backup"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NETWERK CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Bridge voor VMs
VM_BRIDGE="vmbr0"

# VLAN support (true/false)
VLAN_AWARE="true"

# Management VLAN (optioneel)
MGMT_VLAN=""

# Game server VLAN
GAME_VLAN=""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VM TEMPLATES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ubuntu cloud image
UBUNTU_VERSION="22.04"
UBUNTU_CLOUD_IMAGE="https://cloud-images.ubuntu.com/releases/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img"

# Template VM ID
TEMPLATE_VMID="9000"

# Default VM user
VM_DEFAULT_USER="gameserver"

# SSH public key (voor cloud-init)
SSH_PUBLIC_KEY=""  # Vul in met je public key

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VM ALLOCATIONS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# PANEL VM
PANEL_VMID="100"
PANEL_HOSTNAME="panel"
PANEL_IP="192.168.1.110"
PANEL_CORES="4"
PANEL_RAM="8192"      # MB
PANEL_DISK="50"       # GB

# GAME NODE VMs
NODE1_VMID="201"
NODE1_HOSTNAME="game-node-1"
NODE1_IP="192.168.1.121"
NODE1_CORES="8"
NODE1_RAM="16384"
NODE1_DISK="200"

NODE2_VMID="202"
NODE2_HOSTNAME="game-node-2"
NODE2_IP="192.168.1.122"
NODE2_CORES="8"
NODE2_RAM="16384"
NODE2_DISK="200"

# MONITORING VM
MON_VMID="300"
MON_HOSTNAME="monitoring"
MON_IP="192.168.1.130"
MON_CORES="2"
MON_RAM="4096"
MON_DISK="50"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AUTOMATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Auto-start VMs on boot
AUTO_START_VMS="true"

# Auto-update templates
AUTO_UPDATE_TEMPLATES="true"

# Snapshots
AUTO_SNAPSHOT="true"
SNAPSHOT_RETENTION="7"  # dagen

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CLUSTER (voor multi-node setup)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Cluster mode (true = multiple MS-01 nodes)
CLUSTER_MODE="false"

# Cluster naam
CLUSTER_NAME="gameserver-cluster"

# Cluster nodes (comma separated IPs)
CLUSTER_NODES=""

# Shared storage (voor live migration)
SHARED_STORAGE="false"
ğŸ”§ PROXMOX SETUP SCRIPTS
install-proxmox.sh (Master)
Bash

#!/bin/bash
###############################################################################
# Proxmox GameServer Automated Setup - Master Installer
###############################################################################

set -e

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

clear
cat << "EOF"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                           â•‘
â•‘   ğŸ®  PROXMOX GAMESERVER SETUP                           â•‘
â•‘   Professional VM-based Infrastructure                   â•‘
â•‘                                                           â•‘
â•‘   Hardware: MS-01 (i9-12900H, 32GB RAM)                  â•‘
â•‘   Platform: Proxmox VE 8.1                               â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF

echo ""
echo -e "${BLUE}Gestart op: $(date)${NC}"
echo ""

# Check if running on Proxmox
if [ ! -f "/etc/pve/local/pve-ssl.pem" ]; then
    echo -e "${RED}âŒ Dit script moet draaien op een Proxmox VE host!${NC}"
    echo ""
    echo "Proxmox nog niet geÃ¯nstalleerd? Volg deze stappen:"
    echo "1. Download Proxmox VE ISO: https://www.proxmox.com/en/downloads"
    echo "2. Flash naar USB met Rufus/Etcher"
    echo "3. Boot MS-01 vanaf USB"
    echo "4. Installeer Proxmox (GUI installer)"
    echo "5. Login via web: https://your-ip:8006"
    echo "6. Voer dit script uit via SSH"
    echo ""
    exit 1
fi

# Check Proxmox version
PVE_VERSION=$(pveversion | grep -oP 'pve-manager/\K[0-9]+\.[0-9]+')
echo -e "${GREEN}âœ… Proxmox VE ${PVE_VERSION} gedetecteerd${NC}"
echo ""

# Load config
if [ ! -f "config-proxmox.env" ]; then
    echo -e "${RED}âŒ config-proxmox.env niet gevonden!${NC}"
    echo "Kopieer config-proxmox.env.example naar config-proxmox.env en pas aan"
    exit 1
fi

source config-proxmox.env

# Log setup
LOG_DIR="/var/log/gameserver-proxmox-setup"
mkdir -p $LOG_DIR
LOG_FILE="$LOG_DIR/install-$(date +%Y%m%d-%H%M%S).log"

log() {
    echo -e "${2}${1}${NC}" | tee -a $LOG_FILE
}

log "ğŸ“ Logbestand: $LOG_FILE" "$BLUE"
echo ""

###############################################################################
# MENU
###############################################################################

show_menu() {
    echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${GREEN}  Proxmox GameServer Setup Menu        ${NC}"
    echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "  [1] ğŸ”§ Complete setup (aanbevolen)"
    echo "  [2] ğŸ“¦ Proxmox basis configuratie"
    echo "  [3] ğŸ–¼ï¸  VM templates aanmaken"
    echo "  [4] ğŸš€ Deploy alle VMs"
    echo "  [5] ğŸŒ Netwerk configuratie"
    echo "  [6] ğŸ’¾ Storage configuratie"
    echo "  [7] ğŸ” Systeem status"
    echo "  [8] ğŸ—‘ï¸  Alles verwijderen (cleanup)"
    echo "  [9] âŒ Afsluiten"
    echo ""
    read -p "Keuze [1-9]: " choice
}

# Setup functies
setup_base() {
    log "ğŸ”§ Proxmox basis configuratie..." "$BLUE"
    bash proxmox/00-proxmox-base-setup.sh 2>&1 | tee -a $LOG_FILE
}

create_templates() {
    log "ğŸ–¼ï¸  VM templates aanmaken..." "$BLUE"
    bash proxmox/01-create-templates.sh 2>&1 | tee -a $LOG_FILE
}

deploy_vms() {
    log "ğŸš€ VMs deployen..." "$BLUE"
    bash proxmox/02-deploy-panel-vm.sh 2>&1 | tee -a $LOG_FILE
    bash proxmox/03-deploy-node-vms.sh 2>&1 | tee -a $LOG_FILE
    bash proxmox/04-deploy-monitoring-vm.sh 2>&1 | tee -a $LOG_FILE
}

setup_network() {
    log "ğŸŒ Netwerk configuratie..." "$BLUE"
    bash proxmox/05-network-setup.sh 2>&1 | tee -a $LOG_FILE
}

setup_storage() {
    log "ğŸ’¾ Storage configuratie..." "$BLUE"
    bash proxmox/06-storage-setup.sh 2>&1 | tee -a $LOG_FILE
}

system_status() {
    log "ğŸ” Systeem status..." "$BLUE"
    
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "PROXMOX HOST INFO"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    pveversion
    
    echo ""
    echo "RESOURCES:"
    pvesh get /nodes/$(hostname)/status
    
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "VIRTUAL MACHINES"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    qm list
    
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "STORAGE"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    pvesm status
    
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
}

cleanup_all() {
    echo -e "${RED}âš ï¸  WAARSCHUWING: Dit verwijdert ALLE VMs en templates!${NC}"
    read -p "Weet je het zeker? (type 'YES' om te bevestigen): " confirm
    
    if [ "$confirm" == "YES" ]; then
        log "ğŸ—‘ï¸  Cleanup gestart..." "$YELLOW"
        
        # Stop en verwijder alle VMs behalve templates
        for vmid in $(qm list | awk '{if(NR>1) print $1}'); do
            if [ $vmid -lt 9000 ]; then
                echo "Stopping VM $vmid..."
                qm stop $vmid || true
                sleep 2
                echo "Deleting VM $vmid..."
                qm destroy $vmid || true
            fi
        done
        
        log "âœ… Cleanup compleet" "$GREEN"
    else
        log "âŒ Cleanup geannuleerd" "$YELLOW"
    fi
}

# Menu loop
while true; do
    show_menu
    
    case $choice in
        1)
            log "ğŸš€ Volledige setup gestart..." "$GREEN"
            setup_base
            setup_storage
            setup_network
            create_templates
            deploy_vms
            log "âœ… Setup compleet!" "$GREEN"
            system_status
            break
            ;;
        2) setup_base ;;
        3) create_templates ;;
        4) deploy_vms ;;
        5) setup_network ;;
        6) setup_storage ;;
        7) system_status ;;
        8) cleanup_all ;;
        9)
            log "ğŸ‘‹ Afsluiten..." "$YELLOW"
            exit 0
            ;;
        *)
            echo -e "${RED}Ongeldige keuze${NC}"
            ;;
    esac
    
    echo ""
    read -p "Druk op Enter om door te gaan..."
    clear
done

# Final summary
echo ""
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${GREEN}â•‘                 âœ… SETUP VOLTOOID                         â•‘${NC}"
echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
log "ğŸ“Š Setup details:" "$BLUE"
log "   â€¢ Proxmox Web UI: https://${PVE_IP}:8006"
log "   â€¢ Panel VM: ${PANEL_IP}"
log "   â€¢ Game Node 1: ${NODE1_IP}"
log "   â€¢ Game Node 2: ${NODE2_IP}"
log "   â€¢ Monitoring: ${MON_IP}"
log "   â€¢ Logbestand: $LOG_FILE"
echo ""
log "ğŸ¯ Volgende stappen:" "$YELLOW"
log "   1. Login op VMs via SSH: ssh ${VM_DEFAULT_USER}@<vm-ip>"
log "   2. Voer gameserver setup uit op nodes"
log "   3. Configureer Pterodactyl panel"
log "   4. Import game eggs"
echo ""

exit 0
proxmox/00-proxmox-base-setup.sh
Bash

#!/bin/bash
###############################################################################
# Proxmox Base Setup
###############################################################################

source config-proxmox.env

echo "ğŸ”§ Proxmox basis configuratie..."

# Disable enterprise repo (needs subscription)
echo "ğŸ“¦ Repository configuratie..."
cat > /etc/apt/sources.list.d/pve-no-subscription.list << EOF
deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription
EOF

# Disable enterprise repo warning
if [ -f /etc/apt/sources.list.d/pve-enterprise.list ]; then
    mv /etc/apt/sources.list.d/pve-enterprise.list /etc/apt/sources.list.d/pve-enterprise.list.disabled
fi

# Update system
echo "ğŸ“¦ System update..."
apt update
apt dist-upgrade -y

# Essential packages
apt install -y \
    git \
    curl \
    wget \
    htop \
    iotop \
    vim \
    screen \
    tmux \
    net-tools \
    bridge-utils \
    vlan \
    ifupdown2 \
    libguestfs-tools \
    cloud-init \
    qemu-guest-agent

# CPU microcode
if grep -q "Intel" /proc/cpuinfo; then
    apt install -y intel-microcode
    echo "âœ… Intel microcode geÃ¯nstalleerd"
fi

# Remove nag dialog (no valid subscription)
echo "DPkg::Post-Invoke { \"dpkg -V proxmox-widget-toolkit | grep -q '/proxmoxlib\\.js$'; if [ \$? -eq 1 ]; then { echo 'Removing subscription nag from UI...'; sed -i '/.*data\\.status.*{/{s/!//;s/active/NoMoreNagging/}' /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js; }; fi\"; };" > /etc/apt/apt.conf.d/no-nag-script
apt --reinstall install proxmox-widget-toolkit &>/dev/null || true

# IOMMU for potential PCIe passthrough (future GPU servers)
if grep -q "Intel" /proc/cpuinfo; then
    sed -i 's/GRUB_CMDLINE_LINUX_DEFAULT="quiet"/GRUB_CMDLINE_LINUX_DEFAULT="quiet intel_iommu=on iommu=pt"/' /etc/default/grub
else
    sed -i 's/GRUB_CMDLINE_LINUX_DEFAULT="quiet"/GRUB_CMDLINE_LINUX_DEFAULT="quiet amd_iommu=on iommu=pt"/' /etc/default/grub
fi
update-grub

# Timezone
timedatectl set-timezone $TIMEZONE

# Email notifications setup
if [ -n "$ADMIN_EMAIL" ]; then
    pvesm set local --content vztmpl,iso,backup
    pveum user modify root@pam --email "$ADMIN_EMAIL"
fi

# Increase file limits
cat >> /etc/security/limits.conf << EOF

# GameServer limits
*               soft    nofile          1000000
*               hard    nofile          1000000
root            soft    nofile          1000000
root            hard    nofile          1000000
EOF

# Kernel tuning for gameservers
cat >> /etc/sysctl.conf << EOF

# GameServer optimizations
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.core.netdev_max_backlog = 5000
net.ipv4.tcp_congestion_control = bbr
net.core.default_qdisc = fq
vm.swappiness = 10
fs.file-max = 2097152
EOF

sysctl -p

# Backup directory
mkdir -p $BACKUP_DIR
pvesm add dir backup --path $BACKUP_DIR --content backup --maxfiles 10

echo "âœ… Proxmox basis configuratie compleet!"
echo ""
echo "âš ï¸  REBOOT AANBEVOLEN voor kernel updates"
read -p "Nu rebooten? (y/N): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    reboot
fi
proxmox/01-create-templates.sh
Bash

#!/bin/bash
###############################################################################
# Create VM Templates (Cloud-Init based)
###############################################################################

source config-proxmox.env

echo "ğŸ–¼ï¸  VM template aanmaken..."

# Download Ubuntu cloud image
echo "ğŸ“¥ Ubuntu ${UBUNTU_VERSION} cloud image downloaden..."
cd /var/lib/vz/template/iso
wget -q --show-progress "$UBUNTU_CLOUD_IMAGE" -O ubuntu-${UBUNTU_VERSION}-cloudimg.img

# Create VM template
echo "ğŸ”§ VM template configureren..."

# Destroy if exists
qm destroy $TEMPLATE_VMID || true

# Create VM
qm create $TEMPLATE_VMID \
    --name "ubuntu-${UBUNTU_VERSION}-template" \
    --memory 2048 \
    --cores 2 \
    --net0 virtio,bridge=${VM_BRIDGE} \
    --serial0 socket \
    --vga serial0

# Import disk
qm importdisk $TEMPLATE_VMID ubuntu-${UBUNTU_VERSION}-cloudimg.img $VM_STORAGE

# Attach disk
qm set $TEMPLATE_VMID \
    --scsihw virtio-scsi-pci \
    --scsi0 ${VM_STORAGE}:vm-${TEMPLATE_VMID}-disk-0

# Cloud-init drive
qm set $TEMPLATE_VMID --ide2 ${VM_STORAGE}:cloudinit

# Boot from disk
qm set $TEMPLATE_VMID --boot c --bootdisk scsi0

# Enable QEMU guest agent
qm set $TEMPLATE_VMID --agent enabled=1

# Convert to template
qm template $TEMPLATE_VMID

echo "âœ… VM template aangemaakt (ID: $TEMPLATE_VMID)"

# Create cloud-init configs
mkdir -p /var/lib/vz/snippets

# Panel cloud-init
cat > /var/lib/vz/snippets/panel-cloud-init.yml << EOFPANEL
#cloud-config
hostname: ${PANEL_HOSTNAME}
manage_etc_hosts: true
users:
  - name: ${VM_DEFAULT_USER}
    groups: sudo
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL
    ssh_authorized_keys:
      - ${SSH_PUBLIC_KEY}
package_upgrade: true
packages:
  - qemu-guest-agent
  - curl
  - wget
  - git
runcmd:
  - systemctl enable qemu-guest-agent
  - systemctl start qemu-guest-agent
  - echo "Panel VM ready" > /tmp/cloud-init-done
EOFPANEL

# Node cloud-init (similar for game nodes)
cat > /var/lib/vz/snippets/node-cloud-init.yml << EOFNODE
#cloud-config
hostname: game-node
manage_etc_hosts: true
users:
  - name: ${VM_DEFAULT_USER}
    groups: sudo
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL
    ssh_authorized_keys:
      - ${SSH_PUBLIC_KEY}
package_upgrade: true
packages:
  - qemu-guest-agent
  - curl
  - wget
  - git
  - docker.io
  - docker-compose
runcmd:
  - systemctl enable qemu-guest-agent
  - systemctl start qemu-guest-agent
  - systemctl enable docker
  - systemctl start docker
  - usermod -aG docker ${VM_DEFAULT_USER}
  - echo "Game node ready" > /tmp/cloud-init-done
EOFNODE

echo "âœ… Cloud-init configuraties aangemaakt"
proxmox/02-deploy-panel-vm.sh
Bash

#!/bin/bash
###############################################################################
# Deploy Pterodactyl Panel VM
###############################################################################

source config-proxmox.env

echo "ğŸš€ Panel VM deployen..."

# Clone from template
qm clone $TEMPLATE_VMID $PANEL_VMID \
    --name $PANEL_HOSTNAME \
    --full

# Configure resources
qm set $PANEL_VMID \
    --cores $PANEL_CORES \
    --memory $PANEL_RAM \
    --balloon 0

# Resize disk
qm resize $PANEL_VMID scsi0 ${PANEL_DISK}G

# Network configuration
qm set $PANEL_VMID \
    --ipconfig0 ip=${PANEL_IP}/24,gw=${PVE_GATEWAY} \
    --nameserver "${PVE_DNS1} ${PVE_DNS2}"

# Cloud-init user
qm set $PANEL_VMID \
    --ciuser $VM_DEFAULT_USER \
    --sshkeys <(echo "$SSH_PUBLIC_KEY")

# Auto-start
if [ "$AUTO_START_VMS" == "true" ]; then
    qm set $PANEL_VMID --onboot 1
fi

# Start VM
qm start $PANEL_VMID

echo "âœ… Panel VM gedeployed (VMID: $PANEL_VMID, IP: $PANEL_IP)"
echo ""
echo "Wacht 30 seconden voor boot..."
sleep 30

# Test SSH connection
echo "ğŸ” SSH connectie testen..."
if ssh -o StrictHostKeyChecking=no -o ConnectTimeout=10 ${VM_DEFAULT_USER}@${PANEL_IP} "echo 'SSH OK'" 2>/dev/null; then
    echo "âœ… SSH verbinding OK"
    
    # Copy gameserver setup scripts
    echo "ğŸ“¦ Setup scripts kopiÃ«ren..."
    scp -r ../scripts ${VM_DEFAULT_USER}@${PANEL_IP}:/home/${VM_DEFAULT_USER}/
    
    echo ""
    echo "ğŸ¯ Panel VM klaar! Volgende stappen:"
    echo "   ssh ${VM_DEFAULT_USER}@${PANEL_IP}"
    echo "   cd scripts && sudo ./01-pterodactyl-panel.sh"
else
    echo "âš ï¸  SSH nog niet beschikbaar, probeer later"
fi
proxmox/03-deploy-node-vms.sh
Bash

#!/bin/bash
###############################################################################
# Deploy Game Node VMs
###############################################################################

source config-proxmox.env

deploy_node() {
    local VMID=$1
    local HOSTNAME=$2
    local IP=$3
    local CORES=$4
    local RAM=$5
    local DISK=$6
    
    echo "ğŸš€ Deploying $HOSTNAME..."
    
    # Clone
    qm clone $TEMPLATE_VMID $VMID --name $HOSTNAME --full
    
    # Configure
    qm set $VMID \
        --cores $CORES \
        --memory $RAM \
        --balloon 0
    
    # Resize disk
    qm resize $VMID scsi0 ${DISK}G
    
    # Network
    qm set $VMID \
        --ipconfig0 ip=${IP}/24,gw=${PVE_GATEWAY} \
        --nameserver "${PVE_DNS1} ${PVE_DNS2}"
    
    # Cloud-init
    qm set $VMID \
        --ciuser $VM_DEFAULT_USER \
        --sshkeys <(echo "$SSH_PUBLIC_KEY")
    
    # Auto-start
    [ "$AUTO_START_VMS" == "true" ] && qm set $VMID --onboot 1
    
    # Start
    qm start $VMID
    
    echo "âœ… $HOSTNAME deployed (VMID: $VMID, IP: $IP)"
}

# Deploy nodes
deploy_node $NODE1_VMID "$NODE1_HOSTNAME" "$NODE1_IP" "$NODE1_CORES" "$NODE1_RAM" "$NODE1_DISK"
sleep 10
deploy_node $NODE2_VMID "$NODE2_HOSTNAME" "$NODE2_IP" "$NODE2_CORES" "$NODE2_RAM" "$NODE2_DISK"

echo ""
echo "âœ… Alle game nodes gedeployed!"
echo ""
echo "ğŸ“‹ Node overzicht:"
echo "  â€¢ $NODE1_HOSTNAME: $NODE1_IP ($NODE1_CORES cores, ${NODE1_RAM}MB RAM)"
echo "  â€¢ $NODE2_HOSTNAME: $NODE2_IP ($NODE2_CORES cores, ${NODE2_RAM}MB RAM)"
ğŸ¯ QUICK COMPARISON: PROXMOX vs DIRECT
Aspect	Direct Ubuntu	Proxmox VE
Setup tijd	30-45 min	60-90 min
Complexiteit	â­â­	â­â­â­â­
Performance	100%	~90%
Isolatie	Containers	VMs
Backups	File-based	VM snapshots
Migratie	Moeilijk	Makkelijk
Flexibiliteit	Middel	Zeer hoog
Productie ready	Ja	Zeer ja
Aanbevolen voor	Single node, simpel	Multi-node, professioneel
ğŸ¤” WELKE KIES JE?
Kies DIRECT UBUNTU als:
âœ… Je 1 node hebt
âœ… Je snel wilt starten
âœ… Maximale performance nodig hebt
âœ… Geen ervaring met virtualisatie
Kies PROXMOX als:
âœ… Je multiple MS-01 nodes hebt (of wilt uitbreiden)
âœ… Je professionele setup wilt
âœ… Je makkelijk wilt testen/rollbacken
âœ… Je VM snapshots/backups wilt
âœ… Je services wilt isoleren
ğŸ’ª MIJN AANBEVELING:
Voor jouw 5Ã— MS-01 setup: PROXMOX 100%!

Waarom:

Je hebt 5 nodes â†’ perfect voor Proxmox cluster
Isolatie per game type (Minecraft VM, FiveM VM, etc.)
Live migration tussen nodes mogelijk
Snapshot voor elke game-update
Professionele monitoring
Makkelijk opschalen
Wil je dat ik:

âœ… Alle Proxmox scripts compleet maak (deploy scripts, monitoring, backup, cluster setup)?
ğŸ“Š Proxmox cluster configuratie maken voor je 5Ã— MS-01 nodes?
ğŸ³ Hybrid setup - Proxmox + LXC containers (nog lichter dan VMs)?
ğŸ® Per-game VM allocation strategie uitwerken?
Of gewoon direct de volledige Proxmox setup in 1 keer? ğŸš€





is dit de setup voor proxmox

claude-sonnet-4-5-20250929-thinking-32k

Thought for 2 seconds

ğŸš€ VOLLEDIGE GEAUTOMATISEERDE GAMESERVER SETUP
ğŸ“¦ COMPLETE PACKAGE DOWNLOAD
Bash

# Clone de complete setup
git clone https://github.com/jouw-repo/gameserver-automated-setup.git
cd gameserver-automated-setup

# Of handmatig downloaden:
wget https://raw.githubusercontent.com/.../setup-bundle.tar.gz
tar -xzf setup-bundle.tar.gz
cd gameserver-setup
ğŸ“ VOLLEDIGE DIRECTORY STRUCTUUR
text

gameserver-setup/
â”œâ”€â”€ README.md
â”œâ”€â”€ QUICKSTART.md
â”œâ”€â”€ LICENSE
â”œâ”€â”€ install.sh                          # âœ… Master installer
â”œâ”€â”€ config.env.example                  # âœ… Template configuratie
â”œâ”€â”€ config.env                          # Jouw configuratie (git ignored)
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ 00-system-prep.sh              # âœ… Systeem voorbereiding
â”‚   â”œâ”€â”€ 01-pterodactyl-panel.sh        # âœ… Panel installatie
â”‚   â”œâ”€â”€ 02-pterodactyl-wings.sh        # âœ… Wings installatie
â”‚   â”œâ”€â”€ 03-games-minecraft.sh          # â­ Minecraft
â”‚   â”œâ”€â”€ 04-games-fivem.sh              # â­ FiveM
â”‚   â”œâ”€â”€ 05-games-rust.sh               # â­ Rust
â”‚   â”œâ”€â”€ 06-games-cs2.sh                # â­ CS2/CS:GO
â”‚   â”œâ”€â”€ 07-games-palworld.sh           # â­ Palworld
â”‚   â”œâ”€â”€ 08-games-ark.sh                # â­ ARK
â”‚   â”œâ”€â”€ 09-monitoring.sh               # â­ Monitoring stack
â”‚   â”œâ”€â”€ 10-security.sh                 # â­ Security hardening
â”‚   â””â”€â”€ 11-backup.sh                   # â­ Backup systeem
â”‚
â”œâ”€â”€ eggs/                               # Pterodactyl eggs
â”‚   â”œâ”€â”€ egg-minecraft-paper.json
â”‚   â”œâ”€â”€ egg-minecraft-fabric.json
â”‚   â”œâ”€â”€ egg-minecraft-forge.json
â”‚   â”œâ”€â”€ egg-fivem.json
â”‚   â”œâ”€â”€ egg-rust.json
â”‚   â”œâ”€â”€ egg-cs2.json
â”‚   â”œâ”€â”€ egg-csgo.json
â”‚   â”œâ”€â”€ egg-palworld.json
â”‚   â””â”€â”€ egg-ark-se.json
â”‚
â”œâ”€â”€ configs/                            # Game config templates
â”‚   â”œâ”€â”€ minecraft/
â”‚   â”œâ”€â”€ fivem/
â”‚   â”œâ”€â”€ rust/
â”‚   â”œâ”€â”€ cs2/
â”‚   â”œâ”€â”€ palworld/
â”‚   â””â”€â”€ ark/
â”‚
â”œâ”€â”€ utils/                              # Utility scripts
â”‚   â”œâ”€â”€ system-check.sh
â”‚   â”œâ”€â”€ update-all-games.sh
â”‚   â”œâ”€â”€ health-monitor.sh
â”‚   â”œâ”€â”€ port-scanner.sh
â”‚   â”œâ”€â”€ resource-calculator.sh
â”‚   â””â”€â”€ backup-restore.sh
â”‚
â”œâ”€â”€ docker/                             # Docker compose files
â”‚   â”œâ”€â”€ monitoring-stack.yml
â”‚   â”œâ”€â”€ pterodactyl-stack.yml
â”‚   â””â”€â”€ game-servers.yml
â”‚
â”œâ”€â”€ web/                                # Web dashboard (bonus)
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ dashboard.js
â”‚   â””â”€â”€ styles.css
â”‚
â””â”€â”€ docs/                               # Documentatie
    â”œâ”€â”€ INSTALLATION.md
    â”œâ”€â”€ CONFIGURATION.md
    â”œâ”€â”€ TROUBLESHOOTING.md
    â”œâ”€â”€ PERFORMANCE.md
    â””â”€â”€ SECURITY.md
â­ ALLE GAME SCRIPTS - COMPLEET
scripts/03-games-minecraft.sh
Bash

#!/bin/bash
###############################################################################
# Minecraft Server Setup (Paper, Fabric, Forge)
###############################################################################

source config.env

if [ "$INSTALL_MINECRAFT" != "true" ]; then
    echo "â­ï¸  Minecraft installatie overgeslagen"
    exit 0
fi

echo "ğŸ® Minecraft server setup gestart..."

# Minecraft user
if ! id "minecraft" &>/dev/null; then
    useradd -m -s /bin/bash minecraft
    echo "âœ… Gebruiker 'minecraft' aangemaakt"
fi

# Java installeren (multiple versies voor compatibiliteit)
echo "â˜• Java installeren..."
apt install -y openjdk-8-jre-headless openjdk-17-jre-headless openjdk-21-jre-headless

# Directories
MINECRAFT_BASE="/home/minecraft"
mkdir -p $MINECRAFT_BASE/{paper,fabric,forge,plugins,mods,backups}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PAPER (Optimized Vanilla)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ“¥ Paper downloaden..."

PAPER_VERSIONS="${MINECRAFT_VERSIONS:-1.20.4,1.19.4,1.18.2}"
IFS=',' read -ra VERSIONS <<< "$PAPER_VERSIONS"

for VERSION in "${VERSIONS[@]}"; do
    echo "  â†’ Downloading Paper $VERSION..."
    
    mkdir -p $MINECRAFT_BASE/paper/$VERSION
    cd $MINECRAFT_BASE/paper/$VERSION
    
    # Get latest build
    BUILD=$(curl -s https://api.papermc.io/v2/projects/paper/versions/$VERSION | \
            jq -r '.builds[-1]')
    
    wget -q "https://api.papermc.io/v2/projects/paper/versions/$VERSION/builds/$BUILD/downloads/paper-$VERSION-$BUILD.jar" \
        -O paper.jar
    
    echo "eula=true" > eula.txt
    
    # Startup script met Aikar's flags
    cat > start.sh << 'EOFPAPER'
#!/bin/bash
# Minecraft Paper Server - Optimized Startup

# RAM allocation (customize per server)
MIN_RAM="${MIN_RAM:-2G}"
MAX_RAM="${MAX_RAM:-4G}"

# Aikar's flags for optimal GC performance
java -Xms$MIN_RAM -Xmx$MAX_RAM \
  -XX:+UseG1GC \
  -XX:+ParallelRefProcEnabled \
  -XX:MaxGCPauseMillis=200 \
  -XX:+UnlockExperimentalVMOptions \
  -XX:+DisableExplicitGC \
  -XX:+AlwaysPreTouch \
  -XX:G1NewSizePercent=30 \
  -XX:G1MaxNewSizePercent=40 \
  -XX:G1HeapRegionSize=8M \
  -XX:G1ReservePercent=20 \
  -XX:G1HeapWastePercent=5 \
  -XX:G1MixedGCCountTarget=4 \
  -XX:InitiatingHeapOccupancyPercent=15 \
  -XX:G1MixedGCLiveThresholdPercent=90 \
  -XX:G1RSetUpdatingPauseTimePercent=5 \
  -XX:SurvivorRatio=32 \
  -XX:+PerfDisableSharedMem \
  -XX:MaxTenuringThreshold=1 \
  -Dusing.aikars.flags=https://mcflags.emc.gs \
  -Daikars.new.flags=true \
  -jar paper.jar --nogui
EOFPAPER
    
    chmod +x start.sh
    
    echo "  âœ… Paper $VERSION geÃ¯nstalleerd"
done

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FABRIC (Modded - Lightweight)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ“¥ Fabric installer downloaden..."

mkdir -p $MINECRAFT_BASE/fabric
cd $MINECRAFT_BASE/fabric

wget -q https://maven.fabricmc.net/net/fabricmc/fabric-installer/1.0.0/fabric-installer-1.0.0.jar

for VERSION in "${VERSIONS[@]}"; do
    echo "  â†’ Installing Fabric for $VERSION..."
    
    mkdir -p $MINECRAFT_BASE/fabric/$VERSION
    cd $MINECRAFT_BASE/fabric/$VERSION
    
    java -jar ../fabric-installer-1.0.0.jar server \
        -mcversion $VERSION \
        -downloadMinecraft
    
    echo "eula=true" > eula.txt
    
    cat > start.sh << 'EOFFABRIC'
#!/bin/bash
MIN_RAM="${MIN_RAM:-2G}"
MAX_RAM="${MAX_RAM:-4G}"

java -Xms$MIN_RAM -Xmx$MAX_RAM \
  -jar fabric-server-launch.jar nogui
EOFFABRIC
    
    chmod +x start.sh
    
    echo "  âœ… Fabric $VERSION geÃ¯nstalleerd"
done

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ESSENTIAL PLUGINS (Paper)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ“¦ Essential plugins downloaden..."

PLUGIN_DIR="$MINECRAFT_BASE/plugins"
mkdir -p $PLUGIN_DIR

declare -A PLUGINS=(
    ["EssentialsX"]="https://ci.ender.zone/job/EssentialsX/lastSuccessfulBuild/artifact/jars/EssentialsX-2.20.1.jar"
    ["LuckPerms"]="https://download.luckperms.net/1533/bukkit/loader/LuckPerms-Bukkit-5.4.108.jar"
    ["Vault"]="https://github.com/MilkBowl/Vault/releases/download/1.7.3/Vault.jar"
    ["WorldEdit"]="https://dev.bukkit.org/projects/worldedit/files/latest"
    ["CoreProtect"]="https://github.com/PlayPro/CoreProtect/releases/download/v22.2/CoreProtect-22.2.jar"
)

for PLUGIN in "${!PLUGINS[@]}"; do
    echo "  â†’ Downloading $PLUGIN..."
    wget -q "${PLUGINS[$PLUGIN]}" -O "$PLUGIN_DIR/$PLUGIN.jar" 2>/dev/null || echo "    âš ï¸  Manual download needed for $PLUGIN"
done

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# POPULAR MODPACKS (Fabric)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ“¦ Popular mods downloaden (Fabric)..."

MOD_DIR="$MINECRAFT_BASE/mods"
mkdir -p $MOD_DIR

# Fabric API (required for most mods)
wget -q "https://github.com/FabricMC/fabric/releases/download/0.95.4+1.20.4/fabric-api-0.95.4+1.20.4.jar" \
    -O "$MOD_DIR/fabric-api.jar"

echo "âœ… Minecraft setup compleet!"
echo "  â†’ Paper servers: $MINECRAFT_BASE/paper/"
echo "  â†’ Fabric servers: $MINECRAFT_BASE/fabric/"
echo "  â†’ Plugins: $PLUGIN_DIR/"
echo "  â†’ Mods: $MOD_DIR/"

chown -R minecraft:minecraft $MINECRAFT_BASE
scripts/04-games-fivem.sh
Bash

#!/bin/bash
###############################################################################
# FiveM Server Setup
###############################################################################

source config.env

if [ "$INSTALL_FIVEM" != "true" ]; then
    echo "â­ï¸  FiveM installatie overgeslagen"
    exit 0
fi

echo "ğŸš— FiveM server setup gestart..."

# FiveM user
if ! id "fivem" &>/dev/null; then
    useradd -m -s /bin/bash fivem
fi

# Dependencies
apt install -y xz-utils git

# Base directory
FIVEM_BASE="/home/fivem"
mkdir -p $FIVEM_BASE/server

# Download latest FiveM artifact
echo "ğŸ“¥ FiveM server downloaden..."
cd $FIVEM_BASE/server

ARTIFACT_URL=$(curl -s https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/ | \
    grep -Eo 'href="[0-9]+-[a-f0-9]+/fx\.tar\.xz"' | \
    tail -1 | \
    sed 's/href="//;s/"//')

wget "https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/$ARTIFACT_URL" -O fx.tar.xz
tar xf fx.tar.xz
rm fx.tar.xz

# Server data template
echo "ğŸ“¦ Server data template downloaden..."
cd $FIVEM_BASE
git clone https://github.com/citizenfx/cfx-server-data.git server-data

# ESX Framework (most popular)
echo "ğŸ“¦ ESX Framework downloaden..."
cd $FIVEM_BASE/server-data/resources
git clone https://github.com/esx-framework/esx_core.git [esx]
git clone https://github.com/esx-framework/esx-legacy.git [esx-legacy]

# Essential resources
mkdir -p $FIVEM_BASE/server-data/resources/[essential]
cd $FIVEM_BASE/server-data/resources/[essential]

# oxmysql (database)
git clone https://github.com/overextended/oxmysql.git

# pma-voice (voice chat)
wget https://github.com/AvarianKnight/pma-voice/releases/latest/download/pma-voice.zip
unzip pma-voice.zip -d pma-voice
rm pma-voice.zip

# Server config
cat > $FIVEM_BASE/server-data/server.cfg << 'EOFFIVEM'
# FiveM Server Configuration

# Server info
sv_hostname "^2FiveM^7 Server"
sv_projectName "My RP Server"
sv_projectDesc "Best RP in town!"
sets sv_projectDesc "Best RP in town!"
sets locale "nl_NL"

# License key (get from https://keymaster.fivem.net)
sv_licenseKey "YOUR_LICENSE_KEY_HERE"

# Max players (32 without license, up to 2048 with license)
sv_maxclients 48

# Endpoint
endpoint_add_tcp "0.0.0.0:30120"
endpoint_add_udp "0.0.0.0:30120"

# Steam Web API key (optional, from https://steamcommunity.com/dev/apikey)
set steam_webApiKey "YOUR_STEAM_API_KEY"

# Database connection (MySQL/MariaDB)
set mysql_connection_string "mysql://fivem:password@localhost/fivem?charset=utf8mb4"

# Resources
ensure mapmanager
ensure chat
ensure spawnmanager
ensure sessionmanager
ensure basic-gamemode
ensure hardcap

# Voice
ensure pma-voice

# ESX
ensure esx_core
ensure esx-legacy

# Admin
add_ace group.admin command allow
add_ace group.admin command.quit deny
add_principal identifier.steam:YOUR_STEAM_ID group.admin

# Permissions
add_ace resource.essentialmode command.sets allow

# OneSync (required for 32+ players)
set onesync on

# Server commands
add_principal identifier.fivem:1 group.admin

# Convars
set sv_enforceGameBuild 2699
EOFFIVEM

# Startup script
cat > $FIVEM_BASE/start.sh << 'EOFSTART'
#!/bin/bash
cd /home/fivem/server-data

# Resource limits
ulimit -n 4096

# Start server
/home/fivem/server/run.sh +exec server.cfg
EOFSTART

chmod +x $FIVEM_BASE/start.sh

# Database setup
echo "ğŸ—„ï¸  FiveM database configureren..."
mysql -u root <<EOFSQL
CREATE DATABASE IF NOT EXISTS fivem;
CREATE USER IF NOT EXISTS 'fivem'@'localhost' IDENTIFIED BY 'fivem_password';
GRANT ALL PRIVILEGES ON fivem.* TO 'fivem'@'localhost';
FLUSH PRIVILEGES;
EOFSQL

# Import ESX database
if [ -f "$FIVEM_BASE/server-data/resources/[esx]/esx_core/esx.sql" ]; then
    mysql -u fivem -pfivem_password fivem < "$FIVEM_BASE/server-data/resources/[esx]/esx_core/esx.sql"
fi

chown -R fivem:fivem $FIVEM_BASE

echo "âœ… FiveM setup compleet!"
echo ""
echo "âš ï¸  BELANGRIJK:"
echo "  1. Haal license key van https://keymaster.fivem.net"
echo "  2. Pas server.cfg aan: $FIVEM_BASE/server-data/server.cfg"
echo "  3. Wijzig database password in server.cfg"
echo "  4. Start server: sudo -u fivem $FIVEM_BASE/start.sh"
scripts/05-games-rust.sh
Bash

#!/bin/bash
###############################################################################
# Rust Server Setup
###############################################################################

source config.env

if [ "$INSTALL_RUST" != "true" ]; then
    echo "â­ï¸  Rust installatie overgeslagen"
    exit 0
fi

echo "ğŸ”« Rust server setup gestart..."

# Rust user
if ! id "rust" &>/dev/null; then
    useradd -m -s /bin/bash rust
fi

RUST_BASE="/home/rust"
RUST_DIR="$RUST_BASE/server"

# Install Rust server
echo "ğŸ“¥ Rust server downloaden (dit duurt even...)..."
sudo -u rust steamcmd +force_install_dir $RUST_DIR \
    +login anonymous \
    +app_update 258550 \
    ${RUST_BRANCH:+"-beta $RUST_BRANCH"} \
    validate \
    +quit

# uMod (Oxide) - plugin framework
echo "ğŸ“¦ uMod/Oxide installeren..."
cd $RUST_DIR

OXIDE_URL=$(curl -s https://umod.org/games/rust.json | jq -r '.latest_release_url')
wget -q "$OXIDE_URL" -O oxide.zip
unzip -o oxide.zip
rm oxide.zip

# Essential plugins directory structure
mkdir -p $RUST_BASE/{plugins,configs,data,logs}

# Download essential plugins
echo "ğŸ“¦ Essential plugins downloaden..."
PLUGIN_DIR="$RUST_BASE/plugins"

declare -A PLUGINS=(
    ["BetterChat"]="https://umod.org/plugins/better-chat.json"
    ["AdminRadar"]="https://umod.org/plugins/admin-radar.json"
    ["Kits"]="https://umod.org/plugins/kits.json"
    ["Teleportation"]="https://umod.org/plugins/teleportation.json"
)

# Note: Direct downloads need uMod account, deze zijn placeholders
echo "  âš ï¸  Download plugins handmatig van umod.org en plaats in $PLUGIN_DIR"

# Startup script
cat > $RUST_BASE/start.sh << 'EOFRUST'
#!/bin/bash
###############################################################################
# Rust Server Startup Script
###############################################################################

# Server Configuration
SERVER_HOSTNAME="${SERVER_HOSTNAME:-Rust Server}"
SERVER_DESCRIPTION="${SERVER_DESCRIPTION:-A Rust Server}"
SERVER_URL="${SERVER_URL:-https://example.com}"
SERVER_BANNER="${SERVER_BANNER:-https://example.com/banner.png}"
SERVER_MAXPLAYERS="${SERVER_MAXPLAYERS:-100}"
WORLD_SIZE="${WORLD_SIZE:-3500}"
WORLD_SEED="${WORLD_SEED:-12345}"
SAVE_INTERVAL="${SAVE_INTERVAL:-300}"

# Ports
SERVER_PORT="${SERVER_PORT:-28015}"
RCON_PORT="${RCON_PORT:-28016}"
RCON_PASSWORD="${RCON_PASSWORD:-changeMe123}"
APP_PORT="${APP_PORT:-28082}"

# Paths
RUST_DIR="/home/rust/server"
IDENTITY="${IDENTITY:-main}"

cd $RUST_DIR

# Start server
./RustDedicated \
    -batchmode \
    -nographics \
    +server.hostname "$SERVER_HOSTNAME" \
    +server.description "$SERVER_DESCRIPTION" \
    +server.url "$SERVER_URL" \
    +server.headerimage "$SERVER_BANNER" \
    +server.port $SERVER_PORT \
    +server.maxplayers $SERVER_MAXPLAYERS \
    +server.worldsize $WORLD_SIZE \
    +server.seed $WORLD_SEED \
    +server.saveinterval $SAVE_INTERVAL \
    +server.identity "$IDENTITY" \
    +rcon.port $RCON_PORT \
    +rcon.password "$RCON_PASSWORD" \
    +rcon.web 1 \
    +app.port $APP_PORT \
    -logfile "$RUST_DIR/logs/$(date +%Y%m%d-%H%M%S).log"
EOFRUST

chmod +x $RUST_BASE/start.sh

# Server config template
mkdir -p $RUST_DIR/server/$IDENTITY/cfg
cat > $RUST_DIR/server/$IDENTITY/cfg/server.cfg << 'EOFCFG'
# Rust Server Configuration

# Server Settings
server.hostname "Rust Server"
server.description "Powered by MS-01 cluster"
server.url "https://yourwebsite.com"
server.headerimage "https://yourwebsite.com/banner.png"
server.logoimage "https://yourwebsite.com/logo.png"

# Security
server.encryption 1
server.secure 1

# Performance
server.tickrate 30
server.fps 60
server.maxplayers 100
server.worldsize 3500
server.seed 12345
server.saveinterval 300

# PvP/PvE
server.pve false
server.radiation true

# Decay
decay.upkeep true
decay.upkeep_period_minutes 1440

# Wipes (comment out for manual control)
# server.wiperadius 2000

# RCON
rcon.web 1
rcon.password "changeme123"

# Logging
server.official false
EOFCFG

chown -R rust:rust $RUST_BASE

echo "âœ… Rust setup compleet!"
echo "  â†’ Server: $RUST_DIR"
echo "  â†’ Plugins: $PLUGIN_DIR"
echo "  â†’ Start: sudo -u rust $RUST_BASE/start.sh"
echo ""
echo "âš ï¸  Download plugins van: https://umod.org/plugins"
scripts/06-games-cs2.sh
Bash

#!/bin/bash
###############################################################################
# Counter-Strike 2 & CS:GO Setup
###############################################################################

source config.env

echo "ğŸ¯ CS2/CS:GO server setup gestart..."

# CS user
if ! id "csgo" &>/dev/null; then
    useradd -m -s /bin/bash csgo
fi

CS_BASE="/home/csgo"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CS2 (Counter-Strike 2)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_CS2" == "true" ]; then
    echo "ğŸ“¥ CS2 server downloaden..."
    
    CS2_DIR="$CS_BASE/cs2"
    
    sudo -u csgo steamcmd +force_install_dir $CS2_DIR \
        +login anonymous \
        +app_update 730 validate \
        +quit
    
    # Startup script
    cat > $CS2_DIR/start.sh << 'EOFCS2'
#!/bin/bash
# CS2 Server Startup

HOSTNAME="${HOSTNAME:-CS2 Server}"
RCON_PASSWORD="${RCON_PASSWORD:-changeme}"
GSLT="${GSLT:-}"  # Get from https://steamcommunity.com/dev/managegameservers
MAP="${MAP:-de_dust2}"
MAXPLAYERS="${MAXPLAYERS:-20}"
TICKRATE="${TICKRATE:-128}"
PORT="${PORT:-27015}"

cd /home/csgo/cs2/game/bin/linuxsteamrt64

./cs2 \
    -dedicated \
    -console \
    +hostname "$HOSTNAME" \
    +rcon_password "$RCON_PASSWORD" \
    +sv_setsteamaccount "$GSLT" \
    +map $MAP \
    +maxplayers $MAXPLAYERS \
    -tickrate $TICKRATE \
    -port $PORT \
    +game_type 0 \
    +game_mode 1 \
    +mapgroup mg_active \
    +sv_lan 0
EOFCS2
    
    chmod +x $CS2_DIR/start.sh
    
    echo "âœ… CS2 geÃ¯nstalleerd: $CS2_DIR"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CS:GO (Legacy)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_CSGO" == "true" ]; then
    echo "ğŸ“¥ CS:GO server downloaden..."
    
    CSGO_DIR="$CS_BASE/csgo"
    
    sudo -u csgo steamcmd +force_install_dir $CSGO_DIR \
        +login anonymous \
        +app_update 740 validate \
        +quit
    
    # Metamod:Source
    echo "ğŸ“¦ Metamod:Source installeren..."
    cd $CSGO_DIR/csgo
    
    MM_URL=$(curl -s https://mms.alliedmods.net/mmsdrop/1.11/mmsource-latest-linux | grep -o 'href="[^"]*"' | sed 's/href="//;s/"//' | head -1)
    wget "https://mms.alliedmods.net$MM_URL" -O mmsource.tar.gz
    tar -xzf mmsource.tar.gz
    rm mmsource.tar.gz
    
    # SourceMod
    echo "ğŸ“¦ SourceMod installeren..."
    SM_URL=$(curl -s https://sm.alliedmods.net/smdrop/1.11/sourcemod-latest-linux | grep -o 'href="[^"]*"' | sed 's/href="//;s/"//' | head -1)
    wget "https://sm.alliedmods.net$SM_URL" -O sourcemod.tar.gz
    tar -xzf sourcemod.tar.gz
    rm sourcemod.tar.gz
    
    # Startup script
    cat > $CSGO_DIR/start.sh << 'EOFCSGO'
#!/bin/bash
# CS:GO Server Startup

HOSTNAME="${HOSTNAME:-CS:GO Server}"
RCON_PASSWORD="${RCON_PASSWORD:-changeme}"
GSLT="${GSLT:-}"
MAP="${MAP:-de_dust2}"
MAXPLAYERS="${MAXPLAYERS:-20}"
TICKRATE="${TICKRATE:-128}"
PORT="${PORT:-27015}"

cd /home/csgo/csgo

./srcds_run \
    -game csgo \
    -console \
    -usercon \
    +hostname "$HOSTNAME" \
    +rcon_password "$RCON_PASSWORD" \
    +sv_setsteamaccount "$GSLT" \
    +map $MAP \
    -maxplayers $MAXPLAYERS \
    -tickrate $TICKRATE \
    -port $PORT \
    +game_type 0 \
    +game_mode 1 \
    +mapgroup mg_active \
    +sv_lan 0
EOFCSGO
    
    chmod +x $CSGO_DIR/start.sh
    
    # Server config
    mkdir -p $CSGO_DIR/csgo/cfg
    cat > $CSGO_DIR/csgo/cfg/server.cfg << 'EOFSVCFG'
// CS:GO Server Configuration

// Server Info
hostname "CS:GO Server"
sv_password ""
rcon_password "changeme"

// Server Settings
mp_autoteambalance 1
mp_limitteams 1
mp_roundtime 1.92
mp_freezetime 5
mp_c4timer 35
mp_startmoney 800
mp_maxmoney 16000

// Game Settings
sv_cheats 0
sv_lan 0
sv_region 3

// Communication
sv_alltalk 0
sv_deadtalk 0
sv_full_alltalk 0

// Rates
sv_minrate 786432
sv_maxrate 0
sv_mincmdrate 128
sv_maxcmdrate 128
sv_minupdaterate 128
sv_maxupdaterate 128

// Logging
log on
sv_logbans 1
sv_logecho 1
sv_logfile 1
sv_log_onefile 0
EOFSVCFG
    
    echo "âœ… CS:GO geÃ¯nstalleerd: $CSGO_DIR"
fi

chown -R csgo:csgo $CS_BASE

echo "âœ… CS setup compleet!"
echo ""
echo "âš ï¸  Haal een Game Server Login Token (GSLT) van:"
echo "    https://steamcommunity.com/dev/managegameservers"
scripts/07-games-palworld.sh
Bash

#!/bin/bash
###############################################################################
# Palworld Server Setup
###############################################################################

source config.env

if [ "$INSTALL_PALWORLD" != "true" ]; then
    echo "â­ï¸  Palworld installatie overgeslagen"
    exit 0
fi

echo "ğŸ¦– Palworld server setup gestart..."

# Palworld user
if ! id "palworld" &>/dev/null; then
    useradd -m -s /bin/bash palworld
fi

PALWORLD_BASE="/home/palworld"
PALWORLD_DIR="$PALWORLD_BASE/server"

# Install server
echo "ğŸ“¥ Palworld server downloaden..."
sudo -u palworld steamcmd +force_install_dir $PALWORLD_DIR \
    +login anonymous \
    +app_update 2394010 validate \
    +quit

# Config directory
mkdir -p $PALWORLD_DIR/Pal/Saved/Config/LinuxServer

# Default config
cat > $PALWORLD_DIR/Pal/Saved/Config/LinuxServer/PalWorldSettings.ini << 'EOFPALWORLD'
[/Script/Pal.PalGameWorldSettings]
OptionSettings=(
    ServerName="Palworld Server",
    ServerDescription="A Palworld Server",
    ServerPassword="",
    PublicPort=8211,
    MaxPlayers=32,
    Region="",
    bUseAuth=True,
    RCONEnabled=True,
    RCONPort=25575,
    Difficulty=2,
    DayTimeSpeedRate=1.000000,
    NightTimeSpeedRate=1.000000,
    ExpRate=1.000000,
    PalCaptureRate=1.000000,
    PalSpawnNumRate=1.000000,
    PalDamageRateAttack=1.000000,
    PalDamageRateDefense=1.000000,
    PlayerDamageRateAttack=1.000000,
    PlayerDamageRateDefense=1.000000,
    PlayerStomachDecreaseRate=1.000000,
    PlayerStaminaDecreaseRate=1.000000,
    PlayerAutoHPRegeneRate=1.000000,
    PlayerAutoHpRegeneRateInSleep=1.000000,
    PalStomachDecreaseRate=1.000000,
    PalStaminaDecreaseRate=1.000000,
    PalAutoHPRegeneRate=1.000000,
    PalAutoHpRegeneRateInSleep=1.000000,
    BuildObjectDamageRate=1.000000,
    BuildObjectDeteriorationDamageRate=1.000000,
    CollectionDropRate=1.000000,
    CollectionObjectHpRate=1.000000,
    CollectionObjectRespawnSpeedRate=1.000000,
    EnemyDropItemRate=1.000000,
    DeathPenalty=1,
    bEnablePlayerToPlayerDamage=False,
    bEnableFriendlyFire=False,
    bEnableInvaderEnemy=True,
    bActiveUNKO=False,
    bEnableAimAssistPad=True,
    bEnableAimAssistKeyboard=False,
    DropItemMaxNum=3000,
    DropItemMaxNum_UNKO=100,
    BaseCampMaxNum=128,
    BaseCampWorkerMaxNum=15,
    DropItemAliveMaxHours=1.000000,
    bAutoResetGuildNoOnlinePlayers=False,
    AutoResetGuildTimeNoOnlinePlayers=72.000000,
    GuildPlayerMaxNum=20,
    PalEggDefaultHatchingTime=72.000000,
    WorkSpeedRate=1.000000,
    bIsMultiplay=False,
    bIsPvP=False,
    bCanPickupOtherGuildDeathPenaltyDrop=False,
    bEnableNonLoginPenalty=True,
    bEnableFastTravel=True,
    bIsStartLocationSelectByMap=True,
    bExistPlayerAfterLogout=False,
    bEnableDefenseOtherGuildPlayer=False,
    CoopPlayerMaxNum=4,
    ServerPlayerMaxNum=32,
    BanListURL="https://api.palworldgame.com/api/banlist.txt"
)
EOFPALWORLD

# Startup script
cat > $PALWORLD_BASE/start.sh << 'EOFSTART'
#!/bin/bash
# Palworld Server Startup

cd /home/palworld/server

./PalServer.sh \
    -useperfthreads \
    -NoAsyncLoadingThread \
    -UseMultithreadForDS
EOFSTART

chmod +x $PALWORLD_BASE/start.sh
chown -R palworld:palworld $PALWORLD_BASE

echo "âœ… Palworld setup compleet!"
echo "  â†’ Server: $PALWORLD_DIR"
echo "  â†’ Config: $PALWORLD_DIR/Pal/Saved/Config/LinuxServer/"
echo "  â†’ Start: sudo -u palworld $PALWORLD_BASE/start.sh"
ğŸ“Š MONITORING STACK
scripts/09-monitoring.sh
Bash

#!/bin/bash
###############################################################################
# Monitoring Stack - Netdata, Uptime Kuma, Grafana
###############################################################################

source config.env

echo "ğŸ“Š Monitoring stack installeren..."

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NETDATA - Real-time monitoring
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_NETDATA" == "true" ]; then
    echo "ğŸ“ˆ Netdata installeren..."
    
    wget -O /tmp/netdata-kickstart.sh https://my-netdata.io/kickstart.sh
    sh /tmp/netdata-kickstart.sh --non-interactive --stable-channel
    
    # Config optimalisatie voor gameservers
    cat >> /etc/netdata/netdata.conf << 'EOFNETDATA'
[global]
    memory mode = dbengine
    page cache size = 128
    dbengine multihost disk space = 2048

[web]
    bind to = 0.0.0.0:19999
    allow connections from = localhost 192.168.* 10.*
EOFNETDATA
    
    systemctl restart netdata
    
    echo "âœ… Netdata beschikbaar op http://$(hostname -I | awk '{print $1}'):19999"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# UPTIME KUMA - Uptime monitoring
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_UPTIME_KUMA" == "true" ]; then
    echo "â±ï¸  Uptime Kuma installeren..."
    
    # Install Node.js
    curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
    apt install -y nodejs
    
    # Install Uptime Kuma
    mkdir -p /opt/uptime-kuma
    cd /opt/uptime-kuma
    
    git clone https://github.com/louislam/uptime-kuma.git .
    npm run setup
    
    # Systemd service
    cat > /etc/systemd/system/uptime-kuma.service << 'EOFSERVICE'
[Unit]
Description=Uptime Kuma
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/uptime-kuma
ExecStart=/usr/bin/npm run start-server
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOFSERVICE
    
    systemctl daemon-reload
    systemctl enable uptime-kuma
    systemctl start uptime-kuma
    
    echo "âœ… Uptime Kuma beschikbaar op http://$(hostname -I | awk '{print $1}'):${UPTIME_KUMA_PORT:-3001}"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PROMETHEUS + GRAFANA (Optional Advanced Monitoring)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

cat > /root/monitoring-stack.yml << 'EOFDOCKER'
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus:/etc/prometheus
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
    ports:
      - 9090:9090
    restart: unless-stopped

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - grafana_data:/var/lib/grafana
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    ports:
      - 3000:3000
    restart: unless-stopped
    depends_on:
      - prometheus

  node-exporter:
    image: prom/node-exporter:latest
    container_name: node-exporter
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    ports:
      - 9100:9100
    restart: unless-stopped

volumes:
  prometheus_data:
  grafana_data:
EOFDOCKER

echo "âœ… Monitoring stack geÃ¯nstalleerd!"
echo ""
echo "Start Prometheus + Grafana met:"
echo "  cd /root && docker-compose -f monitoring-stack.yml up -d"
ğŸ”’ SECURITY SCRIPT
scripts/10-security.sh
Bash

#!/bin/bash
###############################################################################
# Security Hardening
###############################################################################

source config.env

echo "ğŸ”’ Security hardening..."

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# UFW FIREWALL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$ENABLE_UFW" == "true" ]; then
    echo "ğŸ”¥ UFW Firewall configureren..."
    
    ufw --force reset
    ufw default deny incoming
    ufw default allow outgoing
    
    # SSH
    ufw allow ${SSH_PORT:-22}/tcp
    
    # HTTP/HTTPS (voor panel)
    ufw allow 80/tcp
    ufw allow 443/tcp
    
    # Pterodactyl Wings
    ufw allow ${WINGS_PORT:-8080}/tcp
    
    # Game server ports
    ufw allow 7777:7800/tcp    # ARK
    ufw allow 7777:7800/udp
    ufw allow 25000:25100/tcp  # Minecraft
    ufw allow 25000:25100/udp
    ufw allow 27000:27100/tcp  # CS:GO/CS2
    ufw allow 27000:27100/udp
    ufw allow 28000:28100/tcp  # Rust
    ufw allow 28000:28100/udp
    ufw allow 30120:30130/tcp  # FiveM
    ufw allow 30120:30130/udp
    ufw allow 8211:8220/tcp    # Palworld
    ufw allow 8211:8220/udp
    
    # Monitoring
    ufw allow 19999/tcp        # Netdata
    ufw allow 3001/tcp         # Uptime Kuma
    
    ufw --force enable
    
    echo "âœ… Firewall geconfigureerd"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FAIL2BAN
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_FAIL2BAN" == "true" ]; then
    echo "ğŸ›¡ï¸  Fail2Ban configureren..."
    
    apt install -y fail2ban
    
    # SSH jail
    cat > /etc/fail2ban/jail.local << 'EOFF2B'
[DEFAULT]
bantime = 3600
findtime = 600
maxretry = 5
destemail = root@localhost
sendername = Fail2Ban

[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s

[pterodactyl]
enabled = true
port = http,https
logpath = /var/log/nginx/pterodactyl.app-error.log
maxretry = 3
EOFF2B
    
    systemctl enable fail2ban
    systemctl restart fail2ban
    
    echo "âœ… Fail2Ban actief"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SSH HARDENING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ” SSH hardening..."

# Backup original
cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup

# Apply hardening
sed -i 's/#PermitRootLogin yes/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
sed -i 's/#PubkeyAuthentication yes/PubkeyAuthentication yes/' /etc/ssh/sshd_config
sed -i 's/X11Forwarding yes/X11Forwarding no/' /etc/ssh/sshd_config

# Change SSH port if specified
if [ -n "$SSH_PORT" ] && [ "$SSH_PORT" != "22" ]; then
    sed -i "s/#Port 22/Port $SSH_PORT/" /etc/ssh/sshd_config
    echo "âš ï¸  SSH port gewijzigd naar $SSH_PORT"
fi

systemctl restart sshd

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AUTOMATIC UPDATES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

apt install -y unattended-upgrades

cat > /etc/apt/apt.conf.d/50unattended-upgrades << 'EOFUPGRADES'
Unattended-Upgrade::Allowed-Origins {
    "${distro_id}:${distro_codename}-security";
    "${distro_id}ESMApps:${distro_codename}-apps-security";
    "${distro_id}ESM:${distro_codename}-infra-security";
};

Unattended-Upgrade::AutoFixInterruptedDpkg "true";
Unattended-Upgrade::MinimalSteps "true";
Unattended-Upgrade::Remove-Unused-Kernel-Packages "true";
Unattended-Upgrade::Remove-Unused-Dependencies "true";
Unattended-Upgrade::Automatic-Reboot "false";
EOFUPGRADES

echo "âœ… Security hardening compleet!"
ğŸ’¾ BACKUP SCRIPT
scripts/11-backup.sh
Bash

#!/bin/bash
###############################################################################
# Automated Backup System
###############################################################################

source config.env

if [ "$BACKUP_ENABLED" != "true" ]; then
    echo "â­ï¸  Backup systeem overgeslagen"
    exit 0
fi

echo "ğŸ’¾ Backup systeem configureren..."

# Install restic
apt install -y restic

BACKUP_DEST="${BACKUP_DESTINATION:-/backup}"
mkdir -p $BACKUP_DEST

# Backup script
cat > /usr/local/bin/gameserver-backup.sh << 'EOFBACKUP'
#!/bin/bash
###############################################################################
# GameServer Backup Script
###############################################################################

BACKUP_DIR="/backup"
DATE=$(date +%Y%m%d-%H%M%S)
LOG_FILE="/var/log/gameserver-backup.log"

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a $LOG_FILE
}

log "ğŸ”„ Starting backup..."

# Backup Pterodactyl
log "ğŸ“¦ Backing up Pterodactyl..."
tar -czf $BACKUP_DIR/pterodactyl-$DATE.tar.gz \
    /var/www/pterodactyl \
    /etc/pterodactyl \
    /var/lib/pterodactyl 2>> $LOG_FILE

# Backup databases
log "ğŸ—„ï¸  Backing up databases..."
mysqldump --all-databases | gzip > $BACKUP_DIR/databases-$DATE.sql.gz

# Backup game servers
for game in minecraft fivem rust ark palworld csgo; do
    if [ -d "/home/$game" ]; then
        log "ğŸ® Backing up $game..."
        tar -czf $BACKUP_DIR/$game-$DATE.tar.gz /home/$game 2>> $LOG_FILE
    fi
done

# Cleanup old backups
log "ğŸ§¹ Cleaning up old backups..."
find $BACKUP_DIR -name "*.tar.gz" -mtime +${BACKUP_RETENTION_DAYS:-7} -delete
find $BACKUP_DIR -name "*.sql.gz" -mtime +${BACKUP_RETENTION_DAYS:-7} -delete

log "âœ… Backup complete!"
EOFBACKUP

chmod +x /usr/local/bin/gameserver-backup.sh

# Cron job (daily at 3 AM)
(crontab -l 2>/dev/null; echo "0 3 * * * /usr/local/bin/gameserver-backup.sh") | crontab -

echo "âœ… Backup systeem geconfigureerd"
echo "  â†’ Backup directory: $BACKUP_DEST"
echo "  â†’ Retention: ${BACKUP_RETENTION_DAYS:-7} dagen"
echo "  â†’ Schedule: Daily 3:00 AM"
echo ""
echo "Manual backup: /usr/local/bin/gameserver-backup.sh"
ğŸ› ï¸ UTILITY SCRIPTS
utils/system-check.sh
Bash

#!/bin/bash
###############################################################################
# System Health Check
###############################################################################

echo "ğŸ” GameServer System Check"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# System info
echo ""
echo "ğŸ“Š SYSTEEM INFORMATIE:"
echo "  Hostname: $(hostname)"
echo "  OS: $(lsb_release -d | cut -f2)"
echo "  Kernel: $(uname -r)"
echo "  Uptime: $(uptime -p)"

# CPU
echo ""
echo "ğŸ’» CPU:"
echo "  Model: $(lscpu | grep 'Model name' | cut -d: -f2 | xargs)"
echo "  Cores: $(nproc)"
echo "  Load: $(uptime | awk -F'load average:' '{print $2}')"

# Memory
echo ""
echo "ğŸ’¾ GEHEUGEN:"
free -h | grep -E '^Mem|^Swap'

# Disk
echo ""
echo "ğŸ’¿ SCHIJFRUIMTE:"
df -h | grep -E '^/dev|^Filesystem'

# Network
echo ""
echo "ğŸŒ NETWERK:"
ip -4 addr show | grep inet | awk '{print "  "$2" - "$NF}'

# Services
echo ""
echo "âš™ï¸  SERVICES:"
services=("docker" "pterodactyl" "wings" "nginx" "mysql" "redis" "netdata")
for service in "${services[@]}"; do
    if systemctl is-active --quiet $service 2>/dev/null; then
        echo "  âœ… $service"
    else
        echo "  âŒ $service"
    fi
done

# Game servers (check processes)
echo ""
echo "ğŸ® GAME SERVERS:"
ps aux | grep -E 'java|RustDedicated|PalServer|srcds|FXServer|ShooterGame' | grep -v grep | awk '{print "  "$11" (PID: "$2", CPU: "$3"%, MEM: "$4"%)"}'

# Docker containers
if command -v docker &> /dev/null; then
    echo ""
    echo "ğŸ³ DOCKER CONTAINERS:"
    docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}" 2>/dev/null || echo "  Geen containers actief"
fi

# Ports
echo ""
echo "ğŸ”Œ LUISTERENDE POORTEN:"
ss -tlnp | grep LISTEN | awk '{print "  "$4" - "$7}' | sort -u | head -20

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âœ… System check compleet - $(date)"
utils/update-all-games.sh
Bash

#!/bin/bash
###############################################################################
# Update All Game Servers
###############################################################################

echo "ğŸ”„ Updating all game servers..."

update_steam_game() {
    local APP_ID=$1
    local INSTALL_DIR=$2
    local GAME_NAME=$3
    
    echo "ğŸ“¥ Updating $GAME_NAME (AppID: $APP_ID)..."
    
    steamcmd +force_install_dir "$INSTALL_DIR" \
        +login anonymous \
        +app_update $APP_ID validate \
        +quit
    
    echo "âœ… $GAME_NAME updated"
}

# Rust
[ -d "/home/rust/server" ] && update_steam_game 258550 "/home/rust/server" "Rust"

# ARK
[ -d "/home/ark/arkse" ] && update_steam_game 376030 "/home/ark/arkse" "ARK: SE"
[ -d "/home/ark/arksa" ] && update_steam_game 2430930 "/home/ark/arksa" "ARK: SA"

# CS2
[ -d "/home/csgo/cs2" ] && update_steam_game 730 "/home/csgo/cs2" "CS2"

# CS:GO
[ -d "/home/csgo/csgo" ] && update_steam_game 740 "/home/csgo/csgo" "CS:GO"

# Palworld
[ -d "/home/palworld/server" ] && update_steam_game 2394010 "/home/palworld/server" "Palworld"

# Minecraft Paper (check for updates)
if [ -d "/home/minecraft/paper" ]; then
    echo "ğŸ“¥ Checking Minecraft Paper updates..."
    # Add Paper update logic here
fi

# FiveM
if [ -d "/home/fivem/server" ]; then
    echo "ğŸ“¥ Updating FiveM..."
    cd /home/fivem/server
    
    ARTIFACT_URL=$(curl -s https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/ | \
        grep -Eo 'href="[0-9]+-[a-f0-9]+/fx\.tar\.xz"' | \
        tail -1 | \
        sed 's/href="//;s/"//')
    
    wget "https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/$ARTIFACT_URL" -O fx.tar.xz
    tar xf fx.tar.xz
    rm fx.tar.xz
    
    echo "âœ… FiveM updated"
fi

echo "âœ… All game servers updated!"
echo ""
echo "âš ï¸  REMINDER: Restart game servers to apply updates"
ğŸ“š QUICKSTART GUIDE
QUICKSTART.md
Markdown

# ğŸš€ QUICKSTART GUIDE

## Binnen 30 minuten live!

### âœ… PRE-INSTALLATIE CHECKLIST

- [ ] Ubuntu 22.04 LTS geÃ¯nstalleerd
- [ ] Root toegang (of sudo)
- [ ] Internet connectie
- [ ] Domein naam (voor panel) + DNS A records
- [ ] Minimaal 20GB vrije schijfruimte

### ğŸ“¥ STAP 1: DOWNLOAD SETUP

```bash
# Via Git
git clone https://github.com/jouw-repo/gameserver-setup.git
cd gameserver-setup

# Of via wget
wget https://github.com/.../gameserver-setup.tar.gz
tar -xzf gameserver-setup.tar.gz
cd gameserver-setup
âš™ï¸ STAP 2: CONFIGURATIE
Bash

# Kopieer config template
cp config.env.example config.env

# Bewerk configuratie
nano config.env
Minimaal aanpassen:

PANEL_FQDN â†’ jouw domein (bijv: panel.example.com)
PANEL_ADMIN_EMAIL â†’ jouw email
WINGS_FQDN â†’ node domein (bijv: node1.example.com)
NODE_IP â†’ server IP adres
ğŸš€ STAP 3: INSTALLATIE
Bash

# Maak executable
chmod +x install.sh

# Start installatie
sudo ./install.sh
Selecteer optie 1 voor volledige installatie.

â˜• Ga koffie halen (duurt 15-45 minuten afhankelijk van internet snelheid)

ğŸ¯ STAP 4: POST-INSTALLATIE
Panel Setup:
Browse naar https://jouw-panel-domein.com
Login met admin credentials
Ga naar Admin â†’ Nodes â†’ Create Node
Kopieer de auto-deploy command
Voer command uit op je server
Start Wings: systemctl start wings
Game Servers Toevoegen:
Import eggs uit /root/gameserver-setup/eggs/
Maak een server aan via het panel
Start de server
Done! ğŸ‰
ğŸ“Š MONITORING
Netdata: http://jouw-ip:19999
Uptime Kuma: http://jouw-ip:3001
Pterodactyl: https://jouw-panel-domein.com
ğŸ†˜ PROBLEMEN?
Bash

# Check systeem status
./utils/system-check.sh

# Bekijk logs
tail -f /var/log/gameserver-setup/install-*.log

# Check services
systemctl status pterodactyl wings docker
ğŸ“– VOLLEDIGE DOCS
Zie /docs/ voor gedetailleerde documentatie.

Support: [Discord/Email]
Updates: git pull in setup directory

text


---

## ğŸ‰ **FINAL TOUCHES**

### **README.md** (hoofd readme)

```markdown
# ğŸ® GameServer Automated Setup

**Volledige geautomatiseerde setup voor professionele gameserver hosting.**

Deploy binnen 30 minuten een complete gameserver infrastructuur met:
- âœ… Pterodactyl Panel & Wings
- âœ… 6 populaire games (Minecraft, FiveM, Rust, CS2, ARK, Palworld)
- âœ… Complete monitoring stack
- âœ… Automated backups
- âœ… Security hardening
- âœ… Production-ready configuratie

## ğŸ“‹ Ondersteunde Games

| Game | Versies | Resource Use | Players |
|------|---------|--------------|---------|
| **Minecraft** | Paper, Fabric, Forge | Laag-Hoog | 20-200+ |
| **FiveM** | Latest + ESX | Hoog | 32-256 |
| **Rust** | Latest + uMod | Zeer Hoog | 50-200 |
| **CS2/CS:GO** | Latest + SourceMod | Middel | 10-64 |
| **ARK** | SE + Ascended | Zeer Hoog | 20-70 |
| **Palworld** | Latest | Middel | 8-32 |

## ğŸš€ Quick Start

```bash
git clone https://github.com/jouw-repo/gameserver-setup.git
cd gameserver-setup
cp config.env.example config.env
nano config.env  # Pas aan
sudo ./install.sh
Volledige guide: QUICKSTART.md

ğŸ’» Systeem Vereisten
OS: Ubuntu 22.04 LTS
RAM: Minimum 8GB (aanbevolen 16GB+)
CPU: Minimum 4 cores (aanbevolen 8+)
Disk: Minimum 50GB SSD
Network: 100+ Mbps
Perfect voor:

MS-01 servers (Intel i9-12900H, 32GB RAM)
Hetzner Dedicated
OVH Game servers
Eigen hardware
ğŸ“¦ Wat wordt geÃ¯nstalleerd?
Core Infrastructure:
Docker + Docker Compose
Pterodactyl Panel (latest)
Pterodactyl Wings (latest)
MySQL/MariaDB
Redis
Nginx
Game Servers:
SteamCMD
Java (8, 17, 21)
Game-specific frameworks
Monitoring:
Netdata
Uptime Kuma
Prometheus + Grafana (optioneel)
Security:
UFW Firewall
Fail2Ban
SSH Hardening
Automatic security updates
Automation:
Automated backups
Update scripts
Health monitoring
ğŸ“Š Capacity Planning
Example: 5Ã— MS-01 Nodes (i9-12900H, 32GB RAM)

Node	Allocation	Servers
Node 1	ARK Cluster	3-4 servers
Node 2	Rust + ARK	2-3 servers
Node 3	FiveM	5-6 servers
Node 4	Minecraft	10-15 servers
Node 5	CS2 + Light	15-20 servers
Total: ~40-50 quality game servers

ğŸ› ï¸ Management
Bash

# System check
./utils/system-check.sh

# Update all games
./utils/update-all-games.sh

# Manual backup
/usr/local/bin/gameserver-backup.sh

# Health monitor
./utils/health-monitor.sh
ğŸ“– Documentation
Installation Guide
Configuration Reference
Troubleshooting
Performance Tuning
Security Best Practices
ğŸ¤ Contributing
Contributions welcome! Please read CONTRIBUTING.md

ğŸ“„ License
MIT License - See LICENSE

ğŸ†˜ Support
Discord: [Link]
Email: support@example.com
Issues: GitHub Issues
â­ Credits
Created for MS-01 cluster deployments.

Powered by:

Pterodactyl
Netdata
Uptime Kuma
Made with â¤ï¸ for the gaming community

text


---

## ğŸ **BONUS: WEB DASHBOARD**

### **web/index.html** (Simple status dashboard)

```html
<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameServer Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card h2 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }
        .status.offline { background: #ef4444; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .stat {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        .btn {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            text-decoration: none;
            color: #fff;
            transition: background 0.3s;
        }
        .btn:hover {
            background: rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® GameServer Dashboard</h1>
        
        <div class="grid">
            <div class="card">
                <h2><span class="status"></span> System Status</h2>
                <div class="stat">
                    <span>CPU Usage</span>
                    <strong id="cpu">Loading...</strong>
                </div>
                <div class="stat">
                    <span>RAM Usage</span>
                    <strong id="ram">Loading...</strong>
                </div>
                <div class="stat">
                    <span>Disk Usage</span>
                    <strong id="disk">Loading...</strong>
                </div>
                <a href="http://your-ip:19999" class="btn" target="_blank">ğŸ“Š Netdata</a>
            </div>

            <div class="card">
                <h2><span class="status"></span> Active Servers</h2>
                <div class="stat">
                    <span>Minecraft</span>
                    <strong id="minecraft">0</strong>
                </div>
                <div class="stat">
                    <span>FiveM</span>
                    <strong id="fivem">0</strong>
                </div>
                <div class="stat">
                    <span>Rust</span>
                    <strong id="rust">0</strong>
                </div>
                <div class="stat">
                    <span>CS2</span>
                    <strong id="cs2">0</strong>
                </div>
                <a href="https://your-panel.com" class="btn" target="_blank">ğŸ›ï¸ Panel</a>
            </div>

            <div class="card">
                <h2><span class="status"></span> Quick Links</h2>
                <a href="http://your-ip:3001" class="btn" target="_blank">â±ï¸ Uptime Monitor</a>
                <a href="http://your-ip:3000" class="btn" target="_blank">ğŸ“ˆ Grafana</a>
                <a href="http://your-ip:9090" class="btn" target="_blank">ğŸ” Prometheus</a>
                <a href="/docs" class="btn" target="_blank">ğŸ“š Documentation</a>
            </div>
        </div>
    </div>

    <script>
        // Simple stats fetcher (extend with your API)
        async function updateStats() {
            // Placeholder - integrate with your monitoring API
            document.getElementById('cpu').textContent = '45%';
            document.getElementById('ram').textContent = '18GB / 32GB';
            document.getElementById('disk').textContent = '234GB / 1TB';
            
            document.getElementById('minecraft').textContent = '12 online';
            document.getElementById('fivem').textContent = '5 online';
            document.getElementById('rust').textContent = '3 online';
            document.getElementById('cs2').textContent = '8 online';
        }
        
        updateStats();
        setInterval(updateStats, 30000); // Update every 30s
    </script>
</body>
</html>
ğŸ“¦ ALLES IN 1 DOWNLOAD PAKKET
Bash

# Maak distributable package
cat > create-package.sh << 'EOFPKG'
#!/bin/bash

echo "ğŸ“¦ Creating distributable package..."

mkdir -p gameserver-setup-dist
cd gameserver-setup-dist

# Copy all files
cp -r ../scripts .
cp -r ../eggs .
cp -r ../configs .
cp -r ../utils .
cp -r ../docker .
cp -r ../web .
cp -r ../docs .
cp ../install.sh .
cp ../config.env.example .
cp ../README.md .
cp ../QUICKSTART.md .
cp ../LICENSE .

# Create archive
cd ..
tar -czf gameserver-setup-v1.0.tar.gz gameserver-setup-dist/

echo "âœ… Package created: gameserver-setup-v1.0.tar.gz"
echo "ğŸ“¤ Upload to GitHub Releases"
EOFPKG

chmod +x create-package.sh
ğŸŠ FINALE - JE HEBT NU:
âœ… Complete geautomatiseerde installatie voor alle games
âœ… Pterodactyl Panel & Wings setup
âœ… 6 game servers kant-en-klaar (Minecraft, FiveM, Rust, CS2, ARK, Palworld)
âœ… Monitoring stack (Netdata, Uptime Kuma, Grafana)
âœ… Security hardening (UFW, Fail2Ban, SSH)
âœ… Automated backups systeem
âœ… Management utilities (health check, updates, etc.)
âœ… Complete documentatie
âœ… Web dashboard bonus
âœ… Production-ready configuraties

ğŸš€ VOLGENDE STAP:
Bash

# Clone alles naar je server
git clone [jouw-repo-url]
cd gameserver-setup

# Pas config aan
cp config.env.example config.env
nano config.env

# GO TIME! ğŸ”¥
sudo ./install.sh
Binnen 30-45 minuten heb je een volledige gameserver hosting platform draaiend!

Wil je nog iets toegevoegd hebben? Of zal ik een GitHub repository structure maken zodat je dit direct kan uploaden en delen? ğŸ¯





volledig geautomatiseerde setup van A-Z? ğŸ’ª

claude-sonnet-4-5-20250929-thinking-32k

Thought for 2 seconds

ğŸ¦– ARK SURVIVAL - COMPLETE SETUP
Je hebt gelijk! ARK hoort erbij. Laten we ARK toevoegen aan de setup.

ğŸ“ UPDATE: config.env
Voeg toe aan config.env:

Bash

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ARK SURVIVAL CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ARK Survival Evolved (Legacy)
INSTALL_ARK_SE=true
ARK_SE_MAPS="TheIsland,TheCenter,Ragnarok,Valguero,CrystalIsles"

# ARK Survival Ascended (UE5 versie)
INSTALL_ARK_SA=true

# Cluster configuratie (voor cross-server transfers)
ARK_ENABLE_CLUSTER=true
ARK_CLUSTER_ID="MyCluster"
ğŸ® SCRIPT: ARK INSTALLATIE
scripts/08-games-ark.sh
Bash

#!/bin/bash
###############################################################################
# ARK Survival Evolved & Ascended Installatie
###############################################################################

source config.env

echo "ğŸ¦– ARK Survival installatie gestart..."

# ARK user aanmaken
if ! id "ark" &>/dev/null; then
    useradd -m -s /bin/bash ark
    echo "âœ… Gebruiker 'ark' aangemaakt"
fi

# Dependencies
echo "ğŸ“¦ ARK dependencies installeren..."
apt install -y \
    lib32gcc-s1 \
    lib32stdc++6 \
    libsdl2-2.0-0:i386 \
    libcurl4:i386 \
    perl-modules \
    lsof \
    libc6-i386 \
    lib32z1 \
    bzip2

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ARK: SURVIVAL EVOLVED (Legacy)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_ARK_SE" == "true" ]; then
    echo "ğŸ“¥ ARK: Survival Evolved installeren..."
    
    # Base directory
    ARK_SE_DIR="/home/ark/arkse"
    mkdir -p $ARK_SE_DIR
    
    # Download via SteamCMD
    sudo -u ark steamcmd +force_install_dir $ARK_SE_DIR \
        +login anonymous \
        +app_update 376030 validate \
        +quit
    
    # Cluster directory (voor transfers tussen servers)
    if [ "$ARK_ENABLE_CLUSTER" == "true" ]; then
        mkdir -p /home/ark/cluster/$ARK_CLUSTER_ID
        chown -R ark:ark /home/ark/cluster
        echo "âœ… Cluster directory aangemaakt: /home/ark/cluster/$ARK_CLUSTER_ID"
    fi
    
    # Startup script template
    cat > $ARK_SE_DIR/start.sh << 'EOFSTART'
#!/bin/bash
###############################################################################
# ARK: Survival Evolved - Server Startup Script
###############################################################################

# Configuratie variabelen (pas aan per server)
MAP="${MAP:-TheIsland}"
SERVER_NAME="${SERVER_NAME:-ARK Server}"
SERVER_PASSWORD="${SERVER_PASSWORD:-}"
ADMIN_PASSWORD="${ADMIN_PASSWORD:-AdminPass123}"
MAX_PLAYERS="${MAX_PLAYERS:-70}"
CLUSTER_ID="${CLUSTER_ID:-}"
MODS="${MODS:-}"

# Query port (voor Steam server browser)
QUERY_PORT="${QUERY_PORT:-27015}"
# Game port
GAME_PORT="${GAME_PORT:-7777}"
# RCON port
RCON_PORT="${RCON_PORT:-27020}"

# Paths
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"
CLUSTER_DIR="/home/ark/cluster/$CLUSTER_ID"

# Build startup command
START_CMD="$SCRIPT_DIR/ShooterGame/Binaries/Linux/ShooterGameServer"
START_CMD="$START_CMD ${MAP}?listen"
START_CMD="$START_CMD?SessionName=\"${SERVER_NAME}\""
START_CMD="$START_CMD?MaxPlayers=${MAX_PLAYERS}"
START_CMD="$START_CMD?ServerPassword=${SERVER_PASSWORD}"
START_CMD="$START_CMD?ServerAdminPassword=${ADMIN_PASSWORD}"
START_CMD="$START_CMD?Port=${GAME_PORT}"
START_CMD="$START_CMD?QueryPort=${QUERY_PORT}"
START_CMD="$START_CMD?RCONEnabled=True"
START_CMD="$START_CMD?RCONPort=${RCON_PORT}"

# Cluster settings
if [ -n "$CLUSTER_ID" ]; then
    START_CMD="$START_CMD?ClusterDirOverride=${CLUSTER_DIR}"
    START_CMD="$START_CMD?clusterid=${CLUSTER_ID}"
fi

# Mods
if [ -n "$MODS" ]; then
    START_CMD="$START_CMD -mods=${MODS}"
fi

# Additional parameters
START_CMD="$START_CMD -server -log -NoBattlEye"

echo "ğŸš€ Starting ARK: Survival Evolved..."
echo "Map: $MAP"
echo "Port: $GAME_PORT"
echo "Query Port: $QUERY_PORT"
echo ""

# Start server
cd $SCRIPT_DIR
exec $START_CMD
EOFSTART

    chmod +x $ARK_SE_DIR/start.sh
    chown -R ark:ark $ARK_SE_DIR
    
    echo "âœ… ARK: Survival Evolved geÃ¯nstalleerd in $ARK_SE_DIR"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ARK: SURVIVAL ASCENDED (UE5)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if [ "$INSTALL_ARK_SA" == "true" ]; then
    echo "ğŸ“¥ ARK: Survival Ascended installeren..."
    
    ARK_SA_DIR="/home/ark/arksa"
    mkdir -p $ARK_SA_DIR
    
    # ASA heeft andere AppID
    sudo -u ark steamcmd +force_install_dir $ARK_SA_DIR \
        +login anonymous \
        +app_update 2430930 validate \
        +quit
    
    # Startup script voor ASA
    cat > $ARK_SA_DIR/start.sh << 'EOFASA'
#!/bin/bash
###############################################################################
# ARK: Survival Ascended - Server Startup Script
###############################################################################

# Configuratie
MAP="${MAP:-TheIsland_WP}"
SERVER_NAME="${SERVER_NAME:-ARK Ascended Server}"
ADMIN_PASSWORD="${ADMIN_PASSWORD:-AdminPass123}"
MAX_PLAYERS="${MAX_PLAYERS:-70}"
GAME_PORT="${GAME_PORT:-7777}"
QUERY_PORT="${QUERY_PORT:-27015}"

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

# Start command (ASA syntax verschilt van SE)
START_CMD="$SCRIPT_DIR/ShooterGame/Binaries/Linux/ArkAscendedServer"
START_CMD="$START_CMD ${MAP}?listen"
START_CMD="$START_CMD?SessionName=\"${SERVER_NAME}\""
START_CMD="$START_CMD?Port=${GAME_PORT}"
START_CMD="$START_CMD?QueryPort=${QUERY_PORT}"
START_CMD="$START_CMD?MaxPlayers=${MAX_PLAYERS}"
START_CMD="$START_CMD?ServerAdminPassword=${ADMIN_PASSWORD}"
START_CMD="$START_CMD -WinLiveMaxPlayers=${MAX_PLAYERS}"
START_CMD="$START_CMD -server -log"

echo "ğŸš€ Starting ARK: Survival Ascended..."
echo "Map: $MAP"
echo "Port: $GAME_PORT"
echo ""

cd $SCRIPT_DIR
exec $START_CMD
EOFASA

    chmod +x $ARK_SA_DIR/start.sh
    chown -R ark:ark $ARK_SA_DIR
    
    echo "âœ… ARK: Survival Ascended geÃ¯nstalleerd in $ARK_SA_DIR"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CONFIGURATIE TEMPLATES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "âš™ï¸  Configuratie templates aanmaken..."

# GameUserSettings.ini template
mkdir -p /home/ark/configs
cat > /home/ark/configs/GameUserSettings.ini.example << 'EOFCONFIG'
[ServerSettings]
ServerPassword=
ServerAdminPassword=ChangeMe123
ServerCrosshair=True
RCONEnabled=True
RCONPort=27020
TheMaxStructuresInRange=10500
MaxPlayers=70

# XP Multipliers
XPMultiplier=1.5
OverrideOfficialDifficulty=5.0

# Gathering Rates
HarvestAmountMultiplier=2.5
HarvestHealthMultiplier=2.0
ResourcesRespawnPeriodMultiplier=0.5

# Taming
TamingSpeedMultiplier=3.0
DinoCharacterFoodDrainMultiplier=1.5
WildDinoCharacterFoodDrainMultiplier=1.0
WildDinoTorporDrainMultiplier=1.0

# Breeding
MatingIntervalMultiplier=0.5
EggHatchSpeedMultiplier=5.0
BabyMatureSpeedMultiplier=5.0
BabyImprintingStatScaleMultiplier=2.0
BabyCuddleIntervalMultiplier=0.2
BabyCuddleGracePeriodMultiplier=2.0
BabyCuddleLoseImprintQualitySpeedMultiplier=0.5

# Player Stats
PlayerCharacterWaterDrainMultiplier=0.8
PlayerCharacterFoodDrainMultiplier=0.8
PlayerCharacterStaminaDrainMultiplier=0.8
PlayerCharacterHealthRecoveryMultiplier=1.5

# Dino Stats
DinoCharacterStaminaDrainMultiplier=1.0
DinoCharacterHealthRecoveryMultiplier=1.5

# Platform Saddles
MaxPlatformSaddleStructureLimit=100

# Misc
DayCycleSpeedScale=1.0
NightTimeSpeedScale=1.5
DayTimeSpeedScale=1.0
DinoDamageMultiplier=1.0
PlayerDamageMultiplier=1.0
StructureDamageMultiplier=1.0
PlayerResistanceMultiplier=1.0
DinoResistanceMultiplier=1.0
PvEStructureDecayPeriodMultiplier=1.0
AllowFlyerCarryPvE=True
DisableStructureDecayPvE=False
AllowAnyoneBabyImprintCuddle=True
ShowMapPlayerLocation=True
EnablePvPGamma=False
DisablePvEGamma=False
AllowThirdPersonPlayer=True
ShowFloatingDamageText=True
PreventDownloadSurvivors=False
PreventDownloadItems=False
PreventDownloadDinos=False
PreventUploadSurvivors=False
PreventUploadItems=False
PreventUploadDinos=False

# Cluster Settings (uncomment voor cluster)
# ClusterDirOverride=/path/to/cluster
# NoTransferFromFiltering=False

[/Script/ShooterGame.ShooterGameMode]
bDisableStructurePlacementCollision=False
bAllowUnlimitedRespecs=True
bDisableFriendlyFire=True

[SessionSettings]
SessionName=ARK Server

[RagnarokOptions]

[ScalabilityGroups]

[MessageOfTheDay]
Message=Welcome to the server!
Duration=30
EOFCONFIG

chown ark:ark /home/ark/configs/GameUserSettings.ini.example

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PTERODACTYL EGG VOOR ARK
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo "ğŸ¥š Pterodactyl Egg configureren..."

mkdir -p /root/gameserver-setup/eggs

cat > /root/gameserver-setup/eggs/egg-ark-survival-evolved.json << 'EOFEGG'
{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2024-01-01T00:00:00+00:00",
    "name": "ARK: Survival Evolved",
    "author": "gameserver-setup@custom",
    "description": "ARK: Survival Evolved game server",
    "features": [
        "steam_disk_space"
    ],
    "docker_images": {
        "ghcr.io\/parkervcp\/steamcmd:debian": "ghcr.io\/parkervcp\/steamcmd:debian"
    },
    "file_denylist": [],
    "startup": "\/home\/container\/ShooterGame\/Binaries\/Linux\/ShooterGameServer {{MAP}}?listen?SessionName=\"{{SESSION_NAME}}\"?Port={{SERVER_PORT}}?QueryPort={{QUERY_PORT}}?RCONEnabled=True?RCONPort={{RCON_PORT}}?MaxPlayers={{MAX_PLAYERS}}?ServerPassword={{SERVER_PASSWORD}}?ServerAdminPassword={{ADMIN_PASSWORD}} {{ADDITIONAL_ARGS}} -server -log -NoBattlEye",
    "config": {
        "files": "{}",
        "startup": "{\r\n    \"done\": \"Setting breakpad minidump AppID\"\r\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\n\r\napt update\r\napt install -y curl lib32gcc-s1\r\n\r\ncd \/tmp\r\ncurl -sSL -o steamcmd.tar.gz https:\/\/steamcdn-a.akamaihd.net\/client\/installer\/steamcmd_linux.tar.gz\r\nmkdir -p \/mnt\/server\/steamcmd\r\ntar -xzvf steamcmd.tar.gz -C \/mnt\/server\/steamcmd\r\ncd \/mnt\/server\/steamcmd\r\n\r\nchown -R root:root \/mnt\r\nexport HOME=\/mnt\/server\r\n\r\n.\/steamcmd.sh +force_install_dir \/mnt\/server +login anonymous +app_update 376030 validate +quit\r\n\r\nmkdir -p \/mnt\/server\/ShooterGame\/Saved\/Config\/LinuxServer",
            "container": "ghcr.io\/parkervcp\/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "Map",
            "description": "Available Maps: TheIsland, TheCenter, Ragnarok, Valguero, CrystalIsles, ScorchedEarth_P, Aberration_P, Extinction, Genesis, Gen2",
            "env_variable": "MAP",
            "default_value": "TheIsland",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string",
            "field_type": "text"
        },
        {
            "name": "Session Name",
            "description": "Server name shown in browser",
            "env_variable": "SESSION_NAME",
            "default_value": "ARK Server",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:128",
            "field_type": "text"
        },
        {
            "name": "Server Password",
            "description": "Password to join server (leave empty for none)",
            "env_variable": "SERVER_PASSWORD",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "nullable|string",
            "field_type": "text"
        },
        {
            "name": "Admin Password",
            "description": "Admin password for RCON",
            "env_variable": "ADMIN_PASSWORD",
            "default_value": "ChangeMe123",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string",
            "field_type": "text"
        },
        {
            "name": "Max Players",
            "description": "Maximum number of players",
            "env_variable": "MAX_PLAYERS",
            "default_value": "70",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1,255",
            "field_type": "text"
        },
        {
            "name": "Query Port",
            "description": "Query port for Steam server browser",
            "env_variable": "QUERY_PORT",
            "default_value": "27015",
            "user_viewable": true,
            "user_editable": false,
            "rules": "required|integer",
            "field_type": "text"
        },
        {
            "name": "RCON Port",
            "description": "RCON port",
            "env_variable": "RCON_PORT",
            "default_value": "27020",
            "user_viewable": true,
            "user_editable": false,
            "rules": "required|integer",
            "field_type": "text"
        },
        {
            "name": "Additional Arguments",
            "description": "Additional startup arguments",
            "env_variable": "ADDITIONAL_ARGS",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "nullable|string",
            "field_type": "text"
        }
    ]
}
EOFEGG

echo "âœ… ARK Survival installatie compleet!"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“‹ INSTALLATIE SAMENVATTING"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
[ "$INSTALL_ARK_SE" == "true" ] && echo "âœ… ARK: Survival Evolved â†’ $ARK_SE_DIR"
[ "$INSTALL_ARK_SA" == "true" ] && echo "âœ… ARK: Survival Ascended â†’ $ARK_SA_DIR"
[ "$ARK_ENABLE_CLUSTER" == "true" ] && echo "âœ… Cluster Directory â†’ /home/ark/cluster/$ARK_CLUSTER_ID"
echo "âœ… Config Template â†’ /home/ark/configs/GameUserSettings.ini.example"
echo "âœ… Pterodactyl Egg â†’ /root/gameserver-setup/eggs/egg-ark-survival-evolved.json"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ¯ VOLGENDE STAPPEN"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "1. Import het ARK egg in Pterodactyl Panel:"
echo "   Admin â†’ Nests â†’ Create New â†’ Import Egg â†’ Upload JSON"
echo ""
echo "2. Aanbevolen server specs per ARK instance:"
echo "   - RAM: 8-12GB (minimum 6GB)"
echo "   - CPU: 3-4 cores"
echo "   - Disk: 30-50GB"
echo "   - Network: 100+ Mbps"
echo ""
echo "3. Voor een server cluster setup:"
echo "   - Gebruik dezelfde CLUSTER_ID voor alle servers"
echo "   - Mount /home/ark/cluster als shared volume"
echo "   - Enable transfers in GameUserSettings.ini"
echo ""
echo "4. Populaire mods (via Workshop):"
echo "   - Structures Plus (S+): 731604991"
echo "   - Awesome Spyglass: 1404697612"
echo "   - Classic Flyers: 895711211"
echo ""
echo "5. Performance tips:"
echo "   - Pre-generate world: DestroyWildDinos command"
echo "   - Regular backups: ARK saves zijn 1-3GB"
echo "   - Monitor RAM: ARK heeft memory leaks"
echo "   - Weekly restarts aanbevolen"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
ğŸ“Š UPDATED: RESOURCE ALLOCATIE
Aangepaste server verdeling met ARK:
text

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5Ã— MS-01 NODE SETUP MET ARK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NODE 1 (Zware Servers - ARK Focus):
â”œâ”€ 2Ã— ARK: SE servers (TheIsland + Ragnarok)  â†’ 20GB RAM
â”œâ”€ 1Ã— ARK: SA server                          â†’ 10GB RAM
â””â”€ Resources: 30GB RAM, 10 cores

NODE 2 (Zware Servers - Rust + ARK):
â”œâ”€ 2Ã— Rust servers                            â†’ 16GB RAM
â”œâ”€ 1Ã— ARK: SE server (Valguero)               â†’ 10GB RAM
â””â”€ Resources: 26GB RAM, 8 cores

NODE 3 (Premium - FiveM):
â”œâ”€ 5Ã— FiveM servers                           â†’ 30GB RAM
â””â”€ Resources: 30GB RAM, 10 cores

NODE 4 (Middelzwaar - Mixed):
â”œâ”€ 10Ã— Minecraft servers (mix)                â†’ 20GB RAM
â”œâ”€ 5Ã— Palworld servers                        â†’ 10GB RAM
â””â”€ Resources: 30GB RAM, 8 cores

NODE 5 (Licht - Community):
â”œâ”€ 10Ã— CS2/CS:GO servers                      â†’ 20GB RAM
â”œâ”€ 5Ã— Minecraft Vanilla                       â†’ 8GB RAM
â””â”€ Resources: 28GB RAM, 6 cores

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOTAAL: 
- ~35 gameservers (mixed workload)
- ARK Cluster: 4 interconnected maps
- High-quality, no overselling
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’° UPDATED: PRICING VOOR ARK
ARK Tier toevoegen:
Bash

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TIER 3: PREMIUM (High Performance) - UPDATED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Game            â”‚ RAM  â”‚ CPU  â”‚ Slots â”‚ Prijs  â”‚ Cost â”‚ Marge â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rust            â”‚ 8GB  â”‚ 4C   â”‚ 100   â”‚ â‚¬25/mo â”‚ â‚¬6.50â”‚  74%  â”‚
â”‚ ARK: SE         â”‚ 10GB â”‚ 4C   â”‚ 70    â”‚ â‚¬28/mo â”‚ â‚¬7.20â”‚  74%  â”‚
â”‚ ARK: SA         â”‚ 12GB â”‚ 5C   â”‚ 70    â”‚ â‚¬35/mo â”‚ â‚¬9.00â”‚  74%  â”‚
â”‚ FiveM           â”‚ 6GB  â”‚ 3C   â”‚ 64    â”‚ â‚¬22/mo â”‚ â‚¬5.50â”‚  75%  â”‚
â”‚ Satisfactory    â”‚ 5GB  â”‚ 3C   â”‚ 8     â”‚ â‚¬15/mo â”‚ â‚¬4.00â”‚  73%  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

SPECIAL: ARK Cluster Package
â”œâ”€ 3Ã— ARK servers (different maps)
â”œâ”€ Shared cluster (character transfer)
â”œâ”€ 25GB RAM total, 12 cores
â””â”€ â‚¬70/maand (â‚¬8 korting vs los)
ğŸ› ï¸ ARK MANAGEMENT TOOLS
Handige ARK scripts:
Bash

# /home/ark/tools/update-ark.sh
#!/bin/bash
# ARK Update Script

echo "ğŸ”„ Updating ARK servers..."

# Survival Evolved
if [ -d "/home/ark/arkse" ]; then
    echo "Updating ARK: SE..."
    steamcmd +force_install_dir /home/ark/arkse \
        +login anonymous \
        +app_update 376030 validate \
        +quit
fi

# Survival Ascended
if [ -d "/home/ark/arksa" ]; then
    echo "Updating ARK: SA..."
    steamcmd +force_install_dir /home/ark/arksa \
        +login anonymous \
        +app_update 2430930 validate \
        +quit
fi

echo "âœ… ARK updates complete"
Bash

# /home/ark/tools/backup-ark.sh
#!/bin/bash
# ARK Backup Script

BACKUP_DIR="/backup/ark"
DATE=$(date +%Y%m%d-%H%M%S)

mkdir -p $BACKUP_DIR

# Backup saves
for save in /home/ark/arkse/ShooterGame/Saved/SavedArks*; do
    if [ -d "$save" ]; then
        MAP=$(basename "$save")
        tar -czf "$BACKUP_DIR/ark-se-${MAP}-${DATE}.tar.gz" "$save"
        echo "âœ… Backed up: $MAP"
    fi
done

# Cleanup old backups (keep 7 days)
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete

echo "âœ… ARK backup complete"
Bash

# /home/ark/tools/wipe-wild-dinos.sh
#!/bin/bash
# Performance fix: destroy wild dinos

RCON_HOST="localhost"
RCON_PORT="27020"
RCON_PASS="YourAdminPassword"

# Install RCON tool if needed
if ! command -v rcon &> /dev/null; then
    wget https://github.com/gorcon/rcon-cli/releases/download/v0.10.3/rcon-0.10.3-amd64_linux.tar.gz
    tar -xzf rcon-*.tar.gz
    mv rcon /usr/local/bin/
fi

# Execute command
rcon -a ${RCON_HOST}:${RCON_PORT} -p ${RCON_PASS} "DestroyWildDinos"

echo "âœ… Wild dinos destroyed - performance should improve"
ğŸ“‹ ARK CLUSTER SETUP GUIDE
Stap-voor-stap cluster configuratie:
Bash

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ARK CLUSTER SETUP - CHARACTER & DINO TRANSFERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STAP 1: Shared Cluster Directory
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

mkdir -p /home/ark/cluster/MainCluster
chown -R ark:ark /home/ark/cluster

# Als je Pterodactyl gebruikt, mount als shared volume


STAP 2: Server Startup Parameters
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Voor ELKE server in je cluster, voeg toe:

?ClusterDirOverride=/home/ark/cluster/MainCluster
?clusterid=MainCluster
?PreventDownloadSurvivors=False
?PreventDownloadItems=False
?PreventDownloadDinos=False


STAP 3: GameUserSettings.ini
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[ServerSettings]
PreventDownloadSurvivors=False
PreventDownloadItems=False
PreventDownloadDinos=False
PreventUploadSurvivors=False
PreventUploadItems=False
PreventUploadDinos=False
NoTransferFromFiltering=False


STAP 4: Firewall (belangrijke poorten)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Server 1 (TheIsland):
  Game Port: 7777
  Query Port: 27015
  RCON: 27020

Server 2 (Ragnarok):
  Game Port: 7779
  Query Port: 27017
  RCON: 27022

Server 3 (Valguero):
  Game Port: 7781
  Query Port: 27019
  RCON: 27024


STAP 5: Test Transfers
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Join Server 1
2. Upload je character bij een Obelisk/Supply Drop
3. Disconnect
4. Join Server 2
5. Download je character bij een Obelisk
6. âœ… Success!


TROUBLESHOOTING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âŒ "Character not found"
   â†’ Check cluster directory permissions
   â†’ Verify ClusterDirOverride path matches
   â†’ Ensure clusterid is identical

âŒ "Transfer failed"
   â†’ Check NoTransferFromFiltering=False
   â†’ Verify PreventDownload settings
   â†’ Check disk space on cluster directory

âŒ "Dinos disappeared"
   â†’ Check cluster folder for .arkprofile files
   â†’ Backup cluster directory daily!
   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ® POPULAIRE ARK MODS
Top 10 Workshop Mods:
Bash

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ARK MOD IDs (Steam Workshop)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Gebruik in startup parameters: -mods=731604991,1404697612,895711211

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mod Name                       â”‚ Workshop ID â”‚ Impact       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Structures Plus (S+)           â”‚ 731604991   â”‚ Must-have    â”‚
â”‚ Awesome Spyglass               â”‚ 1404697612  â”‚ QoL          â”‚
â”‚ Classic Flyers                 â”‚ 895711211   â”‚ Gameplay     â”‚
â”‚ Ark Eternal (overhaul)         â”‚ 895711211   â”‚ Total Conv.  â”‚
â”‚ Primal Fear (dinos)            â”‚ 1356703358  â”‚ Content      â”‚
â”‚ Ultra Stacks                   â”‚ 761535755   â”‚ QoL          â”‚
â”‚ Dino Storage v2                â”‚ 1609138312  â”‚ Must-have    â”‚
â”‚ Automated Ark                  â”‚ 812655342   â”‚ Automation   â”‚
â”‚ Castles, Keeps & Forts         â”‚ 764755314   â”‚ Building     â”‚
â”‚ Eco's RP Decor                 â”‚ 741203089   â”‚ Decoration   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DOWNLOAD COMMAND:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

cd /home/ark/arkse/ShooterGame/Content/Mods
steamcmd +login anonymous \
  +workshop_download_item 346110 731604991 \
  +workshop_download_item 346110 1404697612 \
  +quit

MOD LOADING ORDER MATTERS!
Dependencies eerst, dan gameplay mods, dan cosmetic

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Wil je nu:

ğŸš€ Alle game scripts compleet maken (Minecraft, FiveM, Rust, CS2, Palworld)?
ğŸ“Š Monitoring & Security scripts (Netdata, backups, firewall)?
ğŸ³ Docker Compose alternatief setup maken?
ğŸ“± Control panel bouwen (web interface voor beheer)?
Of direct alles in Ã©Ã©n keer - volledig geautomatiseerde setup van A-Z? ğŸ’ª





ark

claude-sonnet-4-5-20250929-thinking-32k

Thought for 2 seconds

ğŸ§ Complete Automated Setup Scripts
ğŸ“ SCRIPT STRUCTUUR
text

gameserver-setup/
â”œâ”€â”€ install.sh                    # Master installer
â”œâ”€â”€ config.env                    # Configuratie variabelen
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ 00-system-prep.sh        # Systeem voorbereiding
â”‚   â”œâ”€â”€ 01-pterodactyl-panel.sh  # Panel installatie
â”‚   â”œâ”€â”€ 02-pterodactyl-wings.sh  # Wings/Node installatie
â”‚   â”œâ”€â”€ 03-games-minecraft.sh    # Minecraft setup
â”‚   â”œâ”€â”€ 04-games-fivem.sh        # FiveM setup
â”‚   â”œâ”€â”€ 05-games-rust.sh         # Rust setup
â”‚   â”œâ”€â”€ 06-games-cs2.sh          # CS2/CS:GO setup
â”‚   â”œâ”€â”€ 07-games-palworld.sh     # Palworld setup
â”‚   â”œâ”€â”€ 08-monitoring.sh         # Monitoring tools
â”‚   â”œâ”€â”€ 09-security.sh           # Security hardening
â”‚   â””â”€â”€ 10-backup.sh             # Backup systeem
â”œâ”€â”€ eggs/                         # Pterodactyl egg configs
â”œâ”€â”€ configs/                      # Game config templates
â””â”€â”€ utils/                        # Helper scripts
ğŸš€ MASTER INSTALLER
install.sh
Bash

#!/bin/bash
###############################################################################
# GameServer Automated Setup - Master Installer
# Versie: 1.0
# Compatibel met: Ubuntu 22.04 LTS
###############################################################################

set -e  # Stop bij errors

# Kleuren voor output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Banner
clear
cat << "EOF"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                           â•‘
â•‘   ğŸ®  GAMESERVER AUTOMATED SETUP                         â•‘
â•‘   Complete installatie voor 5Ã— MS-01 nodes               â•‘
â•‘                                                           â•‘
â•‘   Games: Minecraft | FiveM | Rust | CS2 | Palworld       â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF

echo ""
echo -e "${BLUE}Gestart op: $(date)${NC}"
echo ""

# Check of script als root draait
if [[ $EUID -ne 0 ]]; then
   echo -e "${RED}âŒ Dit script moet als root uitgevoerd worden${NC}"
   echo "Gebruik: sudo ./install.sh"
   exit 1
fi

# Controleer Ubuntu versie
if ! grep -q "22.04" /etc/os-release; then
    echo -e "${YELLOW}âš ï¸  Waarschuwing: Dit script is getest op Ubuntu 22.04${NC}"
    read -p "Doorgaan op eigen risico? (y/N): " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
fi

# Laad configuratie
if [ ! -f "config.env" ]; then
    echo -e "${RED}âŒ config.env niet gevonden!${NC}"
    echo "Kopieer config.env.example naar config.env en pas aan"
    exit 1
fi

source config.env

# Logging setup
LOG_DIR="/var/log/gameserver-setup"
mkdir -p $LOG_DIR
LOG_FILE="$LOG_DIR/install-$(date +%Y%m%d-%H%M%S).log"

# Log functie
log() {
    echo -e "${2}${1}${NC}" | tee -a $LOG_FILE
}

log "ğŸ“ Logbestand: $LOG_FILE" "$BLUE"
echo ""

###############################################################################
# Installatie Menu
###############################################################################

show_menu() {
    echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${GREEN}  Selecteer installatie componenten    ${NC}"
    echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "  [1] ğŸ”§ Complete installatie (alles)"
    echo "  [2] ğŸ–¥ï¸  Alleen systeem voorbereiding"
    echo "  [3] ğŸ›ï¸  Pterodactyl Panel (webinterface)"
    echo "  [4] ğŸ”Œ Pterodactyl Wings (deze node)"
    echo "  [5] ğŸ® Game servers installeren"
    echo "  [6] ğŸ“Š Monitoring & Security"
    echo "  [7] ğŸ” Systeem status check"
    echo "  [8] âŒ Annuleren"
    echo ""
    read -p "Keuze [1-8]: " choice
}

# Installatie functies
install_system() {
    log "ğŸ”§ Systeem voorbereiding..." "$BLUE"
    bash scripts/00-system-prep.sh 2>&1 | tee -a $LOG_FILE
}

install_panel() {
    log "ğŸ›ï¸  Pterodactyl Panel installatie..." "$BLUE"
    bash scripts/01-pterodactyl-panel.sh 2>&1 | tee -a $LOG_FILE
}

install_wings() {
    log "ğŸ”Œ Pterodactyl Wings installatie..." "$BLUE"
    bash scripts/02-pterodactyl-wings.sh 2>&1 | tee -a $LOG_FILE
}

install_games() {
    log "ğŸ® Game servers installatie..." "$BLUE"
    
    echo ""
    echo "Welke games wil je installeren?"
    echo "  [1] Minecraft (Paper + Fabric)"
    echo "  [2] FiveM (GTA V RP)"
    echo "  [3] Rust"
    echo "  [4] CS2 / CS:GO"
    echo "  [5] Palworld"
    echo "  [6] Alles"
    echo ""
    read -p "Keuze (bijv: 1,3,5 of 6 voor alles): " games
    
    IFS=',' read -ra GAMES <<< "$games"
    for game in "${GAMES[@]}"; do
        case $game in
            1|6) bash scripts/03-games-minecraft.sh 2>&1 | tee -a $LOG_FILE ;;
            2|6) bash scripts/04-games-fivem.sh 2>&1 | tee -a $LOG_FILE ;;
            3|6) bash scripts/05-games-rust.sh 2>&1 | tee -a $LOG_FILE ;;
            4|6) bash scripts/06-games-cs2.sh 2>&1 | tee -a $LOG_FILE ;;
            5|6) bash scripts/07-games-palworld.sh 2>&1 | tee -a $LOG_FILE ;;
        esac
        [ "$game" == "6" ] && break
    done
}

install_monitoring() {
    log "ğŸ“Š Monitoring & Security installatie..." "$BLUE"
    bash scripts/08-monitoring.sh 2>&1 | tee -a $LOG_FILE
    bash scripts/09-security.sh 2>&1 | tee -a $LOG_FILE
    bash scripts/10-backup.sh 2>&1 | tee -a $LOG_FILE
}

system_check() {
    log "ğŸ” Systeem status check..." "$BLUE"
    bash utils/system-check.sh 2>&1 | tee -a $LOG_FILE
}

# Menu loop
while true; do
    show_menu
    
    case $choice in
        1)
            log "ğŸš€ Start volledige installatie..." "$GREEN"
            install_system
            install_panel
            install_wings
            install_games
            install_monitoring
            log "âœ… Installatie compleet!" "$GREEN"
            break
            ;;
        2) install_system ;;
        3) install_panel ;;
        4) install_wings ;;
        5) install_games ;;
        6) install_monitoring ;;
        7) system_check ;;
        8)
            log "âŒ Installatie geannuleerd" "$YELLOW"
            exit 0
            ;;
        *)
            echo -e "${RED}Ongeldige keuze${NC}"
            ;;
    esac
    
    echo ""
    read -p "Druk op Enter om door te gaan..."
    clear
done

# Samenvatting
echo ""
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${GREEN}â•‘                 âœ… INSTALLATIE VOLTOOID                   â•‘${NC}"
echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
log "ğŸ“Š Installatie details:" "$BLUE"
log "   â€¢ Logbestand: $LOG_FILE"
log "   â€¢ Panel URL: https://$PANEL_FQDN"
log "   â€¢ Datum: $(date)"
echo ""
log "ğŸ“š Volgende stappen:" "$YELLOW"
log "   1. Login op Pterodactyl Panel"
log "   2. Maak locations en nodes aan"
log "   3. Import game eggs uit /eggs/ directory"
log "   4. Test een gameserver"
echo ""
log "ğŸ”— Handige links:" "$BLUE"
log "   â€¢ Pterodactyl Docs: https://pterodactyl.io/panel/1.0/getting_started.html"
log "   â€¢ Support: [jouw discord/email]"
echo ""

exit 0
âš™ï¸ CONFIGURATIE BESTAND
config.env.example
Bash

###############################################################################
# GameServer Setup - Configuratie
# Kopieer naar config.env en pas aan
###############################################################################

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SYSTEEM CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Timezone
TIMEZONE="Europe/Amsterdam"

# Swap size (in GB, aanbevolen: 8-16)
SWAP_SIZE=8

# Node naam (bijv: node1, node2, etc.)
NODE_NAME="node1"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PTERODACTYL PANEL CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Is dit de Panel node? (true/false)
# Slechts 1 node in je cluster moet de panel hosten
INSTALL_PANEL=true

# Panel domein (bijv: panel.jouwdomein.nl)
PANEL_FQDN="panel.example.com"

# Admin gebruiker voor panel
PANEL_ADMIN_EMAIL="admin@example.com"
PANEL_ADMIN_USERNAME="admin"
PANEL_ADMIN_FIRSTNAME="Admin"
PANEL_ADMIN_LASTNAME="User"

# Database credentials
MYSQL_ROOT_PASSWORD="CHANGE_ME_SUPER_SECURE_$(openssl rand -base64 32)"
PANEL_DB_PASSWORD="CHANGE_ME_$(openssl rand -base64 24)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PTERODACTYL WINGS CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Wings installeren op deze node? (true/false)
INSTALL_WINGS=true

# Node FQDN (bijv: node1.jouwdomein.nl)
WINGS_FQDN="node1.example.com"

# Wings port (standaard: 8080)
WINGS_PORT=8080

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GAME SERVER CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Minecraft
INSTALL_MINECRAFT=true
MINECRAFT_VERSIONS="1.20.4,1.19.4,1.18.2"  # Versies om te pre-downloaden

# FiveM
INSTALL_FIVEM=true
FIVEM_LICENSE_KEY=""  # Optioneel, voor >32 spelers

# Rust
INSTALL_RUST=true
RUST_BRANCH="public"  # public of staging

# CS2 / CS:GO
INSTALL_CS2=true
INSTALL_CSGO=true

# Palworld
INSTALL_PALWORLD=true

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# MONITORING & SECURITY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Netdata monitoring
INSTALL_NETDATA=true

# Uptime Kuma
INSTALL_UPTIME_KUMA=true
UPTIME_KUMA_PORT=3001

# Fail2Ban
INSTALL_FAIL2BAN=true

# UFW Firewall
ENABLE_UFW=true

# Backup configuratie
BACKUP_ENABLED=true
BACKUP_DESTINATION="/backup"
BACKUP_RETENTION_DAYS=7

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NETWERK CONFIGURATIE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Primair IP adres van deze node
NODE_IP="192.168.1.100"

# SSH port (wijzigen aanbevolen voor security)
SSH_PORT=22

# Toegestane SSH IP's (laat leeg voor alles, of bijv: "1.2.3.4/32,5.6.7.8/32")
SSH_ALLOWED_IPS=""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DISCORD NOTIFICATIES (optioneel)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DISCORD_WEBHOOK_URL=""  # Webhook URL voor installatie updates

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GEAVANCEERD
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Debug mode (extra verbose logging)
DEBUG=false

# Auto-update bij reboot
AUTO_UPDATE=true

# Resource limits (percentage van totaal beschikbaar)
CPU_ALLOCATION_PERCENT=90
RAM_ALLOCATION_PERCENT=90
ğŸ”§ SCRIPT 1: SYSTEEM VOORBEREIDING
scripts/00-system-prep.sh
Bash

#!/bin/bash
###############################################################################
# Systeem Voorbereiding
###############################################################################

source config.env

echo "ğŸ”§ Systeem voorbereiding gestart..."

# Update systeem
echo "ğŸ“¦ Systeem updaten..."
apt update && apt upgrade -y

# EssentiÃ«le pakketten installeren
echo "ğŸ“¦ Basis pakketten installeren..."
apt install -y \
    curl \
    wget \
    git \
    tar \
    unzip \
    zip \
    software-properties-common \
    apt-transport-https \
    ca-certificates \
    gnupg \
    lsb-release \
    htop \
    nano \
    vim \
    net-tools \
    ufw \
    fail2ban \
    screen \
    tmux \
    sudo \
    build-essential \
    dirmngr \
    debian-keyring \
    debian-archive-keyring

# Timezone instellen
echo "ğŸ• Timezone instellen naar $TIMEZONE..."
timedatectl set-timezone $TIMEZONE

# Swap configureren
echo "ğŸ’¾ Swap configureren (${SWAP_SIZE}GB)..."
if [ ! -f /swapfile ]; then
    fallocate -l ${SWAP_SIZE}G /swapfile
    chmod 600 /swapfile
    mkswap /swapfile
    swapon /swapfile
    echo '/swapfile none swap sw 0 0' >> /etc/fstab
    
    # Swappiness optimaliseren voor gameservers
    echo "vm.swappiness=10" >> /etc/sysctl.conf
    sysctl -p
fi

# Kernel parameters optimaliseren
echo "âš™ï¸  Kernel parameters optimaliseren..."
cat >> /etc/sysctl.conf << EOF

# GameServer Optimalisaties
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.tcp_congestion_control = bbr
net.core.default_qdisc = fq
net.ipv4.tcp_mtu_probing = 1
net.ipv4.ip_forward = 1
fs.file-max = 2097152
EOF

sysctl -p

# Limits verhogen
echo "ğŸ“ˆ System limits verhogen..."
cat >> /etc/security/limits.conf << EOF

# GameServer Limits
*               soft    nofile          1000000
*               hard    nofile          1000000
*               soft    nproc           unlimited
*               hard    nproc           unlimited
root            soft    nofile          1000000
root            hard    nofile          1000000
root            soft    nproc           unlimited
root            hard    nproc           unlimited
EOF

# Docker installeren
echo "ğŸ³ Docker installeren..."
if ! command -v docker &> /dev/null; then
    curl -fsSL https://get.docker.com -o get-docker.sh
    sh get-docker.sh
    systemctl enable docker
    systemctl start docker
    rm get-docker.sh
    
    # Docker Compose
    curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" \
        -o /usr/local/bin/docker-compose
    chmod +x /usr/local/bin/docker-compose
fi

# SteamCMD voorbereiden
echo "ğŸ® SteamCMD dependencies installeren..."
dpkg --add-architecture i386
apt update
apt install -y lib32gcc-s1 lib32stdc++6 steamcmd

# Gebruikers aanmaken
echo "ğŸ‘¤ Gameserver gebruikers aanmaken..."
for user in minecraft fivem rust csgo palworld; do
    if ! id "$user" &>/dev/null; then
        useradd -m -s /bin/bash $user
        echo "   âœ… Gebruiker $user aangemaakt"
    fi
done

# Directories aanmaken
echo "ğŸ“ Directories aanmaken..."
mkdir -p /var/lib/pterodactyl/{volumes,backups}
mkdir -p /etc/pterodactyl
mkdir -p /var/log/pterodactyl

echo "âœ… Systeem voorbereiding compleet!"
ğŸ›ï¸ SCRIPT 2: PTERODACTYL PANEL
scripts/01-pterodactyl-panel.sh
Bash

#!/bin/bash
###############################################################################
# Pterodactyl Panel Installatie
###############################################################################

source config.env

if [ "$INSTALL_PANEL" != "true" ]; then
    echo "â­ï¸  Panel installatie overgeslagen (INSTALL_PANEL=false)"
    exit 0
fi

echo "ğŸ›ï¸  Pterodactyl Panel installatie gestart..."

# Dependencies
echo "ğŸ“¦ Panel dependencies installeren..."
apt install -y \
    php8.1 \
    php8.1-{cli,gd,mysql,pdo,mbstring,tokenizer,bcmath,xml,fpm,curl,zip} \
    mariadb-server \
    nginx \
    certbot \
    python3-certbot-nginx \
    redis-server \
    composer

# MariaDB configureren
echo "ğŸ—„ï¸  Database configureren..."
mysql -u root <<EOF
CREATE DATABASE IF NOT EXISTS panel;
CREATE USER IF NOT EXISTS 'pterodactyl'@'127.0.0.1' IDENTIFIED BY '${PANEL_DB_PASSWORD}';
GRANT ALL PRIVILEGES ON panel.* TO 'pterodactyl'@'127.0.0.1' WITH GRANT OPTION;
FLUSH PRIVILEGES;
EOF

# Panel downloaden
echo "ğŸ“¥ Pterodactyl Panel downloaden..."
cd /var/www
mkdir -p pterodactyl
cd pterodactyl

curl -Lo panel.tar.gz https://github.com/pterodactyl/panel/releases/latest/download/panel.tar.gz
tar -xzvf panel.tar.gz
chmod -R 755 storage/* bootstrap/cache/

# Composer dependencies
echo "ğŸ“¦ Composer dependencies installeren..."
COMPOSER_ALLOW_SUPERUSER=1 composer install --no-dev --optimize-autoloader

# Environment configureren
echo "âš™ï¸  Environment configureren..."
cp .env.example .env

php artisan key:generate --force

php artisan p:environment:setup \
    --author=$PANEL_ADMIN_EMAIL \
    --url=https://$PANEL_FQDN \
    --timezone=$TIMEZONE \
    --cache=redis \
    --session=redis \
    --queue=redis \
    --redis-host=127.0.0.1 \
    --redis-pass= \
    --redis-port=6379 \
    --no-interaction

php artisan p:environment:database \
    --host=127.0.0.1 \
    --port=3306 \
    --database=panel \
    --username=pterodactyl \
    --password=$PANEL_DB_PASSWORD \
    --no-interaction

# Database setup
echo "ğŸ—„ï¸  Database migreren..."
php artisan migrate --seed --force

# Admin gebruiker
echo "ğŸ‘¤ Admin gebruiker aanmaken..."
php artisan p:user:make \
    --email=$PANEL_ADMIN_EMAIL \
    --username=$PANEL_ADMIN_USERNAME \
    --name-first=$PANEL_ADMIN_FIRSTNAME \
    --name-last=$PANEL_ADMIN_LASTNAME \
    --password=$(openssl rand -base64 16) \
    --admin=1 \
    --no-interaction

# Permissions
chown -R www-data:www-data /var/www/pterodactyl/*

# Crontab
(crontab -l 2>/dev/null; echo "* * * * * php /var/www/pterodactyl/artisan schedule:run >> /dev/null 2>&1") | crontab -

# Queue worker service
cat > /etc/systemd/system/pteroq.service << 'EOF'
[Unit]
Description=Pterodactyl Queue Worker
After=redis-server.service

[Service]
User=www-data
Group=www-data
Restart=always
ExecStart=/usr/bin/php /var/www/pterodactyl/artisan queue:work --queue=high,standard,low --sleep=3 --tries=3
StartLimitInterval=180
StartLimitBurst=30
RestartSec=5s

[Install]
WantedBy=multi-user.target
EOF

systemctl enable pteroq.service
systemctl start pteroq.service

# Nginx configureren
echo "ğŸŒ Nginx configureren..."
cat > /etc/nginx/sites-available/pterodactyl.conf << EOF
server {
    listen 80;
    server_name $PANEL_FQDN;
    return 301 https://\$server_name\$request_uri;
}

server {
    listen 443 ssl http2;
    server_name $PANEL_FQDN;

    root /var/www/pterodactyl/public;
    index index.php;

    access_log /var/log/nginx/pterodactyl.app-access.log;
    error_log  /var/log/nginx/pterodactyl.app-error.log error;

    client_max_body_size 100m;
    client_body_timeout 120s;

    sendfile off;

    ssl_certificate /etc/letsencrypt/live/$PANEL_FQDN/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/$PANEL_FQDN/privkey.pem;
    ssl_session_cache shared:SSL:10m;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384";
    ssl_prefer_server_ciphers on;

    location / {
        try_files \$uri \$uri/ /index.php?\$query_string;
    }

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param PHP_VALUE "upload_max_filesize = 100M \n post_max_size=100M";
        fastcgi_param SCRIPT_FILENAME \$document_root\$fastcgi_script_name;
        fastcgi_param HTTP_PROXY "";
        fastcgi_intercept_errors off;
        fastcgi_buffer_size 16k;
        fastcgi_buffers 4 16k;
        fastcgi_connect_timeout 300;
        fastcgi_send_timeout 300;
        fastcgi_read_timeout 300;
        include /etc/nginx/fastcgi_params;
    }

    location ~ /\.ht {
        deny all;
    }
}
EOF

ln -sf /etc/nginx/sites-available/pterodactyl.conf /etc/nginx/sites-enabled/pterodactyl.conf
rm -f /etc/nginx/sites-enabled/default

# SSL certificaat
echo "ğŸ”’ SSL certificaat aanvragen..."
certbot --nginx -d $PANEL_FQDN --non-interactive --agree-tos -m $PANEL_ADMIN_EMAIL

# Nginx herstarten
systemctl restart nginx

echo "âœ… Pterodactyl Panel installatie compleet!"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  Panel URL: https://$PANEL_FQDN"
echo "  Admin Email: $PANEL_ADMIN_EMAIL"
echo "  Admin Password: (check je email of reset via artisan)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "Reset password met:"
echo "  cd /var/www/pterodactyl && php artisan p:user:make"
ğŸ”Œ SCRIPT 3: PTERODACTYL WINGS
scripts/02-pterodactyl-wings.sh
Bash

#!/bin/bash
###############################################################################
# Pterodactyl Wings Installatie
###############################################################################

source config.env

if [ "$INSTALL_WINGS" != "true" ]; then
    echo "â­ï¸  Wings installatie overgeslagen (INSTALL_WINGS=false)"
    exit 0
fi

echo "ğŸ”Œ Pterodactyl Wings installatie gestart..."

# Wings downloaden
echo "ğŸ“¥ Wings binary downloaden..."
mkdir -p /etc/pterodactyl
cd /etc/pterodactyl

curl -L -o /usr/local/bin/wings "https://github.com/pterodactyl/wings/releases/latest/download/wings_linux_$([[ "$(uname -m)" == "x86_64" ]] && echo "amd64" || echo "arm64")"
chmod +x /usr/local/bin/wings

# SSL certificaat voor Wings
echo "ğŸ”’ SSL certificaat voor Wings..."
certbot certonly --standalone -d $WINGS_FQDN --non-interactive --agree-tos -m $PANEL_ADMIN_EMAIL

# Systemd service
echo "âš™ï¸  Wings service configureren..."
cat > /etc/systemd/system/wings.service << EOF
[Unit]
Description=Pterodactyl Wings Daemon
After=docker.service
Requires=docker.service
PartOf=docker.service

[Service]
User=root
WorkingDirectory=/etc/pterodactyl
LimitNOFILE=4096
PIDFile=/var/run/wings/daemon.pid
ExecStart=/usr/local/bin/wings
Restart=on-failure
StartLimitInterval=180
StartLimitBurst=30
RestartSec=5s

[Install]
WantedBy=multi-user.target
EOF

# Enable service (start later na configuratie via panel)
systemctl enable wings

echo "âœ… Wings installatie compleet!"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âš ï¸  VOLGENDE STAPPEN:"
echo ""
echo "1. Log in op het Pterodactyl Panel"
echo "2. Ga naar Admin â†’ Locations â†’ Create Location"
echo "3. Ga naar Admin â†’ Nodes â†’ Create Node"
echo "4. Configureer node met:"
echo "   - FQDN: $WINGS_FQDN"
echo "   - Port: $WINGS_PORT"
echo "   - SSL: Enabled"
echo "5. Kopieer de auto-deployment command"
echo "6. Voer de command uit op deze node"
echo "7. Start Wings: systemctl start wings"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
Wil je dat ik doorga met de game-specifieke scripts (Minecraft, FiveM, Rust, CS2, Palworld)?

Of eerst de monitoring/security scripts maken?

Of wil je meer helper utilities zoals:

Automated egg importers
Backup scripts
Server health check tools
Auto-scaling scripts
Wat heeft prioriteit? ğŸš€





ğŸ§ Complete installatiecript - Automated setup van alles

claude-sonnet-4-5-20250929-thinking-32k

Thought for 1 second

ğŸ› ï¸ Software Stack - Gameserver Setup
ğŸ“‹ FASE 1: BASIS INFRASTRUCTUUR
Operating System & Core Tools:
Software	Versie	Download	Licentie	Waarom
Ubuntu Server LTS	22.04.3	ubuntu.com/download/server	Gratis	Stabiel, grote community
Proxmox VE (optioneel)	8.1	proxmox.com	Gratis	VM management, flexibel
Docker	Latest	curl -fsSL https://get.docker.com -o get-docker.sh	Gratis	Containerisatie
Docker Compose	v2.23+	Included in Docker	Gratis	Multi-container orchestration
Keuze:

Optie A: Direct Ubuntu â†’ Simpeler, meer performance
Optie B: Proxmox + VMs â†’ Flexibeler, betere isolatie âœ… AANBEVOLEN
Game Server Panel:
Panel	Prijs	Features	Download	Aanbeveling
Pterodactyl	Gratis	Docker-based, modern UI, API	pterodactyl.io	â­â­â­â­â­ BESTE KEUZE
AMP by CubeCoders	$10/instance	Commercieel, support, plugins	cubecoders.com/AMP	â­â­â­â­ Premium optie
Crafty Controller	Gratis	Simpel, Minecraft-focus	craftycontrol.com	â­â­â­ Basic
LinuxGSM	Gratis	CLI-only, lightweight	linuxgsm.com	â­â­â­ Voor gevorderden
â¡ï¸ We gaan verder met Pterodactyl

ğŸ® GAME 1: MINECRAFT
Server Software Opties:
Vanilla:
Software	Type	Java	Performance	Download
Vanilla	Official	17+	â­â­	minecraft.net/download/server
Paper	Optimized	17+	â­â­â­â­â­	papermc.io/downloads
Purpur	Paper fork	17+	â­â­â­â­â­	purpurmc.org
Fabric	Modded	17+	â­â­â­â­	fabricmc.net
âœ… Aanbeveling: Paper voor vanilla, Fabric voor modded

Modded:
Software	Versie	Mods	Download
Forge	1.20.x	~40k mods	files.minecraftforge.net
Fabric	1.20.x	~8k mods, sneller	fabricmc.net
NeoForge	1.20.x	Nieuwe Forge fork	neoforged.net
Essential Plugins/Tools:
Bash

# Vanilla/Paper Plugins
â”œâ”€ EssentialsX          # Basis commands
â”œâ”€ LuckPerms            # Permissions
â”œâ”€ Vault                # Economy API
â”œâ”€ WorldEdit            # Building tool
â”œâ”€ CoreProtect          # Rollback/logging
â”œâ”€ Geyser + Floodgate   # Bedrock support
â””â”€ ViaVersion           # Multi-version support

# Performance Plugins
â”œâ”€ spark                # Profiler
â”œâ”€ ChunkyBorder         # Pre-generate chunks
â””â”€ Clearlagg            # Entity cleanup
Download Plugins:

SpigotMC.org
Hangar (PaperMC)
Modrinth
CurseForge
Configuratie Templates:
Paper server.properties:

properties

# Download volledig template:
wget https://raw.githubusercontent.com/PaperMC/Paper/master/patches/server/0001-Setup-Gradle-project.patch
Recommended JVM Flags (Aikar's):

Bash

java -Xms10G -Xmx10G -XX:+UseG1GC -XX:+ParallelRefProcEnabled \
-XX:MaxGCPauseMillis=200 -XX:+UnlockExperimentalVMOptions \
-XX:+DisableExplicitGC -XX:+AlwaysPreTouch -XX:G1NewSizePercent=30 \
-XX:G1MaxNewSizePercent=40 -XX:G1HeapRegionSize=8M \
-XX:G1ReservePercent=20 -XX:G1HeapWastePercent=5 \
-XX:G1MixedGCCountTarget=4 -XX:InitiatingHeapOccupancyPercent=15 \
-XX:G1MixedGCLiveThresholdPercent=90 -XX:G1RSetUpdatingPauseTimePercent=5 \
-XX:SurvivorRatio=32 -XX:+PerfDisableSharedMem -XX:MaxTenuringThreshold=1 \
-Dusing.aikars.flags=https://mcflags.emc.gs -Daikars.new.flags=true \
-jar paper.jar --nogui
ğŸš— GAME 2: FiveM (GTA V RP)
Server Software:
Component	Versie	Download	Licentie
FiveM Server	Latest	runtime.fivem.net/artifacts/fivem	Gratis
txAdmin	Included	Built-in webpanel	Gratis
MariaDB/MySQL	10.11+	apt install mariadb-server	Gratis
Download Commands:
Bash

# Linux Server Setup
mkdir -p ~/FXServer/server
cd ~/FXServer/server

# Download latest build (check website for latest link)
wget https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/[VERSION]/fx.tar.xz

# Extract
tar xf fx.tar.xz

# Create server.cfg
cd ~/FXServer/server-data
wget https://github.com/citizenfx/cfx-server-data/archive/master.zip
unzip master.zip
Essential Resources (Scripts):
Bash

# Framework (kies er 1)
â”œâ”€ ESX Framework        # Meest populair, groot ecosysteem
â”‚  â””â”€ Download: github.com/esx-framework/esx-legacy
â”œâ”€ QBCore              # Modern, actief onderhouden
â”‚  â””â”€ Download: github.com/qbcore-framework/qb-core
â””â”€ vRP                 # Lightweight

# Must-Have Scripts
â”œâ”€ oxmysql             # Database connector
â”œâ”€ pma-voice           # Voice chat
â”œâ”€ progressbar         # UI element
â”œâ”€ mythic_notify       # Notifications
â”œâ”€ NativeUI            # Menu system
â””â”€ bob74_ipl          # Map fixes

# Popular Additions
â”œâ”€ esx_policejob       # Police system
â”œâ”€ esx_ambulancejob    # EMS system
â”œâ”€ esx_shops           # Shop system
â””â”€ esx_vehicleshop     # Car dealership
Download Resources:

CFX.re Forums
GitHub ESX
GitHub QBCore
Database:
Bash

# Install MariaDB
sudo apt update
sudo apt install mariadb-server -y
sudo mysql_secure_installation

# Create FiveM database
sudo mysql -u root -p
CREATE DATABASE fivem;
CREATE USER 'fivem'@'localhost' IDENTIFIED BY 'STRONG_PASSWORD';
GRANT ALL PRIVILEGES ON fivem.* TO 'fivem'@'localhost';
FLUSH PRIVILEGES;
ğŸ”« GAME 3: RUST
Server Software:
Component	Method	Command/Download
SteamCMD	Required	sudo apt install steamcmd
Rust Server	Via SteamCMD	AppID: 258550
Oxide/uMod	Plugin framework	umod.org
Carbon	Modern alternative	github.com/CarbonCommunity/Carbon
Installation:
Bash

# Install SteamCMD
sudo add-apt-repository multiverse
sudo dpkg --add-architecture i386
sudo apt update
sudo apt install steamcmd lib32gcc-s1 -y

# Create Rust user
sudo useradd -m -s /bin/bash rustserver
sudo su - rustserver

# Install Rust server
mkdir -p ~/rust-server
steamcmd +login anonymous +force_install_dir ~/rust-server \
+app_update 258550 validate +quit

# Download Oxide/uMod
cd ~/rust-server
wget https://umod.org/games/rust/download -O umod.zip
unzip umod.zip
Essential Plugins:
Bash

# Admin/Management
â”œâ”€ AdminRadar          # ESP for admins
â”œâ”€ Vanish              # Invisible admin
â”œâ”€ AdminHammer         # Instant build/destroy
â””â”€ BetterChat          # Chat improvements

# Gameplay
â”œâ”€ Kits                # Starter kits
â”œâ”€ SkipNightVote       # Vote to skip night
â”œâ”€ Teleportation       # Home/TP system
â”œâ”€ GUIShop             # Shop UI
â””â”€ Economics           # Currency system

# Performance
â”œâ”€ EntityReducer       # Performance optimization
â”œâ”€ BetterLoot          # Loot table control
â””â”€ StackSizeController # Stack size modifications

# Anti-Cheat
â”œâ”€ AntiCheatEnhanced   # Basic AC
â””â”€ NoEscape            # Combat logging prevention
Download: uMod.org | Lone.Design | Codefling

Server Config:
Bash

# Example startup script
./RustDedicated -batchmode \
+server.hostname "Your Server Name" \
+server.port 28015 \
+server.level "Procedural Map" \
+server.seed 1234567 \
+server.worldsize 3500 \
+server.maxplayers 100 \
+server.description "Server Description" \
+server.headerimage "URL" \
+server.url "https://yourwebsite.com" \
+rcon.port 28016 \
+rcon.password "STRONG_PASSWORD" \
+rcon.web 1
ğŸ¯ GAME 4: CS2 / CS:GO
Server Software:
Game	AppID	Method	Status
CS:GO	740	SteamCMD	Legacy (still popular)
CS2	730	SteamCMD	Current
Installation:
Bash

# CS2 Server (Dedicated)
steamcmd +login anonymous +force_install_dir ~/cs2-server \
+app_update 730 validate +quit

# CS:GO Server (Legacy)
steamcmd +login anonymous +force_install_dir ~/csgo-server \
+app_update 740 validate +quit
Server Plugins/Mods:
Metamod:Source + SourceMod:
Bash

# Download Metamod:Source
cd ~/cs2-server/game/csgo
wget https://mms.alliedmods.net/mmsdrop/1.11/mmsource-1.11.0-git1148-linux.tar.gz
tar -xzf mmsource-*.tar.gz

# Download SourceMod
wget https://sm.alliedmods.net/smdrop/1.11/sourcemod-1.11.0-git6963-linux.tar.gz
tar -xzf sourcemod-*.tar.gz
Essential Plugins:
Bash

# Admin & Management
â”œâ”€ Admin File Simple Reader  # Admin management
â”œâ”€ SourceBans++              # Ban system
â”œâ”€ Basic Commands            # Kick/ban/slay
â””â”€ Reserved Slots            # VIP slots

# Gameplay
â”œâ”€ Deathmatch                # DM mode
â”œâ”€ Retakes                   # Retake practice
â”œâ”€ Execute                   # Nade practice
â”œâ”€ PugSetup                  # 5v5 PUG system
â””â”€ Surrender                 # Surrender vote

# Stats & Ranking
â”œâ”€ RankMe                    # Player ranks
â”œâ”€ Simple Chat Processor     # Chat colors/tags
â””â”€ Map Configs               # Per-map configs

# Utility
â”œâ”€ Advertisements            # Timed messages
â”œâ”€ MapChooser                # Map voting
â””â”€ RockTheVote               # RTV system
Download: AlliedModders | CS2 Plugins

Server Config Files:
Bash

# Download competitive config
cd ~/cs2-server/game/csgo/cfg
wget https://github.com/splewis/csgo-pug-setup/raw/master/cfg/sourcemod/pugsetup/standard.cfg

# Tickrate configs available
â”œâ”€ 64 tick (matchmaking)
â”œâ”€ 128 tick (competitive) âœ… Recommended
â””â”€ 32 tick (casual only)
ğŸ¦– GAME 5: PALWORLD
Server Software:
Component	Method	Command
Palworld Server	SteamCMD	AppID: 2394010
Dependencies	Linux libs	apt install lib32gcc-s1
Installation:
Bash

# Create Palworld user
sudo useradd -m -s /bin/bash palworld
sudo su - palworld

# Install server
mkdir -p ~/palworld-server
steamcmd +login anonymous +force_install_dir ~/palworld-server \
+app_update 2394010 validate +quit

# Setup config directory
cd ~/palworld-server/Pal/Saved/Config/LinuxServer
cp DefaultPalWorldSettings.ini PalWorldSettings.ini
Configuration Tool:
GUI Config Generator:

Palworld-Server-Tool (GitHub)
Online Config Generator
Important Settings:
ini

[/Script/Pal.PalGameWorldSettings]
ServerName="Your Server Name"
ServerDescription="Description"
ServerPassword=""
MaxPlayers=32
PublicPort=8211
RCONEnabled=True
RCONPort=25575
Region=""
bUseAuth=True
BanListURL="https://api.palworldgame.com/api/banlist.txt"

# Gameplay tweaks
DayTimeSpeedRate=1.000000
NightTimeSpeedRate=1.000000
ExpRate=1.000000
PalCaptureRate=1.000000
PalSpawnNumRate=1.000000
Mods/Tools (Community):
Bash

# Popular Tools
â”œâ”€ PalGuard               # Anti-cheat (community)
â”œâ”€ PalEdit                # Save editor
â”œâ”€ RCON Tool              # Remote admin
â””â”€ Discord Bot            # Server status bot
Note: Palworld modding scene is nog jong (released Jan 2024)

Resources:

Palworld Modding Discord
Nexus Mods - Palworld
ğŸ”§ MONITORING & MANAGEMENT TOOLS
Server Monitoring:
Tool	Purpose	Download	Prijs
Netdata	Real-time monitoring	netdata.cloud	Gratis
Grafana + Prometheus	Metrics & dashboards	grafana.com	Gratis
Uptime Kuma	Uptime monitoring	github.com/louislam/uptime-kuma	Gratis
Pterodactyl Wings	Built-in monitoring	Included	Gratis
Backup Solutions:
Bash

# Automated Backups
â”œâ”€ rsync + cron          # Simple, reliable
â”œâ”€ Restic                # Encrypted, deduplication
â”œâ”€ Duplicati             # GUI-based
â””â”€ Borg Backup          # Advanced, efficient
Security:
Bash

# Essential Security Tools
â”œâ”€ UFW                   # Firewall
â”œâ”€ Fail2Ban             # Brute force protection
â”œâ”€ CrowdSec             # Modern IDS/IPS
â””â”€ rkhunter             # Rootkit detection
ğŸ“¦ COMPLETE SOFTWARE CHECKLIST
Download in deze volgorde:
âœ… STAP 1: Basis (Week 1)

Bash

[ ] Ubuntu Server 22.04 ISO
[ ] Proxmox VE 8.1 ISO (optioneel)
[ ] SSH client (Windows: PuTTY/MobaXterm)
[ ] FileZilla / WinSCP (file transfer)
âœ… STAP 2: Panel (Week 1-2)

Bash

[ ] Pterodactyl Panel installatie script
[ ] Pterodactyl Wings (node software)
[ ] MariaDB/MySQL
[ ] PHP 8.1+ dependencies
[ ] Nginx/Apache webserver
[ ] SSL certificaat (Let's Encrypt)
âœ… STAP 3: Game Servers (Week 2-3)

Bash

# Minecraft
[ ] Paper JAR (latest)
[ ] Fabric Loader
[ ] Java 17+ JRE
[ ] Essential plugins (lijst hierboven)

# FiveM
[ ] FiveM Linux server artifact
[ ] txAdmin
[ ] ESX/QBCore framework
[ ] MySQL database
[ ] Essential resources

# Rust
[ ] SteamCMD
[ ] Rust server files (AppID 258550)
[ ] Oxide/uMod framework
[ ] Essential plugins

# CS2/CS:GO
[ ] SteamCMD
[ ] CS2 server files (AppID 730)
[ ] Metamod:Source
[ ] SourceMod
[ ] Essential plugins

# Palworld
[ ] SteamCMD
[ ] Palworld server files (AppID 2394010)
[ ] Config templates
âœ… STAP 4: Management (Week 3-4)

Bash

[ ] Netdata monitoring
[ ] Uptime Kuma
[ ] Backup solution (Restic)
[ ] UFW firewall
[ ] Fail2Ban
ğŸš€ NEXT: Installatie Scripts
Ik kan nu voor je maken:

ğŸ§ Complete installatiecript - Automated setup van alles
ğŸ“ Stap-voor-stap handleiding - Manual installation guide
ğŸ³ Docker Compose files - Container-based deployment
ğŸ“‹ Pterodactyl Eggs - Pre-configured game templates
Wat wil je eerst hebben? Of zullen we beginnen met de hardware voorbereiden (Proxmox/Ubuntu installatie)?





Minecraft (Vanilla + Modded)
FiveM (GTA V RP)
Rust
CS2 / CS:GO
Palworld laat we er van elk eentje klaar maken beginnen met software verzamelen
claude-sonnet-4-5-20250929-thinking-32k

Thought for 1 second

ğŸ“Š Gameserver Hosting - Marktanalyse & Pricing Strategie
ğŸ¯ MARKTANALYSE
1. Doelgroep Segmentatie:
Segment	% Markt	Betalingsbereidheid	Churn	Focus
Casual Gamers	45%	â‚¬3-8/maand	Hoog (40%)	Minecraft, Valheim
Community Builders	30%	â‚¬10-25/maand	Middel (25%)	FiveM, Rust, ARK
eSports/Competitive	15%	â‚¬15-50/maand	Laag (15%)	CS2, dedicated
Content Creators	10%	â‚¬20-100/maand	Laag (10%)	Custom, prioriteit
2. Concurrentie Analyse:
Budget Providers:
Provider	Pricing	Kwaliteit	USP
Nitrado	â‚¬3-15	â­â­â­	Makkelijk, auto-install
G-Portal	â‚¬4-20	â­â­â­	Grote gamebibliotheek
PebbleHost	â‚¬2-10	â­â­	Goedkoop
Premium Providers:
Provider	Pricing	Kwaliteit	USP
OVH Game	â‚¬8-40	â­â­â­â­	DDoS bescherming
Hetzner	â‚¬10-50	â­â­â­â­	Dedicated resources
Low.ms	â‚¬15-60	â­â­â­â­â­	Premium hardware
Jouw Positie: Mid-Premium (betere hardware dan budget, betaalbaar dan enterprise)

ğŸ’¶ PRICING STRATEGIE
Tier 1: Casual (Budget Friendly)
Game	RAM	CPU	Slots	Prijs	Cost	Marge
Minecraft Vanilla	2GB	1C	20	â‚¬5/mo	â‚¬1.20	76%
Terraria	1GB	0.5C	16	â‚¬3/mo	â‚¬0.80	73%
Valheim	3GB	1C	10	â‚¬6/mo	â‚¬1.50	75%
CS:GO/CS2	2GB	2C	20	â‚¬7/mo	â‚¬1.80	74%
Target: 40 servers @ â‚¬5 avg = â‚¬200/maand

Tier 2: Community (Mainstream)
Game	RAM	CPU	Slots	Prijs	Cost	Marge
Minecraft Modded	6GB	2C	30	â‚¬12/mo	â‚¬3.20	73%
Palworld	4GB	2C	24	â‚¬10/mo	â‚¬2.50	75%
Project Zomboid	4GB	2C	32	â‚¬9/mo	â‚¬2.40	73%
7 Days to Die	5GB	2C	16	â‚¬11/mo	â‚¬2.80	75%
Target: 25 servers @ â‚¬10 avg = â‚¬250/maand

Tier 3: Premium (High Performance)
Game	RAM	CPU	Slots	Prijs	Cost	Marge
Rust	8GB	4C	100	â‚¬25/mo	â‚¬6.50	74%
ARK Survival	10GB	4C	50	â‚¬28/mo	â‚¬7.20	74%
FiveM (GTA RP)	6GB	3C	64	â‚¬22/mo	â‚¬5.50	75%
Satisfactory	5GB	3C	8	â‚¬15/mo	â‚¬4.00	73%
Target: 15 servers @ â‚¬23 avg = â‚¬345/maand

Tier 4: Enterprise (Custom)
Service	Specs	Prijs	Cost	Marge
Dedicated Node	Full MS-01	â‚¬150/mo	â‚¬40	73%
Custom Setup	Variable	â‚¬50-200/mo	Variable	70%+
Managed Services	+monitoring	+â‚¬20-50/mo	â‚¬5	75%+
Target: 2-3 enterprise clients = â‚¬300-450/maand

ğŸ“ˆ REVENUE PROJECTIE
Scenario 1: Conservative (50% bezetting)
Tier	Aantal	Avg Prijs	Maand	Jaar
Casual (40)	20	â‚¬5	â‚¬100	â‚¬1,200
Community (25)	12	â‚¬10	â‚¬120	â‚¬1,440
Premium (15)	7	â‚¬23	â‚¬161	â‚¬1,932
Enterprise	1	â‚¬150	â‚¬150	â‚¬1,800
TOTAAL	40	-	â‚¬531	â‚¬6,372
Winstmarge: ~74% = â‚¬393/maand = â‚¬4,716/jaar

Scenario 2: Realistic (75% bezetting)
Tier	Aantal	Avg Prijs	Maand	Jaar
Casual	30	â‚¬5	â‚¬150	â‚¬1,800
Community	19	â‚¬10	â‚¬190	â‚¬2,280
Premium	11	â‚¬23	â‚¬253	â‚¬3,036
Enterprise	2	â‚¬150	â‚¬300	â‚¬3,600
TOTAAL	62	-	â‚¬893	â‚¬10,716
Winstmarge: ~74% = â‚¬661/maand = â‚¬7,930/jaar

Scenario 3: Optimistic (90% bezetting)
Tier	Aantal	Avg Prijs	Maand	Jaar
Casual	36	â‚¬5	â‚¬180	â‚¬2,160
Community	22	â‚¬10	â‚¬220	â‚¬2,640
Premium	13	â‚¬23	â‚¬299	â‚¬3,588
Enterprise	3	â‚¬175	â‚¬525	â‚¬6,300
TOTAAL	74	-	â‚¬1,224	â‚¬14,688
Winstmarge: ~74% = â‚¬906/maand = â‚¬10,869/jaar

ğŸ’° KOSTENSTRUCTUUR
Vaste Kosten (maandelijks):
Item	Kosten
Hardware afschrijving (5Ã— MS-01, 3 jaar)	â‚¬103
Elektriciteit (5Ã— 65W avg, â‚¬0.30/kWh)	â‚¬70
Internet (1Gbit symmetrisch)	â‚¬50-100
DDoS bescherming (Cloudflare/Path.net)	â‚¬30-80
Licensing (Panel: Pterodactyl/TCAdmin)	â‚¬0-50
Domain/SSL/Backup storage	â‚¬15
TOTAAL VAST	â‚¬268-408
Variabele Kosten:
Item	Per Server	Bij 60 servers
Support tijd (avg 15min/maand)	â‚¬2-5	â‚¬120-300
Backup storage (cloud)	â‚¬0.50	â‚¬30
Updates/Maintenance	â‚¬0.20	â‚¬12
TOTAAL VARIABEL	-	â‚¬162-342
Totale Maandkosten: â‚¬430-750 (afhankelijk van schaal)

ğŸš€ GO-TO-MARKET STRATEGIE
Fase 1: Launch (Maand 1-3)
Doel: 20-30 klanten, brand awareness

Tactieken:

âœ… Launch promo: 50% korting eerste maand
âœ… Reddit marketing: /r/admincraft, /r/FiveM, /r/playrustservers
âœ… Discord communities: Join populaire gaming communities
âœ… YouTube: Partner met kleine gaming YouTubers (barter: gratis server voor shoutout)
Budget: â‚¬200-500

Fase 2: Growth (Maand 4-8)
Doel: 50-65 klanten, break-even

Tactieken:

âœ… Referral program: â‚¬5 credit voor referrer + referee
âœ… Content marketing: Guides op eigen blog (SEO)
âœ… Google Ads: â‚¬100-300/maand, focus op long-tail keywords
âœ… Partnerships: Samenwerking met modpack developers
Budget: â‚¬300-800/maand

Fase 3: Scale (Maand 9+)
Doel: 70+ klanten, optimalisatie

Tactieken:

âœ… Affiliates: 20% recurring commission
âœ… Enterprise outreach: Grote communities/clans benaderen
âœ… Upselling: Managed services, custom mods, DDoS+
âœ… International: Uitbreiden naar UK/DE markt
Budget: â‚¬500-1500/maand

ğŸ¯ UNIQUE SELLING POINTS
Wat maakt jou anders:
ğŸ’ª Hardware Superieur:

"Intel i9-12900H (laptop flagship, geen recycled serverchips)"
"DDR5-4800 RAM (30% sneller dan standaard DDR4)"
"10Gbit backbone (geen bottlenecks)"
ğŸ‡³ğŸ‡± Locatie Voordeel:

"Nederlandse servers = <10ms latency NL/BE/DE"
"GDPR compliant, EU hosted"
"Nederlandse support (geen taalbarriÃ¨re)"
ğŸ”§ Flexibiliteit:

"Custom modpacks binnen 24u"
"Root access beschikbaar (premium tier)"
"Gratis server migrations van concurrenten"
âš¡ Performance Garantie:

"99.5% uptime SLA"
"No overselling - gegarandeerde resources"
"Gratis TPS/performance monitoring"
ğŸ“Š KPI TRACKING
Meet deze metrics maandelijks:
Metric	Target Maand 1	Target Maand 6	Target Maand 12
Totaal klanten	15	50	75
MRR (Monthly Recurring)	â‚¬150	â‚¬700	â‚¬1,200
Churn rate	<50%	<25%	<20%
LTV (Lifetime Value)	â‚¬15	â‚¬50	â‚¬80
CAC (Customer Acquisition Cost)	â‚¬10	â‚¬15	â‚¬20
Support tickets/klant	2.0	1.2	0.8
âš ï¸ RISICO'S & MITIGATIE
Risico	Impact	Kans	Mitigatie
Hardware failure	Hoog	Laag	Warranty, spare parts, backups
DDoS attacks	Hoog	Middel	Cloudflare, Path.net, null routing
Hoge churn	Hoog	Middel	Loyalty programma, kwartaalkorting
Concurrentie prijsoorlog	Middel	Hoog	Focus op kwaliteit/service ipv prijs
Game popularity shift	Middel	Middel	Diverse portfolio, quick pivots
Elektriciteit kosten	Laag	Hoog	Doorberekenen, energie contract
ğŸ¬ ACTION PLAN - Eerste 30 Dagen
Week 1:
 Registreer bedrijf (eenmanszaak/VOF)
 Koop domein + setup website (WordPress/React)
 Setup billing (WHMCS/Blesta â‚¬15/mo)
 Configureer 1Ã— MS-01 als test
Week 2:
 Install game panel (Pterodactyl - gratis)
 Setup 5 populairste games
 DDoS bescherming activeren
 Maak social media accounts
Week 3:
 Launch website + checkout flow
 Test alle server installaties
 Schrijf 3-5 SEO artikelen
 Join 10+ gaming Discord communities
Week 4:
 LAUNCH met 50% korting promo
 Reddit posts (authentiek, geen spam)
 Outreach naar 5-10 YouTubers
 Eerste klanten onboarden + feedback
ğŸ’¡ BONUS: Upsell Opportunities
Service	Prijs	Effort	Marge
DDoS bescherming+	+â‚¬5/mo	Laag	80%
Daily backups	+â‚¬3/mo	Laag	70%
Priority support	+â‚¬8/mo	Middel	85%
Custom plugins/mods	â‚¬20-100	Hoog	60%
Server management	+â‚¬15/mo	Hoog	70%
Website hosting	â‚¬5-15/mo	Laag	75%
Potential extra: +â‚¬5-10 per klant gemiddeld = +â‚¬300-600/maand

ğŸ“ NEXT STEPS
Wat wil je als eerste aanpakken?

Hardware setup - Servers configureren, testen
Website/Branding - Logo, site, socials
Legal/Admin - Bedrijf registreren, BTW, facturen
Marketing plan - Welke kanalen eerst?
Of wil je een specifiek onderdeel dieper uitwerken? ğŸš€





graag

claude-sonnet-4-5-20250929-thinking-32k

Thought for 3 seconds

ğŸ® Meest Gespeelde Games via Servers (2024)
ğŸ”¥ TOP 10 - Community/Private Servers:
Rank	Game	Populariteit	Resource Gebruik	Avg. Spelers/Server
1	Minecraft	â­â­â­â­â­	Laag-Hoog (modpacks)	20-100
2	FiveM (GTA V RP)	â­â­â­â­â­	Hoog	32-256
3	Rust	â­â­â­â­â­	Zeer Hoog	50-200
4	CS2 / CS:GO	â­â­â­â­â­	Middel	10-64
5	ARK: Survival Evolved/Ascended	â­â­â­â­	Zeer Hoog	20-70
6	Palworld	â­â­â­â­	Middel-Hoog	8-32
7	Valheim	â­â­â­â­	Laag-Middel	2-10
8	Project Zomboid	â­â­â­â­	Middel	16-64
9	V Rising	â­â­â­	Middel	10-40
10	7 Days to Die	â­â­â­	Middel-Hoog	8-32
ğŸ“ˆ Trending / Groeiend:
Nieuwe Hits (2023-2024):
Palworld - Explosieve groei begin 2024
Enshrouded - Survival co-op, groeiend
Lethal Company - Viral hit, kleinschalig
Blijvend Populair:
Satisfactory - Co-op factory building
Terraria - Tijdloze klassieker
Sons of the Forest - Survival horror co-op
ğŸ’° Meest Lucratief voor Hosting Bedrijven:
Game	Vraag	Prijsgevoeligheid	Churn Rate
Minecraft	Zeer hoog	Laag (â‚¬3-15/mo)	Laag
FiveM	Hoog	Hoog (â‚¬15-50/mo)	Middel
Rust	Hoog	Middel (â‚¬10-30/mo)	Hoog
ARK	Middel-Hoog	Middel (â‚¬10-25/mo)	Middel
ğŸ¯ Aanbeveling voor Jouw Setup:
Focus op deze 5 games = 80% van de markt:
text

1. Minecraft (Vanilla + Modded)
2. FiveM (GTA V RP)
3. Rust
4. CS2 / CS:GO
5. Palworld
Realistische Verdeling op 5Ã— MS-01:
Node 1-2:

3Ã— Rust servers (24GB RAM)
2Ã— ARK servers (16GB RAM)
Node 3:

6Ã— FiveM servers (24GB RAM)
Node 4-5:

15Ã— Minecraft servers (mix vanilla/modded)
10Ã— CS:GO/CS2 servers
5Ã— Palworld servers
Totaal: ~40 gameservers (high quality, no overselling)

Wil je een specifieke marktanalyse of pricing strategie uitwerken? ğŸ“Š





wat zijn momenteel de meest gespeelde game's via servers

claude-sonnet-4-5-20250929-thinking-32k

Thought for 4 seconds

Gameserver Capaciteit (5Ã— MS-01 nodes)
ğŸ“Š Totale Resources:
CPU: 70 cores / 100 threads
RAM: 160GB DDR5
Opslag: 5TB NVMe
Network: 10G+ backbone
ğŸ® Aantal Servers per Game Type:
Lichte Servers:
Game	Per Node	Totaal (5Ã—)	Resource Bottleneck
Terraria	25-30	~125-150	RAM
CS:GO/CS2 (64 tick)	12-15	~60-75	CPU threads
Minecraft Vanilla	10-12	~50-60	RAM
Valheim	8-10	~40-50	RAM
Middelzware Servers:
Game	Per Node	Totaal (5Ã—)	Resource Bottleneck
FiveM (GTA RP)	4-6	~20-30	RAM + CPU
7 Days to Die	5-6	~25-30	RAM
Minecraft Modded	3-5	~15-25	RAM
Project Zomboid	6-8	~30-40	RAM
Zware Servers:
Game	Per Node	Totaal (5Ã—)	Resource Bottleneck
Rust	3-4	~15-20	RAM (6-8GB/server)
ARK Survival	2-3	~10-15	RAM (8-10GB/server)
Satisfactory	4-5	~20-25	RAM + CPU
âš ï¸ Belangrijke Beperkingen:
1. RAM is de Bottleneck
32GB per node = ~28GB bruikbaar voor gameservers
Bij zware games (ARK/Rust) ben je snel vol
2. Cooling Concerns
Fanless mode: Throttling bij >70% load
Dual fan: Moet aan voor gameserver hosting
Overweeg extra cooling bij 24/7 gebruik
3. Realistic Capacity:
Voor gemengde workload (verschillende games):

text

Conservatieve schatting: 30-50 servers totaal
Optimistische schatting: 60-100 servers totaal
ğŸ’¡ Best Practice Setup:
Per node specialisatie:

Node 1-2: Zware servers (Rust, ARK) â†’ 6-8 servers
Node 3-4: Middelzware (Minecraft, FiveM) â†’ 12-20 servers
Node 5: Lichte servers (Terraria, Valheim) â†’ 20-30 servers
Totaal: ~50-70 gameservers (mixed workload, 24/7 stable)

Welk type games wil je precies hosten? Dan kan ik een specifieke configuratie uitwerken! ğŸ¯





ok stel u voor ik heb dit staan hoevveel game's kan ik hosten COMPUTE (per node, Ã— 5):
â”œâ”€ MS-01 Server (â‚¬743)
â”‚ â”œâ”€ CPU: i9-12900H (14C/20T, 5.0GHz)
â”‚ â”œâ”€ RAM: 32GB DDR5-4800 SO-DIMM
â”‚ â”œâ”€ SSD: 1TB NVMe M.2 2280
â”‚ â”œâ”€ Network: 2Ã— 10G SFP+, 2Ã— 2.5GbE
â”‚ â”œâ”€ USB: 2Ã— USB4, 3Ã— USB 3.2
â”‚ â”œâ”€ Display: 2Ã— HDMI 2.0, 1Ã— DP 1.4
â”‚ â””â”€ Size: 20Ã—20Ã—6cm, fanless/dual fan




